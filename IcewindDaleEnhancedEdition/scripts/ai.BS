// TESTING
// //DisplayStringHead(Myself,103365) // Test

IF
	PartyRested()
THEN
	RESPONSE #100
		SetGlobal("c_EfreetiBottle","GLOBAL",1)
		SetGlobal("c_BlackSpiderFigurine","GLOBAL",1)
		SetGlobal("c_MoonDogFigurine","GLOBAL",1)
		SetGlobal("c_GoldenLionFigurine","GLOBAL",1)
		SetGlobal("c_HornOfValhalla","GLOBAL",1)
		SetGlobal("c_GolemManual","GLOBAL",1)
		SetGlobal("c_VhailorsHelm","GLOBAL",1)
		SetGlobal("c_HarpOfDiscord","GLOBAL",1)
		SetGlobal("c_HarpOfPandemonium","GLOBAL",1)
		SetGlobal("c_AzlaersHarp","GLOBAL",1)
		SetGlobal("c_MethildsHarp","GLOBAL",1)
		SetGlobal("c_staffOfMagi","GLOBAL",1)
		SetGlobal("u_useLongSummonSpells","LOCALS",0) // Off
		SetGlobal("u_useShortSummonSpells","LOCALS",0) // Off
		SetGlobal("u_useItemSummonSpells","LOCALS",0) // Off
		SetGlobal("u_healingSpellsOn","LOCALS",0) // Off
END

IF
	HotKey(Q)
	Global("u_useLongSummonSpells","LOCALS",0)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,16469)  // On
		SetGlobal("u_useLongSummonSpells","LOCALS",1) // On
END

IF
	HotKey(Q)
	Global("u_useLongSummonSpells","LOCALS",1)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,16470)  // Off
		SetGlobal("u_useLongSummonSpells","LOCALS",0) // Off
END

IF
	HotKey(E)
	Global("u_useShortSummonSpells","LOCALS",0)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,16469)  // On
		SetGlobal("u_useShortSummonSpells","LOCALS",1) // On
END

IF
	HotKey(E)
	Global("u_useShortSummonSpells","LOCALS",1)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,16470)  // Off
		SetGlobal("u_useShortSummonSpells","LOCALS",0) // Off
END

IF
	HotKey(F)
	Global("u_useItemSummonSpells","LOCALS",0)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,16469)  // On
		SetGlobal("u_useItemSummonSpells","LOCALS",1) // On
END

IF
	HotKey(F)
	Global("u_useItemSummonSpells","LOCALS",1)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,16470)  // Off
		SetGlobal("u_useItemSummonSpells","LOCALS",0) // Off
END

IF
	HotKey(T)
    Global("u_healingSpellsOn","LOCALS",0)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,16469)  // On
		SetGlobal("u_healingSpellsOn","LOCALS",1) // On
END

IF
	HotKey(T)
	Global("u_healingSpellsOn","LOCALS",1)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,16470)  // Off
		SetGlobal("u_healingSpellsOn","LOCALS",0) // Off
END

////////////////////////////////////////////////////////////////// Cancel Fireball If Enemy Has Moved Closer
// If casting a fireball and target is within 17ft cancel it
IF
	GlobalTimerNotExpired("castingfireball","LOCALS")
	Range(LastSeenBy(Myself),17)
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103241) // Cancelling Fireball
		SetGlobalTimer("castingfireball","LOCALS",0)
		ClearAllActions()
END

// If casting fireball and target still far away, continue until cast and don't continue with other actions
IF
	GlobalTimerNotExpired("castingfireball","LOCALS")
THEN
	RESPONSE #100
		// Continue with current action
END

////////////////////////////////////////////////////////////////// Status Messages

IF
	!GlobalTimerNotExpired("energyleveldrained","LOCALS")
	CheckStatGT(Myself,0,LEVELDRAIN)
THEN
	RESPONSE #100
		SetGlobalTimer("energyleveldrained","LOCALS",30)
		//DisplayStringHead(Myself,103242) // Status: Energy Level Drained
		Continue()
END

IF
	!GlobalTimerNotExpired("fatigued","LOCALS")
	CheckStatGT(Myself,0,FATIGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("fatigued","LOCALS",30)
		//DisplayStringHead(Myself,103353) // Status: Fatigued
		Continue()
END

////////////////////////////////////////////////////////////////// Take Note Of My Current Weapon So I Can Switch Back To It

//IF
//
//THEN
//	RESPONSE #100
//		
//		//DisplayStringHead(Myself,10)
//END

// FillSlot(SLOT_WEAPON0) Equips the next available item in your inventory replacing what you currently have equipped and swapping between just those two weapons.

// Note: You can only save to global variables, so we have one variable for each member in your party.
// We save the currently equipped weapon to a variable so you can switch back to it later.
// Only save our weapon if we haven't already switched our weapon.

// PartySlot1
//IF
//	Global("PartySlot1SwitchedWeapon","LOCAL",0) // 0 false, 1 true
//THEN
//	RESPONSE #100
//		SetTokenObject("PartySlot1OriginalWeapon",Myself)
//END
//

//  [EA.GENERAL.RACE.CLASS.SPECIFIC.GENDER.ALIGN]
//  [ALLY.0.0.0.0.SUMMONED.0]



////////////////////////////////////////////////////////////////// If poisoned use an antidote potion
IF 
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	StateCheck(Myself,STATE_POISONED) 
	HasItem("potn20",Myself)  // Antidote
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103243) // Potion: Antidote
		UseItem("potn20",Myself)  // Antidote
END

IF 
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	StateCheck(Myself,STATE_POISONED)
	HasItem("potn17",Myself)  // Elixir of health - cures disease and poisons
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103244) // Potion: Elixir Of Health
		UseItem("potn17",Myself)  // Elixir of health - cures disease and poisons
END

////////////////////////////////////////////////////////////////// Share Antidotes

IF
    StateCheck(Myself,STATE_POISONED)
	!HasItem("potn17",Myself)
    !HasItem("potn20",Myself)
THEN
    RESPONSE #100
		//DisplayStringHead(Myself,103245) // Help: Need Antidote
        Shout(NEED_ANTIDOTE) // Shout for help
		Continue()
END

IF
    Heard([ANYONE],NEED_ANTIDOTE) // If someone shouted for help
    !HasItem("potn20",LastHeardBy(Myself))
	!HasItem("potn17",LastHeardBy(Myself))
	HasItem("potn20",Myself)
THEN
    RESPONSE #100
		//DisplayStringHead(Myself,103246) // Giving Antidote
        GiveItem("potn20",LastHeardBy(Myself))
		Continue()
END

IF
    Heard([ANYONE],NEED_ANTIDOTE) // If someone shouted for help
    !HasItem("potn20",LastHeardBy(Myself))
	!HasItem("potn17",LastHeardBy(Myself))
	HasItem("potn17",Myself)
THEN
    RESPONSE #100
		//DisplayStringHead(Myself,103246) // Giving Antidote
        GiveItem("potn17",LastHeardBy(Myself))
		Continue()
END

////////////////////////////////////////////////////////////////////////////////////// Use Cure Disease Potions

IF 
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	StateCheck(Myself,STATE_DISEASED) 
	HasItem("potn17",Myself)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103244) // Potion: Elixir Of Health
		UseItem("potn17",Myself)
END

////////////////////////////////////////////////////////////////////////////////////// Share Cure Disease Potions

IF
    StateCheck(Myself,STATE_DISEASED)
	!HasItem("potn17",Myself)
THEN
    RESPONSE #100
		//DisplayStringHead(Myself,103354) // Help: Need Cure Disease
        Shout(NEED_CURE_DISEASE) // Shout for help
		Continue()
END

IF
    Heard([ANYONE],NEED_CURE_DISEASE) // If someone shouted for help
	!HasItem("potn17",LastHeardBy(Myself))
	HasItem("potn17",Myself)
THEN
    RESPONSE #100
		//DisplayStringHead(Myself,103355) // Giving Elixir Of Health
        GiveItem("potn17",LastHeardBy(Myself))
		Continue()
END

////////////////////////////////////////////////////////////////////////////////////// Buff Potions

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	OR(2)
		HitBy([ENEMY],FIRE)
		HitBy([ENEMY],MAGICFIRE)
	DamageTakenGT(25)
	HasItem("potn02",Myself)
	CheckStatLT(Myself,49,RESISTFIRE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103352) // Potion: Fire Resistance
		UseItem("potn02",Myself)
END

IF
	OR(2)
		HitBy([ENEMY],FIRE)
		HitBy([ENEMY],MAGICFIRE)
	DamageTakenGT(25)
	!HasItem("potn02",Myself)
	CheckStatLT(Myself,49,RESISTFIRE)
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103351) // Help: Need Potion Fire Resistance
        Shout(NEED_POTION_FIRE_RESISTANCE) // Shout for help
		Continue()
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	OR(2)
		HitBy([ENEMY],COLD)
		HitBy([ENEMY],MAGICCOLD)
	DamageTakenGT(25)
	HasItem("potn22",Myself)
	CheckStatLT(Myself,49,RESISTCOLD)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103350) // Potion: Cold Resistance
		UseItem("potn22",Myself)
END

IF
	OR(2)
		HitBy([ENEMY],COLD)
		HitBy([ENEMY],MAGICCOLD)
	DamageTakenGT(25)
	!HasItem("potn22",Myself)
	CheckStatLT(Myself,49,RESISTCOLD)
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103349) // Help: Need Potion Cold Resistance
        Shout(NEED_POTION_COLD_RESISTANCE) // Shout for help
		Continue()
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HitBy([ENEMY],ELECTRICITY)
	DamageTakenGT(25)
	HasItem("potn31",Myself)
	CheckStatLT(Myself,49,RESISTELECTRICITY)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103348) // Potion: Insulation
		UseItem("potn31",Myself)
END

IF
	HitBy([ENEMY],ELECTRICITY)
	DamageTakenGT(25)
	!HasItem("potn31",Myself)
	CheckStatLT(Myself,49,RESISTELECTRICITY)
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103347) // Help: Need Potion Insulation
        Shout(NEED_POTION_INSULATION) // Shout for help
		Continue()
END

//////////////////////////////////////////////////////////////////// Share Buff Potions

IF
	ActionListEmpty()
    Heard([ANYONE],NEED_POTION_FIRE_RESISTANCE) // If someone shouted for help
    !HasItem("potn02",LastHeardBy(Myself))
	HasItem("potn02",Myself)
THEN
    RESPONSE #100
		//DisplayStringHead(Myself,103346) // Giving Potion Fire Resistance
        GiveItem("potn02",LastHeardBy(Myself))
		Continue()
END

IF
	ActionListEmpty()
    Heard([ANYONE],NEED_POTION_COLD_RESISTANCE) // If someone shouted for help
    !HasItem("potn22",LastHeardBy(Myself))
	HasItem("potn22",Myself)
THEN
    RESPONSE #100
		//DisplayStringHead(Myself,103345) // Giving Potion Cold Resistance
        GiveItem("potn22",LastHeardBy(Myself))
		Continue()
END

IF
	ActionListEmpty()
    Heard([ANYONE],NEED_POTION_INSULATION) // If someone shouted for help
    !HasItem("potn31",LastHeardBy(Myself))
	HasItem("potn31",Myself)
THEN
    RESPONSE #100
		//DisplayStringHead(Myself,103344) // Giving Potion Insulation
        GiveItem("potn31",LastHeardBy(Myself))
		Continue()
END

////////////////////////////////////////////////////////////////////////////////////// Spell Shields

// Level 3
// 3 Rounds/Level (18 seconds/level) - Self
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_MINOR_SPELL_DEFLECTION)
	!CheckStat(Myself,1,WIZARD_SPELL_DEFLECTION)

	OR(4)
		See(NearestEnemyOfType([0.0.0.BARD_ALL]))
		See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
		See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
		See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103272) // Spell: Minor Spell Deflection
		Spell(Myself,WIZARD_MINOR_SPELL_DEFLECTION)
END

////////////////////////////////////////////////////////////////////////////////////// Scrolls: Spell Shields

// Level 3
// 3 Rounds/Level (18 seconds/level) - Self
IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("SCRL6G",Myself)
	!CheckStat(Myself,1,WIZARD_SPELL_DEFLECTION)

	OR(4)
		See(NearestEnemyOfType([0.0.0.BARD_ALL]))
		See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
		See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
		See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103272) // Spell: Minor Spell Deflection
		UseItem("SCRL6G",Myself)
END

// Level 5
// 3 Rounds/Level (18 seconds/level) - Self
IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("SCRL7D",Myself)
	!CheckStat(Myself,1,WIZARD_SPELL_TURNING)

	OR(4)
		See(NearestEnemyOfType([0.0.0.BARD_ALL]))
		See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
		See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
		See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103357) // Spell: Minor Spell Turning
		UseItem("SCRL7D",Myself)
END

// Level 4
// 1 Round/Level (6 seconds/level) - Self
IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("SCRL1Z",Myself)
	!CheckStat(Myself,1,MINORGLOBE)

	OR(4)
		See(NearestEnemyOfType([0.0.0.BARD_ALL]))
		See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
		See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
		See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103273) // Spell: Minor Globe Of Invulnerability
		UseItem("SCRL1Z",Myself)
END

/////////////////////////////////////////////////////////////////////////////////////// Stoneskins

// Level 4
// 600 Rounds (1 Hour) - Self
IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_STONE_SKIN)
	!CheckSpellState(Myself,STONESKIN)
	!CheckStatGT(Myself,0,STONESKINS)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103275) // Spell: Stoneskin
		Spell(Myself,WIZARD_STONE_SKIN)
END

// Level 5
// 600 rounds (1 Hour) - Self
IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_IRONSKIN)
	!CheckSpellState(Myself,IRON_SKINS)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
	    SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103292) // Spell: Iron Skins
		Spell(Myself,CLERIC_IRONSKIN)
END

//////////////////////////////////////////////////////////////////// If ally health is low and have heal spell, heal them
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	
	Global("u_healingSpellsOn","LOCALS",1)

	HaveSpell(CLERIC_CURE_LIGHT_WOUNDS)
	HPPercentLT(MostDamagedOf(Myself),80)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103343) // Spell: Cure Light Wounds
		Spell(MostDamagedOf(Myself),CLERIC_CURE_LIGHT_WOUNDS)
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")

	Global("u_healingSpellsOn","LOCALS",1)

	HaveSpell(CLERIC_CURE_MEDIUM_WOUNDS)
	HPPercentLT(MostDamagedOf(Myself),80) 

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103342) // Spell: Cure Medium Wounds
		Spell(MostDamagedOf(Myself),CLERIC_CURE_MEDIUM_WOUNDS)
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")

	Global("u_healingSpellsOn","LOCALS",1)

	HaveSpell(CLERIC_CURE_SERIOUS_WOUNDS)
	HPPercentLT(MostDamagedOf(Myself),75)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103341) // Spell: Cure Serious Wounds
		Spell(MostDamagedOf(Myself),CLERIC_CURE_SERIOUS_WOUNDS)
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")

	Global("u_healingSpellsOn","LOCALS",1)

	HaveSpell(CLERIC_CURE_CRITICAL_WOUNDS)
	HPPercentLT(MostDamagedOf(Myself),70)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103363) // Spell: Cure Critical Wounds
		Spell(MostDamagedOf(Myself),CLERIC_CURE_CRITICAL_WOUNDS)
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")

	Global("u_healingSpellsOn","LOCALS",1)

	HaveSpell(CLERIC_MASS_CURE)  // SPPR514.SPL (Mass Cure)
	HPPercentLT(MostDamagedOf(Myself),70)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
		SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103340) // Spell: Mass Cure
		Spell(MostDamagedOf(Myself),CLERIC_MASS_CURE)
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")

	Global("u_healingSpellsOn","LOCALS",1)

	HaveSpell(CLERIC_REGENERATE)  // SPPR514.SPL (Mass Cure)
	HPPercentLT(MostDamagedOf(Myself),70)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
		SetGlobalTimer("castnattack","LOCALS",6)
		////DisplayStringHead(Myself,?) // Spell: Regenerate
		Spell(MostDamagedOf(Myself),CLERIC_REGENERATE)
END

/////////////////////////////////////////////////////////////////// If health is low use a healing potion

// check hp < maxhp - 40
// per = hp/maxhp*100
// hp > 40*per/(100-per)
// if per < x and hp > 40*x/(100-x)

// Potion 55 - Potion Of Superior Healing
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn55",Myself)  // Potion of Superior Healing
	HPPercentLT(Myself,10) 
	HPGT(Myself,4)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		////DisplayStringHead(Myself,?) // Potion: Superior Healing
		UseItem("potn55",Myself)  // Potion of Superior Healing
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn55",Myself)  // Potion of Superior Healing
	HPPercentLT(Myself,20) 
	HPGT(Myself,10)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		////DisplayStringHead(Myself,?) // Potion: Superior Healing
		UseItem("potn55",Myself)  // Potion of Superior Healing
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn55",Myself)  // Potion of Superior Healing
	HPPercentLT(Myself,30) 
	HPGT(Myself,17)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		////DisplayStringHead(Myself,?) // Potion: Superior Healing
		UseItem("potn55",Myself)  // Potion of Superior Healing
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn55",Myself)  // Potion of Superior Healing
	HPPercentLT(Myself,40) 
	HPGT(Myself,27)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		////DisplayStringHead(Myself,?) // Potion: Superior Healing
		UseItem("potn55",Myself)  // Potion of Superior Healing
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn55",Myself)  // Potion of Superior Healing
	HPPercentLT(Myself,50) 
	HPGT(Myself,40)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		////DisplayStringHead(Myself,?) // Potion: Superior Healing
		UseItem("potn55",Myself)  // Potion of Superior Healing
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn55",Myself)  // Potion of Superior Healing
	HPPercentLT(Myself,60) 
	HPGT(Myself,60)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		////DisplayStringHead(Myself,?) // Potion: Superior Healing
		UseItem("potn55",Myself)  // Potion of Superior Healing
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn55",Myself)  // Potion of Superior Healing
	HPPercentLT(Myself,70) 
	HPGT(Myself,93)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		////DisplayStringHead(Myself,?) // Potion: Superior Healing
		UseItem("potn55",Myself)  // Potion of Superior Healing
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn55",Myself)  // Potion of Superior Healing
	HPPercentLT(Myself,80) 
	HPGT(Myself,160)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		////DisplayStringHead(Myself,?) // Potion: Superior Healing
		UseItem("potn55",Myself)  // Potion of Superior Healing
END

// check hp < maxhp - 27
// per = hp/maxhp*100
// hp > 27*per/(100-per)
// if per < x and hp > 27*x/(100-x)

// Potion 52 - Potion Of Extra Healing
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn52",Myself)  // Potion of Extra Healing
	HPPercentLT(Myself,10) 
	HPGT(Myself,3)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103339) // Potion: Extra Healing
		UseItem("potn52",Myself)  // Potion of Extra Healing
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn52",Myself)  // Potion of Extra Healing
	HPPercentLT(Myself,20) 
	HPGT(Myself,7)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103339) // Potion: Extra Healing
		UseItem("potn52",Myself)  // Potion of Extra Healing
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn52",Myself)  // Potion of Extra Healing
	HPPercentLT(Myself,30) 
	HPGT(Myself,12)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103339) // Potion: Extra Healing
		UseItem("potn52",Myself)  // Potion of Extra Healing
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn52",Myself)  // Potion of Extra Healing
	HPPercentLT(Myself,40) 
	HPGT(Myself,18)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103339) // Potion: Extra Healing
		UseItem("potn52",Myself)  // Potion of Extra Healing
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn52",Myself)  // Potion of Extra Healing
	HPPercentLT(Myself,50) 
	HPGT(Myself,27)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103339) // Potion: Extra Healing
		UseItem("potn52",Myself)  // Potion of Extra Healing
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn52",Myself)  // Potion of Extra Healing
	HPPercentLT(Myself,60) 
	HPGT(Myself,41)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103339) // Potion: Extra Healing
		UseItem("potn52",Myself)  // Potion of Extra Healing
END

// check hp <= maxhp - 9
// per = hp/maxhp*100
// hp >= 9*per/(100-per)
// if per < x and hp > 9*x/(100-x)

// Potion 8 - Potion Of Healing

IF 
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn08",Myself)  // Potion of Healing
	HPPercentLT(Myself,10) 
	HPGT(Myself,1)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103338) // Potion: Healing
		UseItem("potn08",Myself)  // Potion of Healing
END

IF 
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn08",Myself)  // Potion of Healing
	HPPercentLT(Myself,20) 
	HPGT(Myself,2)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103338) // Potion: Healing
		UseItem("potn08",Myself)  // Potion of Healing
END

IF 
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn08",Myself)  // Potion of Healing
	HPPercentLT(Myself,30) 
	HPGT(Myself,4)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103338) // Potion: Healing
		UseItem("potn08",Myself)  // Potion of Healing
END

IF 
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn08",Myself)  // Potion of Healing
	HPPercentLT(Myself,40) 
	HPGT(Myself,6)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103338) // Potion: Healing
		UseItem("potn08",Myself)  // Potion of Healing
END

IF 
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn08",Myself)  // Potion of Healing
	HPPercentLT(Myself,50) 
	HPGT(Myself,9)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103338) // Potion: Healing
		UseItem("potn08",Myself)  // Potion of Healing
END

IF 
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn08",Myself)  // Potion of Healing
	HPPercentLT(Myself,60) 
	HPGT(Myself,14)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103338) // Potion: Healing
		UseItem("potn08",Myself)  // Potion of Healing
END

IF 
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn08",Myself)  // Potion of Healing
	HPPercentLT(Myself,70) 
	HPGT(Myself,21)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103338) // Potion: Healing
		UseItem("potn08",Myself)  // Potion of Healing
END

// Potion 25 - Potion Of Healing

IF 
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn25",Myself)  // Potion of Healing
	HPPercentLT(Myself,10) 
	HPGT(Myself,1)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103338) // Potion: Healing
		UseItem("potn25",Myself)  // Potion of Healing
END

IF 
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn25",Myself)  // Potion of Healing
	HPPercentLT(Myself,20) 
	HPGT(Myself,2)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103338) // Potion: Healing
		UseItem("potn25",Myself)  // Potion of Healing
END

IF 
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn25",Myself)  // Potion of Healing
	HPPercentLT(Myself,30) 
	HPGT(Myself,4)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103338) // Potion: Healing
		UseItem("potn25",Myself)  // Potion of Healing
END

IF 
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn25",Myself)  // Potion of Healing
	HPPercentLT(Myself,40) 
	HPGT(Myself,6)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103338) // Potion: Healing
		UseItem("potn25",Myself)  // Potion of Healing
END

IF 
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn25",Myself)  // Potion of Healing
	HPPercentLT(Myself,50) 
	HPGT(Myself,9)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103338) // Potion: Healing
		UseItem("potn25",Myself)  // Potion of Healing
END

IF 
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn25",Myself)  // Potion of Healing
	HPPercentLT(Myself,60) 
	HPGT(Myself,14)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103338) // Potion: Healing
		UseItem("potn25",Myself)  // Potion of Healing
END

IF 
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("potn25",Myself)  // Potion of Healing
	HPPercentLT(Myself,70) 
	HPGT(Myself,21)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103338) // Potion: Healing
		UseItem("potn25",Myself)  // Potion of Healing
END

////////////////////////////////////////////////////////////////// Share Healing Potions

IF
	ActionListEmpty()
    !HasItem("potn08",Myself)
    HPPercentLT(Myself,50)
THEN
    RESPONSE #100
		//DisplayStringHead(Myself,103337) // Help: Need Potion Of Healing
        Shout(NEED_POTION_OF_HEALING) // Shout for help
		Continue()
END

IF
	ActionListEmpty()
    Heard([ANYONE],NEED_POTION_OF_HEALING) // If someone shouted for help
    !HasItem("potn08",LastHeardBy(Myself))
	HasItem("potn08",Myself)
THEN
    RESPONSE #100
		//DisplayStringHead(Myself,103336) // Giving Healing Potion
        GiveItem("potn08",LastHeardBy(Myself)) // Pass them the item
		Continue()
END

//////////////////////////////////////////////////////////////// Healing Scrolls

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("SCRL56",Myself)
	HPPercentLT(MostDamagedOf(Myself),70)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103370) // Scroll: Cure Serious Wounds
		UseItem("SCRL56",MostDamagedOf(Myself))
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("SCRL61",Myself)
	HPPercentLT(MostDamagedOf(Myself),70)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103364) // Scroll: Cure Critical Wounds
		UseItem("SCRL61",MostDamagedOf(Myself))
END

//////////////////////////////////////////////////////////////// Restoration Spells
// Restoration spells undo level drain

IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_LESSER_RESTORATION)
	CheckStatGT(PartySlot1,0,LEVELDRAIN)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
	    SetGlobalTimer("castnattack","LOCALS",6)
		//? //DisplayStringHead(Myself,?) // Spell: Lesser Restoration
		Spell(PartySlot1,CLERIC_LESSER_RESTORATION)
END

IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_LESSER_RESTORATION)
	CheckStatGT(PartySlot2,0,LEVELDRAIN)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
	    SetGlobalTimer("castnattack","LOCALS",6)
		//? //DisplayStringHead(Myself,?) // Spell: Lesser Restoration
		Spell(PartySlot2,CLERIC_LESSER_RESTORATION)
END

IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_LESSER_RESTORATION)
	CheckStatGT(PartySlot3,0,LEVELDRAIN)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
	    SetGlobalTimer("castnattack","LOCALS",6)
		//? //DisplayStringHead(Myself,?) // Spell: Lesser Restoration
		Spell(PartySlot3,CLERIC_LESSER_RESTORATION)
END

IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_LESSER_RESTORATION)
	CheckStatGT(PartySlot4,0,LEVELDRAIN)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
	    SetGlobalTimer("castnattack","LOCALS",6)
		//? //DisplayStringHead(Myself,?) // Spell: Lesser Restoration
		Spell(PartySlot4,CLERIC_LESSER_RESTORATION)
END

IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_LESSER_RESTORATION)
	CheckStatGT(PartySlot5,0,LEVELDRAIN)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
	    SetGlobalTimer("castnattack","LOCALS",6)
		//? //DisplayStringHead(Myself,?) // Spell: Lesser Restoration
		Spell(PartySlot5,CLERIC_LESSER_RESTORATION)
END

IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_LESSER_RESTORATION)
	CheckStatGT(PartySlot6,0,LEVELDRAIN)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
	    SetGlobalTimer("castnattack","LOCALS",6)
		//? //DisplayStringHead(Myself,?) // Spell: Lesser Restoration
		Spell(PartySlot6,CLERIC_LESSER_RESTORATION)
END

//////////////////////////////////////////////////////////////// Run away from nearby enemies if health is low
// If an enemy is nearby and the same location timer isn't running, then start the timer and run away
IF 
	ActionListEmpty()
	HPPercentLT(Myself,60)
	!GlobalTimerExpired("locMeSame","LOCALS")
	!GlobalTimerNotExpired("locMeSame","LOCALS")
	Range(NearestEnemyOf(Myself),5)
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103335) // Running Away
		SetGlobalTimer("locMeSame","LOCALS",3)
		RunAwayFrom(NearestEnemyOf(Myself),20)
END

IF 
	ActionListEmpty()
	HPPercentLT(Myself,60)
	!GlobalTimerExpired("locMeSame","LOCALS")
	!GlobalTimerNotExpired("locMeSame","LOCALS")
	Range(NearestEnemyOf(Myself),10)
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103335) // Running Away
		SetGlobalTimer("locMeSame","LOCALS",3)
		RunAwayFrom(NearestEnemyOf(Myself),25)
END

// If an enemy is nearby and the same location timer is running but hasn't expired, then run away
IF 
	ActionListEmpty()
	HPPercentLT(Myself,60)
	GlobalTimerNotExpired("locMeSame","LOCALS")
	Range(NearestEnemyOf(Myself),5)
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103335) // Running Away
		RunAwayFrom(NearestEnemyOf(Myself),15)
END

// If an enemy is nearby and the same location timer has expired (have been in the same spot for a while), continue with normal actions and attack

////////////////////////////////////////////////////////////////////////////////////// Counter Silence

// Level 2 - Abjuration 1
// 10 rounds (60 seconds) - Self
IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_VOCALIZE)
	StateCheck(Myself,STATE_SILENCED)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103372) // Spell: Vocalize
		Spell(Myself,WIZARD_VOCALIZE)
END

/////////////////////////////////////////////////////////////////////////////////////// Simulacrum And Projected Image

////////////////////////////////////////////////////////////////////////////// Short Duration Summon spells

IF
	ActionListEmpty()

	Global("u_useShortSummonSpells","LOCALS",1)
	!Heard([ANYONE],SUMMONING_CREATURE) // If someone else summoning a creature

	NumCreature([GOODCUTOFF.0.PLANATAR],0)
	NumCreature([GOODCUTOFF.0.DARKPLANATAR],0)
	NumCreature([GOODCUTOFF.0.SOLAR],0)
	NumCreature([GOODCUTOFF.0.ANTISOLAR.0.0.SUMMONED],0)
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_SUMMON_PLANATAR_GOOD)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Shout(SUMMONING_CREATURE) // Summoning Creature
		////DisplayStringHead(Myself,?) // Spell: Summon Planetar
		Spell(Myself,WIZARD_SUMMON_PLANATAR_GOOD)
END

IF
	ActionListEmpty()

	Global("u_useShortSummonSpells","LOCALS",1)
	!Heard([ANYONE],SUMMONING_CREATURE) // If someone else summoning a creature

	NumCreature([GOODCUTOFF.0.PLANATAR],0)
	NumCreature([GOODCUTOFF.0.DARKPLANATAR],0)
	NumCreature([GOODCUTOFF.0.SOLAR],0)
	NumCreature([GOODCUTOFF.0.ANTISOLAR.0.0.SUMMONED],0)
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_SUMMON_PLANATAR_EVIL)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Shout(SUMMONING_CREATURE) // Summoning Creature
		////DisplayStringHead(Myself,?) // Spell: Summon Planetar
		Spell(Myself,WIZARD_SUMMON_PLANATAR_EVIL)
END

IF
	ActionListEmpty()

	Global("u_useShortSummonSpells","LOCALS",1)
	!Heard([ANYONE],SUMMONING_CREATURE) // If someone else summoning a creature

	NumCreature([GOODCUTOFF.0.PLANATAR],0)
	NumCreature([GOODCUTOFF.0.DARKPLANATAR],0)
	NumCreature([GOODCUTOFF.0.SOLAR],0)
	NumCreature([GOODCUTOFF.0.ANTISOLAR.0.0.SUMMONED],0)
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_SUMMON_FALLEN_DEVA)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Shout(SUMMONING_CREATURE) // Summoning Creature
		////DisplayStringHead(Myself,?) // Spell: Summon Fallen Deva
		Spell(Myself,CLERIC_SUMMON_FALLEN_DEVA)
END

IF
	ActionListEmpty()

	Global("u_useShortSummonSpells","LOCALS",1)
	!Heard([ANYONE],SUMMONING_CREATURE) // If someone else summoning a creature

	NumCreature([GOODCUTOFF.0.PLANATAR],0)
	NumCreature([GOODCUTOFF.0.DARKPLANATAR],0)
	NumCreature([GOODCUTOFF.0.SOLAR],0)
	NumCreature([GOODCUTOFF.0.ANTISOLAR.0.0.SUMMONED],0)
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_SUMMON_DEVA)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Shout(SUMMONING_CREATURE) // Summoning Creature
		////DisplayStringHead(Myself,?) // Spell: Summon Deva
		Spell(Myself,CLERIC_SUMMON_DEVA)
END

IF
	ActionListEmpty()

	Global("u_useShortSummonSpells","LOCALS",1)
	!Heard([ANYONE],SUMMONING_CREATURE) // If someone else summoning a creature

	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_GREATER_ELEMENTAL_SWARM)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Shout(SUMMONING_CREATURE) // Summoning Creature
		////DisplayStringHead(Myself,?) // Spell: Greater Elemental
		Spell(Myself,CLERIC_GREATER_ELEMENTAL_SWARM)
END

IF
	ActionListEmpty()

	Global("u_useShortSummonSpells","LOCALS",1)
	!Heard([ANYONE],SUMMONING_CREATURE) // If someone else summoning a creature

	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_ELEMENTAL_SWARM)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Shout(SUMMONING_CREATURE) // Summoning Creature
		////DisplayStringHead(Myself,?) // Spell: Greater Elemental
		Spell(Myself,CLERIC_ELEMENTAL_SWARM)
END

IF
	ActionListEmpty()

	Global("u_useShortSummonSpells","LOCALS",1)
	!Heard([ANYONE],SUMMONING_CREATURE) // If someone else summoning a creature

	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_MORDENKAINENS_SWORD)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Shout(SUMMONING_CREATURE) // Summoning Creature
		////DisplayStringHead(Myself,?) // Spell: Mordenkainen's Sword
		Spell(Myself,WIZARD_MORDENKAINENS_SWORD)
END

IF
	ActionListEmpty()

	Global("u_useShortSummonSpells","LOCALS",1)
	!Heard([ANYONE],SUMMONING_CREATURE) // If someone else summoning a creature

	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_WYVERN_CALL)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Shout(SUMMONING_CREATURE) // Summoning Creature
		////DisplayStringHead(Myself,?) // Spell: Wyvern Call
		Spell(Myself,WIZARD_WYVERN_CALL)
END

IF
	ActionListEmpty()

	Global("u_useShortSummonSpells","LOCALS",1)
	!Heard([ANYONE],SUMMONING_CREATURE) // If someone else summoning a creature

	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_CONJURE_ANIMALS)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Shout(SUMMONING_CREATURE) // Summoning Creature
		//DisplayStringHead(Myself,103308) // Spell: Conjure Animals
		Spell(Myself,CLERIC_CONJURE_ANIMALS)
END

IF
	ActionListEmpty()

	Global("u_useShortSummonSpells","LOCALS",1)
	!Heard([ANYONE],SUMMONING_CREATURE) // If someone else summoning a creature

	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_CALL_WOODLAND_BEINGS)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Shout(SUMMONING_CREATURE) // Summoning Creature
		//DisplayStringHead(Myself,103312) // Spell: Call Woodland Beings
		Spell(Myself,CLERIC_CALL_WOODLAND_BEINGS)
END

//IF
//	ActionListEmpty()

//	Global("u_useShortSummonSpells","LOCALS",1)
//	!Heard([ANYONE],SUMMONING_CREATURE) // If someone else summoning a creature

//	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
  //  !GlobalTimerNotExpired("castnattack","LOCALS")
//	HaveSpell(TOTEMIC_DRUID_SUMMON_SPIRIT_ANIMAL)

//	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
//	!StateCheck(Myself,STATE_SILENCED)
//	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
//THEN
//	RESPONSE #100
  //      SetGlobalTimer("castnattack","LOCALS",6)
//		Shout(SUMMONING_CREATURE) // Summoning Creature
//		////DisplayStringHead(Myself,?) // Spell: Summon Spirit Animal
//		Spell(Myself,TOTEMIC_DRUID_SUMMON_SPIRIT_ANIMAL)
//END

IF
	ActionListEmpty()

	Global("u_useShortSummonSpells","LOCALS",1)
	!Heard([ANYONE],SUMMONING_CREATURE) // If someone else summoning a creature

	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_ANIMAL_SUMMONING_3)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Shout(SUMMONING_CREATURE) // Summoning Creature
		//DisplayStringHead(Myself,103311) // Spell: Animal Summoning 3
		Spell(Myself,CLERIC_ANIMAL_SUMMONING_3)
END

IF
	ActionListEmpty()

	Global("u_useShortSummonSpells","LOCALS",1)
	!Heard([ANYONE],SUMMONING_CREATURE) // If someone else summoning a creature

	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_ANIMAL_SUMMONING_2)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Shout(SUMMONING_CREATURE) // Summoning Creature
		//DisplayStringHead(Myself,103310) // Spell: Animal Summoning 2
		Spell(Myself,CLERIC_ANIMAL_SUMMONING_2)
END

IF
	ActionListEmpty()

	Global("u_useShortSummonSpells","LOCALS",1)
	!Heard([ANYONE],SUMMONING_CREATURE) // If someone else summoning a creature

	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_ANIMAL_SUMMONING_1)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Shout(SUMMONING_CREATURE) // Summoning Creature
		//DisplayStringHead(Myself,103309) // Spell: Animal Summoning 1
		Spell(Myself,CLERIC_ANIMAL_SUMMONING_1)
END

IF
	ActionListEmpty()

	Global("u_useShortSummonSpells","LOCALS",1)
	!Heard([ANYONE],SUMMONING_CREATURE) // If someone else summoning a creature

	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_DEMI_SHADOW_MONSTERS)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Shout(SUMMONING_CREATURE) // Summoning Creature
		//DisplayStringHead(Myself,103309) // Spell: Animal Summoning 1
		Spell(Myself,WIZARD_DEMI_SHADOW_MONSTERS)
END

IF
	ActionListEmpty()

	Global("u_useShortSummonSpells","LOCALS",1)
	!Heard([ANYONE],SUMMONING_CREATURE) // If someone else summoning a creature

	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_SUMMON_SHADOW)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Shout(SUMMONING_CREATURE) // Summoning Creature
		//DisplayStringHead(Myself,103309) // Spell: Animal Summoning 1
		Spell(Myself,WIZARD_SUMMON_SHADOW)
END

IF
	ActionListEmpty()

	Global("u_useShortSummonSpells","LOCALS",1)
	!Heard([ANYONE],SUMMONING_CREATURE) // If someone else summoning a creature

	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_MONSTER_SUMMONING_4)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Shout(SUMMONING_CREATURE) // Summoning Creature
		//DisplayStringHead(Myself,103309) // Spell: Animal Summoning 1
		Spell(Myself,WIZARD_MONSTER_SUMMONING_4)
END

IF
	ActionListEmpty()

	Global("u_useShortSummonSpells","LOCALS",1)
	!Heard([ANYONE],SUMMONING_CREATURE) // If someone else summoning a creature

	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_SPIDER_SPAWN)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Shout(SUMMONING_CREATURE) // Summoning Creature
		//DisplayStringHead(Myself,103309) // Spell: Animal Summoning 1
		Spell(Myself,WIZARD_SPIDER_SPAWN)
END

/////////////////////////////////////////////////////////////////////////////////////// Long Duration Summon spells

IF
	ActionListEmpty()

	Global("u_useLongSummonSpells","LOCALS",1)
	!Heard([ANYONE],SUMMONING_CREATURE) // If someone else summoning a creature

	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_AERIAL_SERVANT)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Shout(SUMMONING_CREATURE) // Summoning Creature
		//? //DisplayStringHead(Myself,?) // Spell: Aerial Servant
		Spell(Myself,CLERIC_AERIAL_SERVANT)
END

IF
	ActionListEmpty()

	Global("u_useLongSummonSpells","LOCALS",1)
	!Heard([ANYONE],SUMMONING_CREATURE) // If someone else summoning a creature

	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_ANIMATE_DEAD)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Shout(SUMMONING_CREATURE) // Summoning Creature
		//DisplayStringHead(Myself,103313) // Spell: Animate Undead
		Spell(Myself,CLERIC_ANIMATE_DEAD)
END

IF
	ActionListEmpty()

	Global("u_useLongSummonSpells","LOCALS",1)
	!Heard([ANYONE],SUMMONING_CREATURE) // If someone else summoning a creature

	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_ANIMATE_DEAD)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Shout(SUMMONING_CREATURE) // Summoning Creature
		//DisplayStringHead(Myself,103313) // Spell: Animate Undead
		Spell(Myself,WIZARD_ANIMATE_DEAD)
END

IF
	ActionListEmpty()

	Global("u_useLongSummonSpells","LOCALS",1)
	!Heard([ANYONE],SUMMONING_CREATURE) // If someone else summoning a creature

	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_CONJURE_EARTH_ELEMENTAL)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Shout(SUMMONING_CREATURE) // Summoning Creature
		////DisplayStringHead(Myself,?) // Spell: Conjure Earth Elemental
		Spell(Myself,CLERIC_CONJURE_EARTH_ELEMENTAL)
END

IF
	ActionListEmpty()

	Global("u_useLongSummonSpells","LOCALS",1)
	!Heard([ANYONE],SUMMONING_CREATURE) // If someone else summoning a creature

	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_CONJURE_FIRE_ELEMENTAL)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Shout(SUMMONING_CREATURE) // Summoning Creature
		//DisplayStringHead(Myself,103307) // Spell: Conjure Fire Elemental
		Spell(Myself,CLERIC_CONJURE_FIRE_ELEMENTAL)
END

IF
	ActionListEmpty()

	Global("u_useLongSummonSpells","LOCALS",1)
	!Heard([ANYONE],SUMMONING_CREATURE) // If someone else summoning a creature

	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_CONJURE_FIRE_ELEMENTAL)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Shout(SUMMONING_CREATURE) // Summoning Creature
		//DisplayStringHead(Myself,103307) // Spell: Conjure Fire Elemental
		Spell(Myself,WIZARD_CONJURE_FIRE_ELEMENTAL)
END

////////////////////////////////////////////////////////////////////////////// Item Summons

////////////////////////////////////////////////////////////////////////////////// Scrolls: Summoning Spells

IF
	ActionListEmpty()

	Global("u_useShortSummonSpells","LOCALS",1)

	!HPGT(FifthNearestMyGroupOfType([ALLY.0.0.0.0.SUMMONED.0]),0)
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("SCRL1L",Myself)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103367) // Spell: Monster Summoning 1
		UseItem("SCRL1L",Myself)
END

IF
	ActionListEmpty()

	Global("u_useShortSummonSpells","LOCALS",1)

	!HPGT(FifthNearestMyGroupOfType([ALLY.0.0.0.0.SUMMONED.0]),0)
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("SCRL2A",Myself)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103368) // Spell: Monster Summoning 2
		UseItem("SCRL2A",Myself)
END

IF
	ActionListEmpty()

	Global("u_useShortSummonSpells","LOCALS",1)

	!HPGT(FifthNearestMyGroupOfType([ALLY.0.0.0.0.SUMMONED.0]),0)
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("SCRL2G",Myself)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103369) // Spell: Monster Summoning 3
		UseItem("SCRL2G",Myself)
END

////////////////////////////////////////////////////////////////////////////////////// Debuff/Control Spells
IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_ZONE_OF_SWEET_AIR)  // SPPR318.SPL (Zone of Sweet Air)
	OR(11)
		SpellCast([ANYONE],WIZARD_INCENDIARY_CLOUD)  // SPWI810.SPL (Incendiary Cloud)
		SpellCast([ANYONE],WIZARD_STINKING_CLOUD)  // SPWI213.SPL (Stinking Cloud)
		SpellCast([ANYONE],WIZARD_CLOUDKILL)  // SPWI502.SPL (Cloudkill)
		SpellCast([ANYONE],WIZARD_DEATH_FOG)  // SPWI614.SPL (Death Fog)
		SpellCast([ANYONE],WIZARD_INCENDIARY_CLOUD)  // SPWI810.SPL (Incendiary Cloud)
		SpellCast([ANYONE],WIZARD_STINKING_CLOUD)  // SPWI213.SPL (Stinking Cloud)
		SpellCast([ANYONE],WIZARD_CLOUDKILL)  // SPWI502.SPL (Cloudkill)
		SpellCast([ANYONE],WIZARD_DEATH_FOG)  // SPWI614.SPL (Death Fog)
		SpellCast([ANYONE],CLERIC_WRITHING_FOG)  // SPPR250.SPL (Writhing Fog)
		SpellCast([ANYONE],TRAP_STINKING_CLOUD)
		SpellCast([ANYONE],TRAP_CLOUDKILL)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
		SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103334) // Spell: Zone Of Sweet Air
		Spell(Myself,CLERIC_ZONE_OF_SWEET_AIR)
END

// Level 2 - Alteration
IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_SILENCE_15_FOOT)  // SPPR211.SPL (Silence, 15' Radius)
	OR(4)
		See(NearestEnemyOfType([0.0.0.BARD_ALL]))
		See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
		See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
		See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))
	!StateCheck(LastSeenBy(Myself),STATE_SILENCED)
	!CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
	!ImmuneToSpellLevel(LastSeenBy(Myself),2)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)

	CheckStatGT(LastSeenBy(Myself),5,SAVEVSSPELL)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)

	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103333) // Spell: Silence
		Spell(LastSeenBy(Myself),CLERIC_SILENCE_15_FOOT)  // SPPR211.SPL (Silence, 15' Radius)
END

// Level 6 - Abjuration 1
IF
	ActionListEmpty()
	OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_PIERCE_MAGIC)
	See(NearestEnemyOf(Myself))

	OR(12)
		CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
		CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_IMMUNITY)
		CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
		CheckStat(LastSeenBy(Myself),3,WIZARD_SPELL_IMMUNITY)
		CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
		CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
		CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
		CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
		CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
		CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
		CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),25,RESISTMAGIC)

	!ImmuneToSpellLevel(LastSeenBy(Myself),6)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)

	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103371) // Spell: Pierce Magic
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_MAGIC)
END

// Level 5 - Abjuration 1
IF
	ActionListEmpty()
	OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_LOWER_RESISTANCE)
	See(NearestEnemyOf(Myself))

	!CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)

	!ImmuneToSpellLevel(LastSeenBy(Myself),5)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	CheckStatGT(LastSeenBy(Myself),35,RESISTMAGIC)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)

	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103332) // Spell: Lower Resistance
		Spell(LastSeenBy(Myself),WIZARD_LOWER_RESISTANCE)
END

// Level 4 - Abjuration
IF
	ActionListEmpty()
	OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_SECRET_WORD)
	OR(4)
		See(NearestEnemyOfType([0.0.0.BARD_ALL]))
		See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
		See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
		See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))
	OR(4)
		CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
		CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
		CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
		CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_IMMUNITY)
	!ImmuneToSpellLevel(LastSeenBy(Myself),4)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)

	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103331) // Spell: Secret Word
		Spell(LastSeenBy(Myself),WIZARD_SECRET_WORD)
END

// Level 2 - Divination
IF
	ActionListEmpty()
	OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_DETECT_INVISIBILITY)
	OR(2)
		SpellCast([EVILCUTOFF],WIZARD_INVISIBILITY)
		SpellCast([EVILCUTOFF],WIZARD_IMPROVED_INVISIBILITY)
	!ImmuneToSpellLevel(LastTrigger,2)
	!CheckStat(LastTrigger,1,MINORGLOBE)
	!CheckStat(LastTrigger,1,WIZARD_SPELL_TURNING)
	!CheckStat(LastTrigger,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(LastTrigger,3,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103330) // Spell: Detect Invisibility
		Spell(Myself,WIZARD_DETECT_INVISIBILITY)
END

// Level 2 - Enchantment
IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_HOLD_PERSON)
	See([EVILCUTOFF.HUMANOID])
	!CheckSpellState(LastSeenBy(Myself),HELD)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
	!ImmuneToSpellLevel(LastSeenBy(Myself),2)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),5,SAVEVSSPELL)

	!Kit(LastSeenBy(Myself),INQUISITOR)
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	!HasItemEquiped("RING09",LastSeenBy(Myself))  // Edventar's Gift

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)

	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103328) // Spell: Hold Person
		Spell(LastSeenBy(Myself),CLERIC_HOLD_PERSON)
END

IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_HOLD_UNDEAD)
	General(NearestEnemyOf(Myself),UNDEAD)

	!CheckSpellState(LastSeenBy(Myself),HELD)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
	!ImmuneToSpellLevel(LastSeenBy(Myself),3)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),5,SAVEVSSPELL)

	!Kit(LastSeenBy(Myself),INQUISITOR)
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	!HasItemEquiped("RING09",LastSeenBy(Myself))  // Edventar's Gift

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)

	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103328) // Spell: Hold Person
		Spell(LastSeenBy(Myself),WIZARD_HOLD_UNDEAD)
END

// Level 1 - Enchantment
IF
	ActionListEmpty()
	OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_SLEEP)
	See([EVILCUTOFF.HUMANOID])
	!StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
	!CheckSpellState(LastSeenBy(Myself),HELD)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
	!ImmuneToSpellLevel(LastSeenBy(Myself),1)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),5,SAVEVSSPELL)

	!Kit(LastSeenBy(Myself),INQUISITOR)
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	!HasItemEquiped("RING09",LastSeenBy(Myself))  // Edventar's Gift

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)

	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103329) // Spell: Sleep
		Spell(LastSeenBy(Myself),WIZARD_SLEEP)
END


// Level 3 - Enchantment
IF
	ActionListEmpty()
	OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_HOLD_PERSON)
	See([EVILCUTOFF.HUMANOID])
	!CheckSpellState(LastSeenBy(Myself),HELD)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
	!ImmuneToSpellLevel(LastSeenBy(Myself),3)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),5,SAVEVSSPELL)

	!Kit(LastSeenBy(Myself),INQUISITOR)
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	!HasItemEquiped("RING09",LastSeenBy(Myself))  // Edventar's Gift

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)

	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103328) // Spell: Hold Person
		Spell(LastSeenBy(Myself),WIZARD_HOLD_PERSON)
END

// Level 5 - Enchantment
IF
	ActionListEmpty()
	OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_HOLD_MONSTER)
	See(NearestEnemyOf(Myself))
	!CheckSpellState(LastSeenBy(Myself),HELD)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
	!ImmuneToSpellLevel(LastSeenBy(Myself),5)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),5,SAVEVSSPELL)

	!Kit(LastSeenBy(Myself),INQUISITOR)
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	!HasItemEquiped("RING09",LastSeenBy(Myself))  // Edventar's Gift

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)

	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103327) // Spell: Hold Monster
		Spell(LastSeenBy(Myself),WIZARD_HOLD_MONSTER)
END

// Level 5 - Enchantment
IF
	ActionListEmpty()
	OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_CHAOS)  // SPPR211.SPL (Silence, 15' Radius)
	NumCreatureVsPartyGT(Myself,3)


	!CheckStat(NearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStat(NearestEnemyOf(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStat(NearestEnemyOf(Myself),1,WIZARD_SPELL_DEFLECTION)
	!ImmuneToSpellLevel(NearestEnemyOf(Myself),5)
	CheckStatLT(NearestEnemyOf(Myself),75,RESISTMAGIC)	
	CheckStatGT(NearestEnemyOf(Myself),5,SAVEVSSPELL)


	!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_SPELL_DEFLECTION)
	!ImmuneToSpellLevel(SecondNearestEnemyOf(Myself),5)
	CheckStatLT(SecondNearestEnemyOf(Myself),75,RESISTMAGIC)
	CheckStatGT(SecondNearestEnemyOf(Myself),5,SAVEVSSPELL)


	!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_SPELL_DEFLECTION)
	!ImmuneToSpellLevel(ThirdNearestEnemyOf(Myself),5)
	CheckStatLT(ThirdNearestEnemyOf(Myself),75,RESISTMAGIC)
	CheckStatGT(ThirdNearestEnemyOf(Myself),5,SAVEVSSPELL)


	!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_SPELL_DEFLECTION)
	!ImmuneToSpellLevel(FourthNearestEnemyOf(Myself),5)
	CheckStatLT(FourthNearestEnemyOf(Myself),75,RESISTMAGIC)
	CheckStatGT(FourthNearestEnemyOf(Myself),5,SAVEVSSPELL)

	See(NearestEnemyOf(Myself))

	!StateCheck(NearestEnemyOf(Myself),STATE_INVISIBLE)
	!StateCheck(NearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(NearestEnemyOf(Myself),STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)

	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103326) // Spell: Chaos
		Spell(LastSeenBy(Myself),WIZARD_CHAOS)
END

// Level 2 - Necromancy
IF
	ActionListEmpty()
	OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_HORROR)
	NumCreatureVsPartyGT(Myself,4)

	!StateCheck(NearestEnemyOf(Myself),STATE_PANIC)
	!CheckStat(NearestEnemyOf(Myself),1,MINORGLOBE)
	!CheckStat(NearestEnemyOf(Myself),7,WIZARD_SPELL_IMMUNITY) 
	!CheckStat(NearestEnemyOf(Myself),1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(NearestEnemyOf(Myself),2)
	!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!General(NearestEnemyOf(Myself),UNDEAD)
	!Race(NearestEnemyOf(Myself),DEMONIC)
	!Kit(NearestEnemyOf(Myself),CAVALIER)
	!Kit(NearestEnemyOf(Myself),Blackguard)
	CheckStatGT(NearestEnemyOf(Myself),5,SAVEVSSPELL)
	CheckStatLT(NearestEnemyOf(Myself),75,RESISTMAGIC)



	!StateCheck(SecondNearestEnemyOf(Myself),STATE_PANIC)
	!CheckStat(SecondNearestEnemyOf(Myself),1,MINORGLOBE)
	!CheckStat(SecondNearestEnemyOf(Myself),7,WIZARD_SPELL_IMMUNITY) 
	!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(SecondNearestEnemyOf(Myself),2)
	!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!General(SecondNearestEnemyOf(Myself),UNDEAD)
	!Race(SecondNearestEnemyOf(Myself),DEMONIC)
	!Kit(SecondNearestEnemyOf(Myself),CAVALIER)
	!Kit(SecondNearestEnemyOf(Myself),Blackguard)
	CheckStatGT(SecondNearestEnemyOf(Myself),5,SAVEVSSPELL)
	CheckStatLT(SecondNearestEnemyOf(Myself),75,RESISTMAGIC)



	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_PANIC)
	!CheckStat(ThirdNearestEnemyOf(Myself),1,MINORGLOBE)
	!CheckStat(ThirdNearestEnemyOf(Myself),7,WIZARD_SPELL_IMMUNITY) 
	!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(ThirdNearestEnemyOf(Myself),2)
	!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!General(ThirdNearestEnemyOf(Myself),UNDEAD)
	!Race(ThirdNearestEnemyOf(Myself),DEMONIC)
	!Kit(ThirdNearestEnemyOf(Myself),CAVALIER)
	!Kit(ThirdNearestEnemyOf(Myself),Blackguard)
	CheckStatGT(ThirdNearestEnemyOf(Myself),5,SAVEVSSPELL)
	CheckStatLT(ThirdNearestEnemyOf(Myself),75,RESISTMAGIC)



	!StateCheck(FourthNearestEnemyOf(Myself),STATE_PANIC)
	!CheckStat(FourthNearestEnemyOf(Myself),1,MINORGLOBE)
	!CheckStat(FourthNearestEnemyOf(Myself),7,WIZARD_SPELL_IMMUNITY) 
	!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(FourthNearestEnemyOf(Myself),2)
	!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(FourthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!General(FourthNearestEnemyOf(Myself),UNDEAD)
	!Race(FourthNearestEnemyOf(Myself),DEMONIC)
	!Kit(FourthNearestEnemyOf(Myself),CAVALIER)
	!Kit(FourthNearestEnemyOf(Myself),Blackguard)
	CheckStatGT(FourthNearestEnemyOf(Myself),5,SAVEVSSPELL)
	CheckStatLT(FourthNearestEnemyOf(Myself),75,RESISTMAGIC)



	!StateCheck(FifthNearestEnemyOf(Myself),STATE_PANIC)
	!CheckStat(FifthNearestEnemyOf(Myself),1,MINORGLOBE)
	!CheckStat(FifthNearestEnemyOf(Myself),7,WIZARD_SPELL_IMMUNITY) 
	!CheckStat(FifthNearestEnemyOf(Myself),1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(FifthNearestEnemyOf(Myself),2)
	!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(FifthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!General(FifthNearestEnemyOf(Myself),UNDEAD)
	!Race(FifthNearestEnemyOf(Myself),DEMONIC)
	!Kit(FifthNearestEnemyOf(Myself),CAVALIER)
	!Kit(FifthNearestEnemyOf(Myself),Blackguard)
	CheckStatGT(FifthNearestEnemyOf(Myself),5,SAVEVSSPELL)
	CheckStatLT(FifthNearestEnemyOf(Myself),75,RESISTMAGIC)



	!StateCheck(NearestEnemyOf(Myself),STATE_INVISIBLE)
	!StateCheck(NearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(NearestEnemyOf(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)

	!InParty(NearestEnemyOf(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103325) // Spell: Horror
		Spell(NearestEnemyOf(Myself),WIZARD_HORROR)
END


// Dispel Magic On Enemies
IF
	ActionListEmpty()
	OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_BREACH)
	OR(4)
		See(NearestEnemyOfType([0.0.0.BARD_ALL]))
		See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
		See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
		See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))
	OR(18)

		CheckStatGT(LastSeenBy(Myself),0,SHIELDGLOBE)
		CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
		CheckStatGT(LastSeenBy(Myself),0,IMPROVEDHASTE)
		CheckStatGT(LastSeenBy(Myself),0,STONESKINS)
		CheckStatGT(LastSeenBy(Myself),0,TRUE_SIGHT)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_DEFENSIVE_HARMONY)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_FIRE_SHIELD)
		CheckStatGT(LastSeenBy(Myself),0,DEATH_WARD)
		CheckStatGT(LastSeenBy(Myself),0,DEFENSIVE_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),0,STRENGTH_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)







		StateCheck(LastSeenBy(Myself),STATE_HASTED)
		StateCheck(LastSeenBy(Myself),STATE_BLESS)
		StateCheck(LastSeenBy(Myself),STATE_DRAWUPONHOLYMIGHT)
		StateCheck(LastSeenBy(Myself),STATE_BLUR)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
	!CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
	!ImmuneToSpellLevel(LastSeenBy(Myself),5)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),5,SAVEVSSPELL)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)

	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103324) // Spell: Breach
		Spell(LastSeenBy(Myself),WIZARD_BREACH)
END

// Wizard True Dispel Magic = Dispel Magic
// Dispel Magic On Allies
IF
	ActionListEmpty()
	OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_TRUE_DISPEL_MAGIC)
	OR(14)
		CheckSpellState(PartySlot1,HOPELESSNESS)
		CheckSpellState(PartySlot1,ENFEEBLED)
		CheckSpellState(PartySlot1,HELD)
		CheckSpellState(PartySlot1,ENTANGLE)
		CheckSpellState(PartySlot1,WEB)
		CheckSpellState(PartySlot1,DOOM)
		CheckSpellState(PartySlot1,MISCAST_MAGIC)
		StateCheck(PartySlot1,STATE_PANIC)
		StateCheck(PartySlot1,STATE_CHARMED)
		StateCheck(PartySlot1,STATE_CONFUSED)
		StateCheck(PartySlot1,STATE_SLEEPING)
		StateCheck(PartySlot1,STATE_SLOWED)
		StateCheck(PartySlot1,STATE_FEEBLEMINDED)
		CheckStatGT(PartySlot1,0,CLERIC_INSECT_PLAGUE)
	See(PartySlot1)

	!Heard([ANYONE],CASTING_DISPEL_MAGIC_ALLY)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103322) // Spell: Dispel Magic
		Shout(CASTING_DISPEL_MAGIC_ALLY)
		Spell(LastSeenBy(Myself),WIZARD_TRUE_DISPEL_MAGIC)
END

IF
	ActionListEmpty()
	OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_TRUE_DISPEL_MAGIC)
	OR(14)
		CheckSpellState(PartySlot2,HOPELESSNESS)
		CheckSpellState(PartySlot2,ENFEEBLED)
		CheckSpellState(PartySlot2,HELD)
		CheckSpellState(PartySlot2,ENTANGLE)
		CheckSpellState(PartySlot2,WEB)
		CheckSpellState(PartySlot2,DOOM)
		CheckSpellState(PartySlot2,MISCAST_MAGIC)
		StateCheck(PartySlot2,STATE_PANIC)
		StateCheck(PartySlot2,STATE_CHARMED)
		StateCheck(PartySlot2,STATE_CONFUSED)
		StateCheck(PartySlot2,STATE_SLEEPING)
		StateCheck(PartySlot2,STATE_SLOWED)
		StateCheck(PartySlot2,STATE_FEEBLEMINDED)
		CheckStatGT(PartySlot2,0,CLERIC_INSECT_PLAGUE)
	See(PartySlot2)

	!Heard([ANYONE],CASTING_DISPEL_MAGIC_ALLY)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103322) // Spell: Dispel Magic
		Shout(CASTING_DISPEL_MAGIC_ALLY)
		Spell(LastSeenBy(Myself),WIZARD_TRUE_DISPEL_MAGIC)
END

IF
	ActionListEmpty()
	OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_TRUE_DISPEL_MAGIC)
	OR(14)
		CheckSpellState(PartySlot3,HOPELESSNESS)
		CheckSpellState(PartySlot3,ENFEEBLED)
		CheckSpellState(PartySlot3,HELD)
		CheckSpellState(PartySlot3,ENTANGLE)
		CheckSpellState(PartySlot3,WEB)
		CheckSpellState(PartySlot3,DOOM)
		CheckSpellState(PartySlot3,MISCAST_MAGIC)
		StateCheck(PartySlot3,STATE_PANIC)
		StateCheck(PartySlot3,STATE_CHARMED)
		StateCheck(PartySlot3,STATE_CONFUSED)
		StateCheck(PartySlot3,STATE_SLEEPING)
		StateCheck(PartySlot3,STATE_SLOWED)
		StateCheck(PartySlot3,STATE_FEEBLEMINDED)
		CheckStatGT(PartySlot3,0,CLERIC_INSECT_PLAGUE)
	See(PartySlot3)

	!Heard([ANYONE],CASTING_DISPEL_MAGIC_ALLY)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103322) // Spell: Dispel Magic
		Shout(CASTING_DISPEL_MAGIC_ALLY)
		Spell(LastSeenBy(Myself),WIZARD_TRUE_DISPEL_MAGIC)
END

IF
	ActionListEmpty()
	OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_TRUE_DISPEL_MAGIC)
	OR(14)
		CheckSpellState(PartySlot4,HOPELESSNESS)
		CheckSpellState(PartySlot4,ENFEEBLED)
		CheckSpellState(PartySlot4,HELD)
		CheckSpellState(PartySlot4,ENTANGLE)
		CheckSpellState(PartySlot4,WEB)
		CheckSpellState(PartySlot4,DOOM)
		CheckSpellState(PartySlot4,MISCAST_MAGIC)
		StateCheck(PartySlot4,STATE_PANIC)
		StateCheck(PartySlot4,STATE_CHARMED)
		StateCheck(PartySlot4,STATE_CONFUSED)
		StateCheck(PartySlot4,STATE_SLEEPING)
		StateCheck(PartySlot4,STATE_SLOWED)
		StateCheck(PartySlot4,STATE_FEEBLEMINDED)
		CheckStatGT(PartySlot4,0,CLERIC_INSECT_PLAGUE)
	See(PartySlot4)

	!Heard([ANYONE],CASTING_DISPEL_MAGIC_ALLY)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103322) // Spell: Dispel Magic
		Shout(CASTING_DISPEL_MAGIC_ALLY)
		Spell(LastSeenBy(Myself),WIZARD_TRUE_DISPEL_MAGIC)
END

IF
	ActionListEmpty()
	OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_TRUE_DISPEL_MAGIC)
	OR(14)
		CheckSpellState(PartySlot5,HOPELESSNESS)
		CheckSpellState(PartySlot5,ENFEEBLED)
		CheckSpellState(PartySlot5,HELD)
		CheckSpellState(PartySlot5,ENTANGLE)
		CheckSpellState(PartySlot5,WEB)
		CheckSpellState(PartySlot5,DOOM)
		CheckSpellState(PartySlot5,MISCAST_MAGIC)
		StateCheck(PartySlot5,STATE_PANIC)
		StateCheck(PartySlot5,STATE_CHARMED)
		StateCheck(PartySlot5,STATE_CONFUSED)
		StateCheck(PartySlot5,STATE_SLEEPING)
		StateCheck(PartySlot5,STATE_SLOWED)
		StateCheck(PartySlot5,STATE_FEEBLEMINDED)
		CheckStatGT(PartySlot5,0,CLERIC_INSECT_PLAGUE)
	See(PartySlot5)

	!Heard([ANYONE],CASTING_DISPEL_MAGIC_ALLY)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103322) // Spell: Dispel Magic
		Shout(CASTING_DISPEL_MAGIC_ALLY)
		Spell(LastSeenBy(Myself),WIZARD_TRUE_DISPEL_MAGIC)
END

IF
	ActionListEmpty()
	OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_TRUE_DISPEL_MAGIC)
	OR(14)
		CheckSpellState(PartySlot6,HOPELESSNESS)
		CheckSpellState(PartySlot6,ENFEEBLED)
		CheckSpellState(PartySlot6,HELD)
		CheckSpellState(PartySlot6,ENTANGLE)
		CheckSpellState(PartySlot6,WEB)
		CheckSpellState(PartySlot6,DOOM)
		CheckSpellState(PartySlot6,MISCAST_MAGIC)
		StateCheck(PartySlot6,STATE_PANIC)
		StateCheck(PartySlot6,STATE_CHARMED)
		StateCheck(PartySlot6,STATE_CONFUSED)
		StateCheck(PartySlot6,STATE_SLEEPING)
		StateCheck(PartySlot6,STATE_SLOWED)
		StateCheck(PartySlot6,STATE_FEEBLEMINDED)
		CheckStatGT(PartySlot6,0,CLERIC_INSECT_PLAGUE)
	See(PartySlot6)

	!Heard([ANYONE],CASTING_DISPEL_MAGIC_ALLY)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103322) // Spell: Dispel Magic
		Shout(CASTING_DISPEL_MAGIC_ALLY)
		Spell(LastSeenBy(Myself),WIZARD_TRUE_DISPEL_MAGIC)
END

// Dispel Magic On Enemies
IF
	ActionListEmpty()
	OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_TRUE_DISPEL_MAGIC)
	OR(4)
		See(NearestEnemyOfType([0.0.0.BARD_ALL]))
		See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
		See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
		See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))
	OR(18)

		CheckStatGT(LastSeenBy(Myself),0,SHIELDGLOBE)
		CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
		CheckStatGT(LastSeenBy(Myself),0,IMPROVEDHASTE)
		CheckStatGT(LastSeenBy(Myself),0,STONESKINS)
		CheckStatGT(LastSeenBy(Myself),0,TRUE_SIGHT)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_DEFENSIVE_HARMONY)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_FIRE_SHIELD)
		CheckStatGT(LastSeenBy(Myself),0,DEATH_WARD)
		CheckStatGT(LastSeenBy(Myself),0,DEFENSIVE_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),0,STRENGTH_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)







		StateCheck(LastSeenBy(Myself),STATE_HASTED)
		StateCheck(LastSeenBy(Myself),STATE_BLESS)
		StateCheck(LastSeenBy(Myself),STATE_DRAWUPONHOLYMIGHT)
		StateCheck(LastSeenBy(Myself),STATE_BLUR)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
	!CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
	!ImmuneToSpellLevel(LastSeenBy(Myself),3)

	!Heard([ANYONE],CASTING_DISPEL_MAGIC_ENEMY)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),5,SAVEVSSPELL)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)

	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103322) // Spell: Dispel Magic
		Shout(CASTING_DISPEL_MAGIC_ENEMY)
		Spell(LastSeenBy(Myself),WIZARD_TRUE_DISPEL_MAGIC)
END

// Wizard Dispel Magic = Remove Magic
// Level 3 - Abjuration
IF
	ActionListEmpty()
	OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_DISPEL_MAGIC)
	OR(4)
		See(NearestEnemyOfType([0.0.0.BARD_ALL]))
		See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
		See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
		See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))
	OR(18)

		CheckStatGT(LastSeenBy(Myself),0,SHIELDGLOBE)
		CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
		CheckStatGT(LastSeenBy(Myself),0,IMPROVEDHASTE)
		CheckStatGT(LastSeenBy(Myself),0,STONESKINS)
		CheckStatGT(LastSeenBy(Myself),0,TRUE_SIGHT)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_DEFENSIVE_HARMONY)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_FIRE_SHIELD)
		CheckStatGT(LastSeenBy(Myself),0,DEATH_WARD)
		CheckStatGT(LastSeenBy(Myself),0,DEFENSIVE_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),0,STRENGTH_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)







		StateCheck(LastSeenBy(Myself),STATE_HASTED)
		StateCheck(LastSeenBy(Myself),STATE_BLESS)
		StateCheck(LastSeenBy(Myself),STATE_DRAWUPONHOLYMIGHT)
		StateCheck(LastSeenBy(Myself),STATE_BLUR)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
	!CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_IMMUNITY) 
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
	!ImmuneToSpellLevel(LastSeenBy(Myself),3)

	!Heard([ANYONE],CASTING_DISPEL_MAGIC_ENEMY)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),5,SAVEVSSPELL)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)

	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103323) // Spell: Remove Magic
		Shout(CASTING_DISPEL_MAGIC_ENEMY)
		Spell(LastSeenBy(Myself),WIZARD_DISPEL_MAGIC)
END

// Cleric Dispel Magic = Dispel Magic
// Level 3 - Abjuration
// Dispel Magic On Allies
IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_DISPEL_MAGIC)
	OR(14)
		CheckSpellState(PartySlot1,HOPELESSNESS)
		CheckSpellState(PartySlot1,ENFEEBLED)
		CheckSpellState(PartySlot1,HELD)
		CheckSpellState(PartySlot1,ENTANGLE)
		CheckSpellState(PartySlot1,WEB)
		CheckSpellState(PartySlot1,DOOM)
		CheckSpellState(PartySlot1,MISCAST_MAGIC)
		StateCheck(PartySlot1,STATE_PANIC)
		StateCheck(PartySlot1,STATE_CHARMED)
		StateCheck(PartySlot1,STATE_CONFUSED)
		StateCheck(PartySlot1,STATE_SLEEPING)
		StateCheck(PartySlot1,STATE_SLOWED)
		StateCheck(PartySlot1,STATE_FEEBLEMINDED)
		CheckStatGT(PartySlot1,0,CLERIC_INSECT_PLAGUE)
	See(PartySlot1)

	!Heard([ANYONE],CASTING_DISPEL_MAGIC_ALLY)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103322) // Spell: Dispel Magic
		Shout(CASTING_DISPEL_MAGIC_ALLY)
		Spell(LastSeenBy(Myself),CLERIC_DISPEL_MAGIC)
END

IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_DISPEL_MAGIC)
	OR(14)
		CheckSpellState(PartySlot2,HOPELESSNESS)
		CheckSpellState(PartySlot2,ENFEEBLED)
		CheckSpellState(PartySlot2,HELD)
		CheckSpellState(PartySlot2,ENTANGLE)
		CheckSpellState(PartySlot2,WEB)
		CheckSpellState(PartySlot2,DOOM)
		CheckSpellState(PartySlot2,MISCAST_MAGIC)
		StateCheck(PartySlot2,STATE_PANIC)
		StateCheck(PartySlot2,STATE_CHARMED)
		StateCheck(PartySlot2,STATE_CONFUSED)
		StateCheck(PartySlot2,STATE_SLEEPING)
		StateCheck(PartySlot2,STATE_SLOWED)
		StateCheck(PartySlot2,STATE_FEEBLEMINDED)
		CheckStatGT(PartySlot2,0,CLERIC_INSECT_PLAGUE)
	See(PartySlot2)

	!Heard([ANYONE],CASTING_DISPEL_MAGIC_ALLY)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103322) // Spell: Dispel Magic
		Shout(CASTING_DISPEL_MAGIC_ALLY)
		Spell(LastSeenBy(Myself),CLERIC_DISPEL_MAGIC)
END

IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_DISPEL_MAGIC)
	OR(14)
		CheckSpellState(PartySlot3,HOPELESSNESS)
		CheckSpellState(PartySlot3,ENFEEBLED)
		CheckSpellState(PartySlot3,HELD)
		CheckSpellState(PartySlot3,ENTANGLE)
		CheckSpellState(PartySlot3,WEB)
		CheckSpellState(PartySlot3,DOOM)
		CheckSpellState(PartySlot3,MISCAST_MAGIC)
		StateCheck(PartySlot3,STATE_PANIC)
		StateCheck(PartySlot3,STATE_CHARMED)
		StateCheck(PartySlot3,STATE_CONFUSED)
		StateCheck(PartySlot3,STATE_SLEEPING)
		StateCheck(PartySlot3,STATE_SLOWED)
		StateCheck(PartySlot3,STATE_FEEBLEMINDED)
		CheckStatGT(PartySlot3,0,CLERIC_INSECT_PLAGUE)
	See(PartySlot3)

	!Heard([ANYONE],CASTING_DISPEL_MAGIC_ALLY)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103322) // Spell: Dispel Magic
		Shout(CASTING_DISPEL_MAGIC_ALLY)
		Spell(LastSeenBy(Myself),CLERIC_DISPEL_MAGIC)
END

IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_DISPEL_MAGIC)
	OR(14)
		CheckSpellState(PartySlot4,HOPELESSNESS)
		CheckSpellState(PartySlot4,ENFEEBLED)
		CheckSpellState(PartySlot4,HELD)
		CheckSpellState(PartySlot4,ENTANGLE)
		CheckSpellState(PartySlot4,WEB)
		CheckSpellState(PartySlot4,DOOM)
		CheckSpellState(PartySlot4,MISCAST_MAGIC)
		StateCheck(PartySlot4,STATE_PANIC)
		StateCheck(PartySlot4,STATE_CHARMED)
		StateCheck(PartySlot4,STATE_CONFUSED)
		StateCheck(PartySlot4,STATE_SLEEPING)
		StateCheck(PartySlot4,STATE_SLOWED)
		StateCheck(PartySlot4,STATE_FEEBLEMINDED)
		CheckStatGT(PartySlot4,0,CLERIC_INSECT_PLAGUE)
	See(PartySlot4)

	!Heard([ANYONE],CASTING_DISPEL_MAGIC_ALLY)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103322) // Spell: Dispel Magic
		Shout(CASTING_DISPEL_MAGIC_ALLY)
		Spell(LastSeenBy(Myself),CLERIC_DISPEL_MAGIC)
END

IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_DISPEL_MAGIC)
	OR(14)
		CheckSpellState(PartySlot5,HOPELESSNESS)
		CheckSpellState(PartySlot5,ENFEEBLED)
		CheckSpellState(PartySlot5,HELD)
		CheckSpellState(PartySlot5,ENTANGLE)
		CheckSpellState(PartySlot5,WEB)
		CheckSpellState(PartySlot5,DOOM)
		CheckSpellState(PartySlot5,MISCAST_MAGIC)
		StateCheck(PartySlot5,STATE_PANIC)
		StateCheck(PartySlot5,STATE_CHARMED)
		StateCheck(PartySlot5,STATE_CONFUSED)
		StateCheck(PartySlot5,STATE_SLEEPING)
		StateCheck(PartySlot5,STATE_SLOWED)
		StateCheck(PartySlot5,STATE_FEEBLEMINDED)
		CheckStatGT(PartySlot5,0,CLERIC_INSECT_PLAGUE)
	See(PartySlot5)

	!Heard([ANYONE],CASTING_DISPEL_MAGIC_ALLY)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103322) // Spell: Dispel Magic
		Shout(CASTING_DISPEL_MAGIC_ALLY)
		Spell(LastSeenBy(Myself),CLERIC_DISPEL_MAGIC)
END

IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_DISPEL_MAGIC)
	OR(14)
		CheckSpellState(PartySlot6,HOPELESSNESS)
		CheckSpellState(PartySlot6,ENFEEBLED)
		CheckSpellState(PartySlot6,HELD)
		CheckSpellState(PartySlot6,ENTANGLE)
		CheckSpellState(PartySlot6,WEB)
		CheckSpellState(PartySlot6,DOOM)
		CheckSpellState(PartySlot6,MISCAST_MAGIC)
		StateCheck(PartySlot6,STATE_PANIC)
		StateCheck(PartySlot6,STATE_CHARMED)
		StateCheck(PartySlot6,STATE_CONFUSED)
		StateCheck(PartySlot6,STATE_SLEEPING)
		StateCheck(PartySlot6,STATE_SLOWED)
		StateCheck(PartySlot6,STATE_FEEBLEMINDED)
		CheckStatGT(PartySlot6,0,CLERIC_INSECT_PLAGUE)
	See(PartySlot6)

	!Heard([ANYONE],CASTING_DISPEL_MAGIC_ALLY)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103322) // Spell: Dispel Magic
		Shout(CASTING_DISPEL_MAGIC_ALLY)
		Spell(LastSeenBy(Myself),CLERIC_DISPEL_MAGIC)
END

// Dispel Magic On Enemies
IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_DISPEL_MAGIC)
	OR(4)
		See(NearestEnemyOfType([0.0.0.BARD_ALL]))
		See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
		See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
		See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))
	OR(18)

		CheckStatGT(LastSeenBy(Myself),0,SHIELDGLOBE)
		CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
		CheckStatGT(LastSeenBy(Myself),0,IMPROVEDHASTE)
		CheckStatGT(LastSeenBy(Myself),0,STONESKINS)
		CheckStatGT(LastSeenBy(Myself),0,TRUE_SIGHT)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_DEFENSIVE_HARMONY)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_FIRE_SHIELD)
		CheckStatGT(LastSeenBy(Myself),0,DEATH_WARD)
		CheckStatGT(LastSeenBy(Myself),0,DEFENSIVE_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),0,STRENGTH_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)







		StateCheck(LastSeenBy(Myself),STATE_HASTED)
		StateCheck(LastSeenBy(Myself),STATE_BLESS)
		StateCheck(LastSeenBy(Myself),STATE_DRAWUPONHOLYMIGHT)
		StateCheck(LastSeenBy(Myself),STATE_BLUR)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
	!CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
	!ImmuneToSpellLevel(LastSeenBy(Myself),3)

	!Heard([ANYONE],CASTING_DISPEL_MAGIC_ENEMY)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),5,SAVEVSSPELL)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)

	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103322) // Spell: Dispel Magic
		Shout(CASTING_DISPEL_MAGIC_ENEMY)
		Spell(LastSeenBy(Myself),CLERIC_DISPEL_MAGIC)
END

// Level 5 - Conjuration
IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_INSECT_PLAGUE)
	OR(4)
		See(NearestEnemyOfType([0.0.0.BARD_ALL]))
		See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
		See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
		See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))
	!CheckSpellState(LastSeenBy(Myself),MISCAST_MAGIC)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_INSECT_PLAGUE)
	!CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY) 
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
	!ImmuneToSpellLevel(LastSeenBy(Myself),5)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),5,SAVEVSSPELL)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)

	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//..DisplayStringHead(Myself,?) // Spell: Insect Plague
		Spell(LastSeenBy(Myself),CLERIC_INSECT_PLAGUE)
END

// Level 3 - Conjuration
IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_SUMMON_INSECTS)
	OR(4)
		See(NearestEnemyOfType([0.0.0.BARD_ALL]))
		See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
		See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
		See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))
	!CheckSpellState(LastSeenBy(Myself),MISCAST_MAGIC)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_INSECT_PLAGUE)
	!CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY) 
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
	!ImmuneToSpellLevel(LastSeenBy(Myself),3)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),5,SAVEVSSPELL)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)

	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		////DisplayStringHead(Myself,?) // Spell: Summon Insects
		Spell(LastSeenBy(Myself),CLERIC_SUMMON_INSECTS)
END

// Level 3 - Enchantment
IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_MISCAST_MAGIC)
	OR(4)
		See(NearestEnemyOfType([0.0.0.BARD_ALL]))
		See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
		See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
		See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))
	!CheckSpellState(LastSeenBy(Myself),MISCAST_MAGIC)
	!CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY) 
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
	!ImmuneToSpellLevel(LastSeenBy(Myself),3)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),5,SAVEVSSPELL)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)

	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103321) // Spell: Miscast Magic
		Spell(LastSeenBy(Myself),CLERIC_MISCAST_MAGIC)
END

IF
 	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_DOOM)
	See(NearestEnemyOf(Myself))
	OR(4)
		CheckStatLT(LastSeenBy(Myself),5,SAVEVSSPELL)
		CheckStatLT(LastSeenBy(Myself),0,ARMORCLASS)
		CheckStatGT(LastSeenBy(Myself),75,MAXHITPOINTS)
		CheckStatLT(LastSeenBy(Myself),10,THAC0)
	!CheckSpellState(LastSeenBy(Myself),DOOM)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)

	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103320) // Spell: Doom
		Spell(LastSeenBy(Myself),CLERIC_DOOM)
END

IF
	ActionListEmpty()
	OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_GREATER_MALISON)
	See(NearestEnemyOf(Myself))
	!CheckSpellState(NearestEnemyOf(Myself),MALISON)
	OR(4)
		CheckStatLT(NearestEnemyOf(Myself),5,SAVEVSSPELL)
		CheckStatLT(NearestEnemyOf(Myself),0,ARMORCLASS)
		CheckStatGT(NearestEnemyOf(Myself),75,MAXHITPOINTS)
		CheckStatLT(NearestEnemyOf(Myself),10,THAC0)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)

	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103319) // Spell: Greater Malison
		Spell(NearestEnemyOf(Myself),WIZARD_GREATER_MALISON)
END

IF
 	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_PRAYER)
	See(NearestEnemyOf(Myself))

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)

	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103320) // Spell: Doom
		Spell(Myself,CLERIC_PRAYER)
END

IF
 	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_SLOW)
	See(NearestEnemyOf(Myself))
	!StateCheck(NearestEnemyOf(Myself),STATE_SLOWED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_SLOWED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_SLOWED)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)

	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103320) // Spell: Doom
		Spell(Myself,WIZARD_SLOW)
END

IF
 	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_DOMINATION)
	See(NearestEnemyOf(Myself))
	!StateCheck(NearestEnemyOf(Myself),STATE_CHARMED)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)

	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103320) // Spell: Doom
		Spell(Myself,WIZARD_DOMINATION)
END

/////////////////////////////////////////////////////////////////////////////////////// Debuff/Control Wands
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	Class(Myself,MAGE_ALL)
	HasItem("wand02",Myself)
	NumCreatureVsPartyGT(Myself,4)

	!StateCheck(NearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(NearestEnemyOf(Myself),STATE_PANIC)
	!CheckStat(NearestEnemyOf(Myself),1,MINORGLOBE)
	!CheckStat(NearestEnemyOf(Myself),7,WIZARD_SPELL_IMMUNITY) 
	!CheckStat(NearestEnemyOf(Myself),1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(NearestEnemyOf(Myself),2)
	!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!General(NearestEnemyOf(Myself),UNDEAD)
	!Race(NearestEnemyOf(Myself),DEMONIC)
	!Kit(NearestEnemyOf(Myself),CAVALIER)
	!Kit(NearestEnemyOf(Myself),Blackguard)
	CheckStatGT(NearestEnemyOf(Myself),5,SAVEVSSPELL)
	CheckStatLT(NearestEnemyOf(Myself),75,RESISTMAGIC)



	!StateCheck(SecondNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_PANIC)
	!CheckStat(SecondNearestEnemyOf(Myself),1,MINORGLOBE)
	!CheckStat(SecondNearestEnemyOf(Myself),7,WIZARD_SPELL_IMMUNITY) 
	!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(SecondNearestEnemyOf(Myself),2)
	!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!General(SecondNearestEnemyOf(Myself),UNDEAD)
	!Race(SecondNearestEnemyOf(Myself),DEMONIC)
	!Kit(SecondNearestEnemyOf(Myself),CAVALIER)
	!Kit(SecondNearestEnemyOf(Myself),Blackguard)
	CheckStatGT(SecondNearestEnemyOf(Myself),5,SAVEVSSPELL)
	CheckStatLT(SecondNearestEnemyOf(Myself),75,RESISTMAGIC)



	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_PANIC)
	!CheckStat(ThirdNearestEnemyOf(Myself),1,MINORGLOBE)
	!CheckStat(ThirdNearestEnemyOf(Myself),7,WIZARD_SPELL_IMMUNITY) 
	!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(ThirdNearestEnemyOf(Myself),2)
	!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!General(ThirdNearestEnemyOf(Myself),UNDEAD)
	!Race(ThirdNearestEnemyOf(Myself),DEMONIC)
	!Kit(ThirdNearestEnemyOf(Myself),CAVALIER)
	!Kit(ThirdNearestEnemyOf(Myself),Blackguard)
	CheckStatGT(ThirdNearestEnemyOf(Myself),5,SAVEVSSPELL)
	CheckStatLT(ThirdNearestEnemyOf(Myself),75,RESISTMAGIC)



	!StateCheck(FourthNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_PANIC)
	!CheckStat(FourthNearestEnemyOf(Myself),1,MINORGLOBE)
	!CheckStat(FourthNearestEnemyOf(Myself),7,WIZARD_SPELL_IMMUNITY) 
	!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(FourthNearestEnemyOf(Myself),2)
	!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(FourthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!General(FourthNearestEnemyOf(Myself),UNDEAD)
	!Race(FourthNearestEnemyOf(Myself),DEMONIC)
	!Kit(FourthNearestEnemyOf(Myself),CAVALIER)
	!Kit(FourthNearestEnemyOf(Myself),Blackguard)
	CheckStatGT(FourthNearestEnemyOf(Myself),5,SAVEVSSPELL)
	CheckStatLT(FourthNearestEnemyOf(Myself),75,RESISTMAGIC)



	!StateCheck(FifthNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_PANIC)
	!CheckStat(FifthNearestEnemyOf(Myself),1,MINORGLOBE)
	!CheckStat(FifthNearestEnemyOf(Myself),7,WIZARD_SPELL_IMMUNITY) 
	!CheckStat(FifthNearestEnemyOf(Myself),1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(FifthNearestEnemyOf(Myself),2)
	!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(FifthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!General(FifthNearestEnemyOf(Myself),UNDEAD)
	!Race(FifthNearestEnemyOf(Myself),DEMONIC)
	!Kit(FifthNearestEnemyOf(Myself),CAVALIER)
	!Kit(FifthNearestEnemyOf(Myself),Blackguard)
	CheckStatGT(FifthNearestEnemyOf(Myself),5,SAVEVSSPELL)
	CheckStatLT(FifthNearestEnemyOf(Myself),75,RESISTMAGIC)



	!StateCheck(NearestEnemyOf(Myself),STATE_INVISIBLE)
	!StateCheck(NearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(NearestEnemyOf(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)

	!InParty(NearestEnemyOf(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103318) // Wand: Fear
		UseItem("wand02",NearestEnemyOf(Myself))
END

IF
  	ActionListEmpty()
	Class(Myself,MAGE_ALL)
	HasItem("wand08",Myself)
	NumCreatureVsPartyGT(Myself,4)

	!StateCheck(NearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(NearestEnemyOf(Myself),STATE_PANIC)
	!CheckStat(NearestEnemyOf(Myself),1,MINORGLOBE)
	!CheckStat(NearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY) 
	!CheckStat(NearestEnemyOf(Myself),1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(NearestEnemyOf(Myself),1)
	!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!General(NearestEnemyOf(Myself),UNDEAD)
	!Race(NearestEnemyOf(Myself),DEMONIC)
	!Race(NearestEnemyOf(Myself),ELF)
	CheckStatLT(NearestEnemyOf(Myself),75,RESISTMAGIC)

	LevelLT(NearestEnemyOf(Myself),5)

	!StateCheck(SecondNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_PANIC)
	!CheckStat(SecondNearestEnemyOf(Myself),1,MINORGLOBE)
	!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY) 
	!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(SecondNearestEnemyOf(Myself),1)
	!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!General(SecondNearestEnemyOf(Myself),UNDEAD)
	!Race(SecondNearestEnemyOf(Myself),DEMONIC)
	!Race(SecondNearestEnemyOf(Myself),ELF)
	CheckStatLT(SecondNearestEnemyOf(Myself),75,RESISTMAGIC)

	LevelLT(SecondNearestEnemyOf(Myself),5)

	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_PANIC)
	!CheckStat(ThirdNearestEnemyOf(Myself),1,MINORGLOBE)
	!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY) 
	!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(ThirdNearestEnemyOf(Myself),1)
	!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!General(ThirdNearestEnemyOf(Myself),UNDEAD)
	!Race(ThirdNearestEnemyOf(Myself),DEMONIC)
	!Race(ThirdNearestEnemyOf(Myself),ELF)
	CheckStatLT(ThirdNearestEnemyOf(Myself),75,RESISTMAGIC)

	LevelLT(ThirdNearestEnemyOf(Myself),5)

	!StateCheck(FourthNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_PANIC)
	!CheckStat(FourthNearestEnemyOf(Myself),1,MINORGLOBE)
	!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY) 
	!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(FourthNearestEnemyOf(Myself),1)
	!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(FourthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!General(FourthNearestEnemyOf(Myself),UNDEAD)
	!Race(FourthNearestEnemyOf(Myself),DEMONIC)
	!Race(FourthNearestEnemyOf(Myself),ELF)
	CheckStatLT(FourthNearestEnemyOf(Myself),75,RESISTMAGIC)

	LevelLT(FourthNearestEnemyOf(Myself),5)

	!StateCheck(FifthNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_PANIC)
	!CheckStat(FifthNearestEnemyOf(Myself),1,MINORGLOBE)
	!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY) 
	!CheckStat(FifthNearestEnemyOf(Myself),1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(FifthNearestEnemyOf(Myself),1)
	!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(FifthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!General(FifthNearestEnemyOf(Myself),UNDEAD)
	!Race(FifthNearestEnemyOf(Myself),DEMONIC)
	!Race(FifthNearestEnemyOf(Myself),ELF)
	CheckStatLT(FifthNearestEnemyOf(Myself),75,RESISTMAGIC)

	LevelLT(FifthNearestEnemyOf(Myself),5)

	!StateCheck(NearestEnemyOf(Myself),STATE_INVISIBLE)
	!StateCheck(NearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(NearestEnemyOf(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)

	CheckStatGT(NearestEnemyOf(Myself),5,SAVEVSWANDS)

	!InParty(NearestEnemyOf(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103317) // Wand: Sleep
		UseItem("wand08",NearestEnemyOf(Myself))
END

IF
  	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	Class(Myself,MAGE_ALL)
	HasItem("wand04",Myself)
	!CheckSpellState(NearestEnemyOf(Myself),HELD)
	!StateCheck(NearestEnemyOf(Myself),STATE_STUNNED | STATE_HELPLESS)
	CheckStatGT(NearestEnemyOf(Myself),10,SAVEVSWANDS)
	!General(NearestEnemyOf(Myself),UNDEAD)
	OR(4)
		CheckStatLT(NearestEnemyOf(Myself),5,SAVEVSSPELL)
		CheckStatLT(NearestEnemyOf(Myself),0,ARMORCLASS)
		CheckStatGT(NearestEnemyOf(Myself),75,MAXHITPOINTS)
		CheckStatLT(NearestEnemyOf(Myself),10,THAC0)
	!InParty(NearestEnemyOf(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103316) // Wand: Paralyzation
		UseItem("wand04",NearestEnemyOf(Myself))
END

/////////////////////////////////////////////////////////////////////////////////////// Turn Undead
// Start turning undead if can turn nearby undead
IF
	ActionListEmpty()
	!ModalState(TURNUNDEAD)
	Range(Nearest([EVILCUTOFF.UNDEAD]),12)
	CanTurn(Nearest([EVILCUTOFF.UNDEAD]),5)
	!ButtonDisabled(BUTTON_TURNUNDEAD)
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103315) // Turn Undead
		Turn()
END

IF
	ActionListEmpty()
	!ModalState(TURNUNDEAD)
	Range(SecondNearest([EVILCUTOFF.UNDEAD]),12)
	CanTurn(SecondNearest([EVILCUTOFF.UNDEAD]),5)
	!ButtonDisabled(BUTTON_TURNUNDEAD)
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103315) // Turn Undead
		Turn()
END

IF
	ActionListEmpty()
	!ModalState(TURNUNDEAD)
	Range(ThirdNearest([EVILCUTOFF.UNDEAD]),12)
	CanTurn(ThirdNearest([EVILCUTOFF.UNDEAD]),5)
	!ButtonDisabled(BUTTON_TURNUNDEAD)
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103315) // Turn Undead
		Turn()
END

IF
	ActionListEmpty()
	!ModalState(TURNUNDEAD)
	Range(FourthNearest([EVILCUTOFF.UNDEAD]),12)
	CanTurn(FourthNearest([EVILCUTOFF.UNDEAD]),5)
	!ButtonDisabled(BUTTON_TURNUNDEAD)
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103315) // Turn Undead
		Turn()
END

IF
	ActionListEmpty()
	!ModalState(TURNUNDEAD)
	Range(FifthNearest([EVILCUTOFF.UNDEAD]),12)
	CanTurn(FifthNearest([EVILCUTOFF.UNDEAD]),5)
	!ButtonDisabled(BUTTON_TURNUNDEAD)
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103315) // Turn Undead
		Turn()
END

IF
	ActionListEmpty()
	!ModalState(TURNUNDEAD)
	Range(SixthNearest([EVILCUTOFF.UNDEAD]),12)
	CanTurn(SixthNearest([EVILCUTOFF.UNDEAD]),5)
	!ButtonDisabled(BUTTON_TURNUNDEAD)
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103315) // Turn Undead
		Turn()
END

IF
	ActionListEmpty()
	!ModalState(TURNUNDEAD)
	Range(SeventhNearest([EVILCUTOFF.UNDEAD]),12)
	CanTurn(SeventhNearest([EVILCUTOFF.UNDEAD]),5)
	!ButtonDisabled(BUTTON_TURNUNDEAD)
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103315) // Turn Undead
		Turn()
END

// Keep turning undead if already turning nearby undead
IF
	ActionListEmpty()
	ModalState(TURNUNDEAD)
	Range([EVILCUTOFF.UNDEAD],12)
	OR(7)
		CanTurn(Nearest([EVILCUTOFF.UNDEAD]),5)
		CanTurn(SecondNearest([EVILCUTOFF.UNDEAD]),5)
		CanTurn(ThirdNearest([EVILCUTOFF.UNDEAD]),5)
		CanTurn(FourthNearest([EVILCUTOFF.UNDEAD]),5)
		CanTurn(FifthNearest([EVILCUTOFF.UNDEAD]),5)
		CanTurn(SixthNearest([EVILCUTOFF.UNDEAD]),5)
		CanTurn(SeventhNearest([EVILCUTOFF.UNDEAD]),5)
THEN
	RESPONSE #100
END

////////////////////////////////////////////////////////////////////////////////// Aura Of Flaming Death

IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_AURA_OF_FLAMING_DEATH)
	HPPercentGT(NearestEnemyOf(Myself),0)

	OR(4)
		CheckStatLT(LastSeenBy(Myself),5,SAVEVSSPELL)
		CheckStatLT(LastSeenBy(Myself),0,ARMORCLASS)
		CheckStatGT(LastSeenBy(Myself),75,MAXHITPOINTS)
		CheckStatLT(LastSeenBy(Myself),10,THAC0)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
	    SetGlobalTimer("castnattack","LOCALS",6)
		////DisplayStringHead(Myself,?) // Spell: Aura Of Flaming Death
		Spell(Myself,CLERIC_AURA_OF_FLAMING_DEATH)
END

////////////////////////////////////////////////////////////////////////////////// Buff Items

IF 
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	Class(Myself,MAGE_ALL)
	CheckStatLT(Myself,24,INT)
	HasItem("potn29",Myself)  // Potion Of Genius
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		////DisplayStringHead(Myself,?) // Potion Of Genius
		UseItem("potn29",Myself)  // Potion Of Genius
END

IF 
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	Class(Myself,MAGE_ALL)
	CheckStatLT(Myself,24,INT)
	HasItem("potn37",Myself)  // Potion Of Mind Focusing
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		////DisplayStringHead(Myself,?) // Potion Of Mind Focusing
		UseItem("potn37",Myself)  // Potion Of Mind Focusing
END

IF 
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	Class(Myself,FIGHTER_ALL)
	CheckStatLT(Myself,24,DEX)
	HasItem("potn37",Myself)  // Potion Of Mind Focusing
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		////DisplayStringHead(Myself,?) // Potion Of Mind Focusing
		UseItem("potn37",Myself)  // Potion Of Mind Focusing
END

IF 
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	Class(Myself,CLERIC_ALL)
	CheckStatLT(Myself,18,WIS)
	HasItem("potn43",Myself)  // Potion Of Insight
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		////DisplayStringHead(Myself,?) // Potion Of Insight
		UseItem("potn43",Myself)  // Potion Of Insight
END

//IF
//	ActionListEmpty()
//    !GlobalTimerNotExpired("castnattack","LOCALS")
//	Global("cloakGargoyle","GLOBAL",1)
//	HasItem("bdclck05",Myself) // Cloak Of The Gargoyle - Stone Form Once Per Day
//	//CheckStat(Myself,0,STONESKINS)
//	//CheckStat(Myself,0,STONESKINSGOLEM)
//	//!CheckSpellState(Myself,STONESKIN)
//THEN
//	RESPONSE #100
//      SetGlobalTimer("castnattack","LOCALS",6)
//		//DisplayStringHead(Myself,71483) // Item: Cloak Of The Gargoyle
//		SetGlobal("cloakGargoyle","GLOBAL",0)
//		UseItemSlotAbility(Myself,SLOT_CLOAK,1)
//END

////////////////////////////////////////////////////////////////////////////////// If have a buff spell use it

// 1 Round = 6 Seconds Real Time
// 1 Turn = 10 Rounds = 1 Minute Real time
// 1 Hour = 5 Turns = 50 Rounds = 5 Minutes Real Time

// Level 1
// 50 Rounds (5 minutes) - 15ft Radius
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_REMOVE_FEAR)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103306) // Spell: Remove Fear
		Spell(Myself,CLERIC_REMOVE_FEAR)
END

// Level 4 - Necromancy 7
// 10 Rounds/Level (60 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_DEATH_WARD)
	!CheckSpellState(PartySlot1,DEATH_WARD)
	!CheckStat(PartySlot1,1,DEATH_WARD)

	!CheckStat(PartySlot1,1,MINORGLOBE)
	!CheckStat(PartySlot1,7,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot1,4)
	!StateCheck(PartySlot1,STATE_INVISIBLE)
	!StateCheck(PartySlot1,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot1,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103366) // Spell: Death Ward
		Spell(PartySlot1,CLERIC_DEATH_WARD)
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_DEATH_WARD)
	!CheckSpellState(PartySlot2,DEATH_WARD)
	!CheckStat(PartySlot2,1,DEATH_WARD)

	!CheckStat(PartySlot2,1,MINORGLOBE)
	!CheckStat(PartySlot2,7,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot2,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot2,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot2,4)
	!StateCheck(PartySlot2,STATE_INVISIBLE)
	!StateCheck(PartySlot2,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot2,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103366) // Spell: Death Ward
		Spell(PartySlot2,CLERIC_DEATH_WARD)
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_DEATH_WARD)
	!CheckSpellState(PartySlot3,DEATH_WARD)
	!CheckStat(PartySlot3,1,DEATH_WARD)

	!CheckStat(PartySlot3,1,MINORGLOBE)
	!CheckStat(PartySlot3,7,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot3,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot3,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot3,4)
	!StateCheck(PartySlot3,STATE_INVISIBLE)
	!StateCheck(PartySlot3,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot3,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103366) // Spell: Death Ward
		Spell(PartySlot3,CLERIC_DEATH_WARD)
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_DEATH_WARD)
	!CheckSpellState(PartySlot4,DEATH_WARD)
	!CheckStat(PartySlot4,1,DEATH_WARD)

	!CheckStat(PartySlot4,1,MINORGLOBE)
	!CheckStat(PartySlot4,7,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot4,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot4,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot4,4)
	!StateCheck(PartySlot4,STATE_INVISIBLE)
	!StateCheck(PartySlot4,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot4,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103366) // Spell: Death Ward
		Spell(PartySlot4,CLERIC_DEATH_WARD)
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_DEATH_WARD)
	!CheckSpellState(PartySlot5,DEATH_WARD)
	!CheckStat(PartySlot5,1,DEATH_WARD)

	!CheckStat(PartySlot5,1,MINORGLOBE)
	!CheckStat(PartySlot5,7,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot5,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot5,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot5,4)
	!StateCheck(PartySlot5,STATE_INVISIBLE)
	!StateCheck(PartySlot5,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot5,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103366) // Spell: Death Ward
		Spell(PartySlot5,CLERIC_DEATH_WARD)
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_DEATH_WARD)
	!CheckSpellState(PartySlot6,DEATH_WARD)
	!CheckStat(PartySlot6,1,DEATH_WARD)

	!CheckStat(PartySlot6,1,MINORGLOBE)
	!CheckStat(PartySlot6,7,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot6,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot6,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot6,4)
	!StateCheck(PartySlot6,STATE_INVISIBLE)
	!StateCheck(PartySlot6,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot6,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103366) // Spell: Death Ward
		Spell(PartySlot6,CLERIC_DEATH_WARD)
END

// Level 4 - Abjuration 1
// 5 Rounds/Level (30 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_PROTECTION_FROM_LIGHTNING)
	CheckStatLT(PartySlot1,99,RESISTELECTRICITY)


	!CheckStat(PartySlot1,1,MINORGLOBE)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot1,4)
	!StateCheck(PartySlot1,STATE_INVISIBLE)
	!StateCheck(PartySlot1,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot1,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103296) // Spell: Protection From Lightning
		Spell(PartySlot1,CLERIC_PROTECTION_FROM_LIGHTNING)
END

// Level 4
// 4 Rounds/Level (24 seconds/Level) - 15ft Radius
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_PROTECTION_FROM_EVIL_10_FOOT)
	!CheckSpellState(Myself,PROTECTION_FROM_EVIL)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103304) // Spell: Protection Group From Evil
		Spell(Myself,CLERIC_PROTECTION_FROM_EVIL_10_FOOT)
END

// Level 5 - Enchantment 4
// 4 Rounds/Level (24 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(PartySlot1,0,CLERIC_CHAOTIC_COMMANDS)

	!CheckStat(PartySlot1,1,MINORGLOBE)
	!CheckStat(PartySlot1,4,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot1,5)
	!StateCheck(PartySlot1,STATE_INVISIBLE)
	!StateCheck(PartySlot1,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot1,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103300) // Spell: Chaotic Commands
		Spell(PartySlot1,CLERIC_CHAOTIC_COMMANDS)
END

// Level 5 - Enchantment 4
// 4 Rounds/Level (24 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(PartySlot2,0,CLERIC_CHAOTIC_COMMANDS)

	!CheckStat(PartySlot2,1,MINORGLOBE)
	!CheckStat(PartySlot2,4,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot2,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot2,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot2,5)
	!StateCheck(PartySlot2,STATE_INVISIBLE)
	!StateCheck(PartySlot2,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot2,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103300) // Spell: Chaotic Commands
		Spell(PartySlot2,CLERIC_CHAOTIC_COMMANDS)
END

// Level 5 - Enchantment 4
// 4 Rounds/Level (24 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(PartySlot3,0,CLERIC_CHAOTIC_COMMANDS)

	!CheckStat(PartySlot3,1,MINORGLOBE)
	!CheckStat(PartySlot3,4,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot3,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot3,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot3,5)
	!StateCheck(PartySlot3,STATE_INVISIBLE)
	!StateCheck(PartySlot3,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot3,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103300) // Spell: Chaotic Commands
		Spell(PartySlot3,CLERIC_CHAOTIC_COMMANDS)
END

// Level 5 - Enchantment 4
// 4 Rounds/Level (24 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(PartySlot4,0,CLERIC_CHAOTIC_COMMANDS)

	!CheckStat(PartySlot4,1,MINORGLOBE)
	!CheckStat(PartySlot4,4,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot4,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot4,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot4,5)
	!StateCheck(PartySlot4,STATE_INVISIBLE)
	!StateCheck(PartySlot4,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot4,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103300) // Spell: Chaotic Commands
		Spell(PartySlot4,CLERIC_CHAOTIC_COMMANDS)
END

// Level 5 - Enchantment 4
// 4 Rounds/Level (24 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(PartySlot5,0,CLERIC_CHAOTIC_COMMANDS)

	!CheckStat(PartySlot5,1,MINORGLOBE)
	!CheckStat(PartySlot5,4,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot5,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot5,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot5,5)
	!StateCheck(PartySlot5,STATE_INVISIBLE)
	!StateCheck(PartySlot5,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot5,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103300) // Spell: Chaotic Commands
		Spell(PartySlot5,CLERIC_CHAOTIC_COMMANDS)
END

// Level 5 - Enchantment 4
// 4 Rounds/Level (24 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(PartySlot6,0,CLERIC_CHAOTIC_COMMANDS)

	!CheckStat(PartySlot6,1,MINORGLOBE)
	!CheckStat(PartySlot6,4,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot6,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot6,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot6,5)
	!StateCheck(PartySlot6,STATE_INVISIBLE)
	!StateCheck(PartySlot6,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot6,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103300) // Spell: Chaotic Commands
		Spell(PartySlot6,CLERIC_CHAOTIC_COMMANDS)
END

// Level 1 - Abjuration 1
// 3 Rounds/Level (18 seconds/Level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_PROTECT_FROM_EVIL)
	!CheckSpellState(PartySlot1,PROTECTION_FROM_EVIL)
	!CheckStatGT(PartySlot1,0,PROTECTION_FROM_EVIL)

	!CheckStat(PartySlot1,1,MINORGLOBE)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot1,1)
	!StateCheck(PartySlot1,STATE_INVISIBLE)
	!StateCheck(PartySlot1,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot1,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103305) // Spell: Protection From Evil
		Spell(PartySlot1,CLERIC_PROTECT_FROM_EVIL)
END

// Level 1
// 3 Rounds/Level (18 seconds/Level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_PROTECT_FROM_EVIL)
	!CheckSpellState(PartySlot2,PROTECTION_FROM_EVIL)
	!CheckStatGT(PartySlot2,0,PROTECTION_FROM_EVIL)

	!CheckStat(PartySlot2,1,MINORGLOBE)
	!CheckStat(PartySlot2,1,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot2,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot2,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot2,1)
	!StateCheck(PartySlot2,STATE_INVISIBLE)
	!StateCheck(PartySlot2,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot2,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103305) // Spell: Protection From Evil
		Spell(PartySlot2,CLERIC_PROTECT_FROM_EVIL)
END

// Level 1
// 3 Rounds/Level (18 seconds/Level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_PROTECT_FROM_EVIL)
	!CheckSpellState(PartySlot3,PROTECTION_FROM_EVIL)
	!CheckStatGT(PartySlot3,0,PROTECTION_FROM_EVIL)

	!CheckStat(PartySlot3,1,MINORGLOBE)
	!CheckStat(PartySlot3,1,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot3,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot3,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot3,1)
	!StateCheck(PartySlot3,STATE_INVISIBLE)
	!StateCheck(PartySlot3,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot3,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103305) // Spell: Protection From Evil
		Spell(PartySlot3,CLERIC_PROTECT_FROM_EVIL)
END

// Level 1
// 3 Rounds/Level (18 seconds/Level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_PROTECT_FROM_EVIL)
	!CheckSpellState(PartySlot4,PROTECTION_FROM_EVIL)
	!CheckStatGT(PartySlot4,0,PROTECTION_FROM_EVIL)

	!CheckStat(PartySlot4,1,MINORGLOBE)
	!CheckStat(PartySlot4,1,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot4,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot4,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot4,1)
	!StateCheck(PartySlot4,STATE_INVISIBLE)
	!StateCheck(PartySlot4,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot4,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103305) // Spell: Protection From Evil
		Spell(PartySlot4,CLERIC_PROTECT_FROM_EVIL)
END

// Level 1
// 3 Rounds/Level (18 seconds/Level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_PROTECT_FROM_EVIL)
	!CheckSpellState(PartySlot5,PROTECTION_FROM_EVIL)
	!CheckStatGT(PartySlot5,0,PROTECTION_FROM_EVIL)

	!CheckStat(PartySlot5,1,MINORGLOBE)
	!CheckStat(PartySlot5,1,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot5,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot5,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot5,1)
	!StateCheck(PartySlot5,STATE_INVISIBLE)
	!StateCheck(PartySlot5,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot5,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103305) // Spell: Protection From Evil
		Spell(PartySlot5,CLERIC_PROTECT_FROM_EVIL)
END

// Level 1
// 3 Rounds/Level (18 seconds/Level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_PROTECT_FROM_EVIL)
	!CheckSpellState(PartySlot6,PROTECTION_FROM_EVIL)
	!CheckStatGT(PartySlot6,0,PROTECTION_FROM_EVIL)

	!CheckStat(PartySlot6,1,MINORGLOBE)
	!CheckStat(PartySlot6,1,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot6,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot6,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot6,1)
	!StateCheck(PartySlot6,STATE_INVISIBLE)
	!StateCheck(PartySlot6,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot6,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103305) // Spell: Protection From Evil
		Spell(PartySlot6,CLERIC_PROTECT_FROM_EVIL)
END

// Level 5 - Alteration 8
// 3 Rounds/Level (18 seconds/level) - 1 Creature
IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_CHAMPIONS_STRENGTH)
	CheckStatLT(WeakestOf(Myself),18,STRENGTH_MODIFIER)

	!CheckStat(WeakestOf(Myself),1,MINORGLOBE)
	!CheckStat(WeakestOf(Myself),8,WIZARD_SPELL_IMMUNITY)
	!CheckStat(WeakestOf(Myself),1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(WeakestOf(Myself),1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(WeakestOf(Myself),5)
	!StateCheck(WeakestOf(Myself),STATE_INVISIBLE)
	!StateCheck(WeakestOf(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(WeakestOf(Myself),STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
	    SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103285) // Spell: Champions Strength
		Spell(WeakestOf(Myself),CLERIC_CHAMPIONS_STRENGTH)
END

// Level 4 - Abjuration 1
// 10 Rounds + 1 Round/Level (60 seconds + 6 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_FREE_ACTION)
	CheckStat(PartySlot1,0,CLERIC_FREE_ACTION)
	!CheckSpellState(PartySlot1,FREE_ACTION)

	!CheckStat(PartySlot1,1,MINORGLOBE)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot1,4)
	!StateCheck(PartySlot1,STATE_INVISIBLE)
	!StateCheck(PartySlot1,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot1,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//? //DisplayStringHead(Myself,?) // Spell: Free Action
		Spell(PartySlot1,CLERIC_FREE_ACTION)
END

// Level 4 - Abjuration 1
// 10 Rounds + 1 Round/Level (60 seconds + 6 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_FREE_ACTION)
	CheckStat(PartySlot2,0,CLERIC_FREE_ACTION)
	!CheckSpellState(PartySlot2,FREE_ACTION)

	!CheckStat(PartySlot2,1,MINORGLOBE)
	!CheckStat(PartySlot2,1,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot2,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot2,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot2,4)
	!StateCheck(PartySlot2,STATE_INVISIBLE)
	!StateCheck(PartySlot2,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot2,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//? //DisplayStringHead(Myself,?) // Spell: Free Action
		Spell(PartySlot2,CLERIC_FREE_ACTION)
END

// Level 4 - Abjuration 1
// 10 Rounds + 1 Round/Level (60 seconds + 6 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_FREE_ACTION)
	CheckStat(PartySlot3,0,CLERIC_FREE_ACTION)
	!CheckSpellState(PartySlot3,FREE_ACTION)

	!CheckStat(PartySlot3,1,MINORGLOBE)
	!CheckStat(PartySlot3,1,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot3,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot3,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot3,4)
	!StateCheck(PartySlot3,STATE_INVISIBLE)
	!StateCheck(PartySlot3,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot3,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//? //DisplayStringHead(Myself,?) // Spell: Free Action
		Spell(PartySlot3,CLERIC_FREE_ACTION)
END

// Level 4 - Abjuration 1
// 10 Rounds + 1 Round/Level (60 seconds + 6 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_FREE_ACTION)
	CheckStat(PartySlot4,0,CLERIC_FREE_ACTION)
	!CheckSpellState(PartySlot4,FREE_ACTION)

	!CheckStat(PartySlot4,1,MINORGLOBE)
	!CheckStat(PartySlot4,1,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot4,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot4,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot4,4)
	!StateCheck(PartySlot4,STATE_INVISIBLE)
	!StateCheck(PartySlot4,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot4,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//? //DisplayStringHead(Myself,?) // Spell: Free Action
		Spell(PartySlot4,CLERIC_FREE_ACTION)
END

// Level 4 - Abjuration 1
// 10 Rounds + 1 Round/Level (60 seconds + 6 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_FREE_ACTION)
	CheckStat(PartySlot5,0,CLERIC_FREE_ACTION)
	!CheckSpellState(PartySlot5,FREE_ACTION)

	!CheckStat(PartySlot5,1,MINORGLOBE)
	!CheckStat(PartySlot5,1,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot5,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot5,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot5,4)
	!StateCheck(PartySlot5,STATE_INVISIBLE)
	!StateCheck(PartySlot5,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot5,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//? //DisplayStringHead(Myself,?) // Spell: Free Action
		Spell(PartySlot5,CLERIC_FREE_ACTION)
END

// Level 4 - Abjuration 1
// 10 Rounds + 1 Round/Level (60 seconds + 6 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_FREE_ACTION)
	CheckStat(PartySlot6,0,CLERIC_FREE_ACTION)
	!CheckSpellState(PartySlot6,FREE_ACTION)

	!CheckStat(PartySlot6,1,MINORGLOBE)
	!CheckStat(PartySlot6,1,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot6,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot6,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot6,4)
	!StateCheck(PartySlot6,STATE_INVISIBLE)
	!StateCheck(PartySlot6,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot6,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//? //DisplayStringHead(Myself,?) // Spell: Free Action
		Spell(PartySlot6,CLERIC_FREE_ACTION)
END

// Level 2 - Alteration 8
// 4 Rounds + 1 Round/Level (24 seconds + 6 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_BARKSKIN)
	!CheckSpellState(PartySlot1,BARKSKIN)
	NumInPartyGT(0)

	!Heard([ANYONE],CASTING_BARKSKIN) // If someone else casting barkskin

	!CheckStat(PartySlot1,1,MINORGLOBE)
	!CheckStat(PartySlot1,8,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot1,2)
	!StateCheck(PartySlot1,STATE_INVISIBLE)
	!StateCheck(PartySlot1,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot1,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103303) // Spell: Barkskin
		Shout(CASTING_BARKSKIN) // Casting Barksin
		Spell(PartySlot1,CLERIC_BARKSKIN)
END

// Level 2 - Alteration 8
// 4 Rounds + 1 Round/Level (24 seconds + 6 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_BARKSKIN)
	!CheckSpellState(PartySlot2,BARKSKIN)
	NumInPartyGT(1)

	!Heard([ANYONE],CASTING_BARKSKIN) // If someone else casting barkskin

	!CheckStat(PartySlot2,1,MINORGLOBE)
	!CheckStat(PartySlot2,8,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot2,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot2,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot2,2)
	!StateCheck(PartySlot2,STATE_INVISIBLE)
	!StateCheck(PartySlot2,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot2,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103303) // Spell: Barkskin
		Shout(CASTING_BARKSKIN) // Casting Barksin
		Spell(PartySlot2,CLERIC_BARKSKIN)
END

// Level 2 - Alteration 8
// 4 Rounds + 1 Round/Level (24 seconds + 6 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_BARKSKIN)
	!CheckSpellState(PartySlot3,BARKSKIN)
	NumInPartyGT(2)

	!Heard([ANYONE],CASTING_BARKSKIN) // If someone else casting barkskin

	!CheckStat(PartySlot3,1,MINORGLOBE)
	!CheckStat(PartySlot3,8,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot3,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot3,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot3,2)
	!StateCheck(PartySlot3,STATE_INVISIBLE)
	!StateCheck(PartySlot3,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot3,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103303) // Spell: Barkskin
		Shout(CASTING_BARKSKIN) // Casting Barksin
		Spell(PartySlot3,CLERIC_BARKSKIN)
END

// Level 2 - Alteration 8
// 4 Rounds + 1 Round/Level (24 seconds + 6 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_BARKSKIN)
	!CheckSpellState(PartySlot4,BARKSKIN)
	NumInPartyGT(3)

	!Heard([ANYONE],CASTING_BARKSKIN) // If someone else casting barkskin

	!CheckStat(PartySlot4,1,MINORGLOBE)
	!CheckStat(PartySlot4,8,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot4,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot4,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot4,2)
	!StateCheck(PartySlot4,STATE_INVISIBLE)
	!StateCheck(PartySlot4,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot4,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103303) // Spell: Barkskin
		Shout(CASTING_BARKSKIN) // Casting Barksin
		Spell(PartySlot4,CLERIC_BARKSKIN)
END

// Level 2 - Alteration 8
// 4 Rounds + 1 Round/Level (24 seconds + 6 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_BARKSKIN)
	!CheckSpellState(PartySlot5,BARKSKIN)
	NumInPartyGT(4)

	!Heard([ANYONE],CASTING_BARKSKIN) // If someone else casting barkskin

	!CheckStat(PartySlot5,1,MINORGLOBE)
	!CheckStat(PartySlot5,8,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot5,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot5,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot5,2)
	!StateCheck(PartySlot5,STATE_INVISIBLE)
	!StateCheck(PartySlot5,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot5,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103303) // Spell: Barkskin
		Shout(CASTING_BARKSKIN) // Casting Barksin
		Spell(PartySlot5,CLERIC_BARKSKIN)
END

// Level 2 - Alteration 8
// 4 Rounds + 1 Round/Level (24 seconds + 6 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_BARKSKIN)
	!CheckSpellState(PartySlot6,BARKSKIN)
	NumInPartyGT(5)

	!Heard([ANYONE],CASTING_BARKSKIN) // If someone else casting barkskin

	!CheckStat(PartySlot6,1,MINORGLOBE)
	!CheckStat(PartySlot6,8,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot6,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot6,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot6,2)
	!StateCheck(PartySlot6,STATE_INVISIBLE)
	!StateCheck(PartySlot6,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot6,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103303) // Spell: Barkskin
		Shout(CASTING_BARKSKIN) // Casting Barksin
		Spell(PartySlot6,CLERIC_BARKSKIN)
END

// Level 1
// 4 Rounds + 1 Round/Level (24 seconds + 6 seconds/level) - Self
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_SHILLELAGH)  // SPPR110.SPL (Shillelagh)
	!HasItem("FBLADE",Myself)  // Flame Blade
	!HasItem("SHILLE",Myself)  // Shillelagh
	!HasItem("SHAMMR",Myself)  // Spiritual Hammer
	!HasItem("CHILLT",Myself)  // Chill Touch
	!HasItem("GHOULT",Myself)  // Ghoul Touch

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103302) // Spell: Shillelagh
		Spell(Myself,CLERIC_SHILLELAGH)  // SPPR110.SPL (Shillelagh)
END

// Level 2
// 4 Rounds + 1 Round/Level (24 seconds + 6 seconds/level) - Self
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_FLAME_BLADE)
	!HasItem("FBLADE",Myself)  // Flame Blade
	!HasItem("SHILLE",Myself)  // Shillelagh
	!HasItem("SHAMMR",Myself)  // Spiritual Hammer
	!HasItem("CHILLT",Myself)  // Chill Touch
	!HasItem("GHOULT",Myself)  // Ghoul Touch

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103301) // Spell: Flame Blade
		Spell(Myself,CLERIC_FLAME_BLADE)
END

// Level 1
// 3 Rounds + 1 Round/Level (18 seconds + 6 seconds/level) - Self
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_ARMOR_OF_FAITH)
	!CheckSpellState(Myself,ARMOR_OF_FAITH)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103298) // Spell: Armor Of Faith
		Spell(Myself,CLERIC_ARMOR_OF_FAITH)
END

// Level 3 - Abjuration 1
// 3 Rounds + 1 Round/Level (18 seconds + 6 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_PROTECTION_FROM_FIRE)
	CheckStatLT(PartySlot1,99,RESISTFIRE)

	!CheckStat(PartySlot1,1,MINORGLOBE)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot1,3)
	!StateCheck(PartySlot1,STATE_INVISIBLE)
	!StateCheck(PartySlot1,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot1,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103295) // Spell: Protection From Fire
		Spell(PartySlot1,CLERIC_PROTECTION_FROM_FIRE)
END

// Level 5 - Alteration 8
// 3 Rounds + 1 Round/Level (18 seconds + 6 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_MAGIC_RESISTANCE)
	CheckStatLT(PartySlot1,99,RESISTMAGIC)

	!CheckStat(PartySlot1,1,MINORGLOBE)
	!CheckStat(PartySlot1,8,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot1,5)
	!StateCheck(PartySlot1,STATE_INVISIBLE)
	!StateCheck(PartySlot1,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot1,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103294) // Spell: Magic Resistance
		Spell(PartySlot1,CLERIC_MAGIC_RESISTANCE)
END

// Level 2 - Necromancy 2, Conjuration 7
// 1 Round + 1 Round/Level (6 seconds + 6 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_AID)
	!CheckSpellState(PartySlot1,AID)

	!CheckStat(PartySlot1,1,MINORGLOBE)
	!CheckStat(PartySlot1,2,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot1,7,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot1,2)
	!StateCheck(PartySlot1,STATE_INVISIBLE)
	!StateCheck(PartySlot1,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot1,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103288) // Spell: Aid
		Spell(PartySlot1,CLERIC_AID)
END

IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_RECITATION)  // SPPR513.SPL (Righteous Magic)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
	    SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103290) // Spell: Righteous Magic
		Spell(Myself,CLERIC_RECITATION)
END

IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_RIGHTEOUS_WRATH_OF_THE_FAITHFUL)  // SPPR513.SPL (Righteous Magic)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
	    SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103290) // Spell: Righteous Magic
		Spell(Myself,CLERIC_RIGHTEOUS_WRATH_OF_THE_FAITHFUL)
END

// Level 5
// 1 Round/Level (6 seconds/level) - Self
IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_RIGHTEOUS_MAGIC)  // SPPR513.SPL (Righteous Magic)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
	    SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103290) // Spell: Righteous Magic
		Spell(WeakestOf(Myself),CLERIC_RIGHTEOUS_MAGIC)
END

// Note: There is no resist fire or resist cold spell for clerics but a single resist fire and cold spell
// Casting CLERIC_RESIST_FIRE or CLERIC_RESIST_COLD actually casts the resist fire and cold spell
// Level 2 - Alteration 8
// 1 Round/Level (6 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_RESIST_FIRE)
	OR(2)
		CheckStatLT(PartySlot1,99,RESISTFIRE)
		CheckStatLT(PartySlot1,99,RESISTCOLD)

	!CheckStat(PartySlot1,1,MINORGLOBE)
	!CheckStat(PartySlot1,8,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot1,2)
	!StateCheck(PartySlot1,STATE_INVISIBLE)
	!StateCheck(PartySlot1,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot1,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103293) // Spell: Resist Fire And Cold
		Spell(PartySlot1,CLERIC_RESIST_FIRE)
END

// Level 4
// 1 Rounds/Level (6 seconds/level) - Self
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_HOLY_POWER)
	!CheckSpellState(Myself,HOLY_POWER)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103297) // Spell: Holy Power
		Spell(Myself,CLERIC_HOLY_POWER)
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_ENTROPY_SHIELD)
	!CheckSpellState(Myself,ENTROPY_SHIELD)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103297) // Spell: Holy Power
		Spell(Myself,CLERIC_ENTROPY_SHIELD)
END

// Level 3
// 10 Rounds (60 seconds) - 15ft Radius
IF
	ActionListEmpty()
	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_STRENGTH_OF_ONE)
	CheckStatLT(WeakestOf(Myself),18,STRENGTH_MODIFIER)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
	    SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103291) // Spell: Strength Of One
		Spell(WeakestOf(Myself),CLERIC_STRENGTH_OF_ONE)
END

// Level 2 - Conjuration 2
// 10 Rounds (60 seconds) - 15ft Radius
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_CHANT)  // SPPR203.SPL (Chant)
	!StateCheck(PartySlot1,STATE_CHANT)

	!CheckStat(PartySlot1,1,MINORGLOBE)
	!CheckStat(PartySlot1,2,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot1,2)
	!StateCheck(PartySlot1,STATE_INVISIBLE)
	!StateCheck(PartySlot1,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot1,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103286) // Spell: Chant
		Spell(PartySlot1,CLERIC_CHANT)  // SPPR203.SPL (Chant)
END

// Level 1 - Conjuration 2
// 6 Rounds (36 seconds) - 15ft Radius
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_BLESS)  // SPPR101.SPL (Bless)
	!StateCheck(PartySlot1,STATE_BLESS)

	!CheckStat(PartySlot1,1,MINORGLOBE)
	!CheckStat(PartySlot1,2,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot1,1)
	!StateCheck(PartySlot1,STATE_INVISIBLE)
	!StateCheck(PartySlot1,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot1,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103287) // Spell: Bless
		Spell(PartySlot1,CLERIC_BLESS)  // SPPR101.SPL (Bless)
END

// Level 4
// 6 Rounds (36 seconds) - 15ft Radius
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_DEFENSIVE_HARMONY)
	!CheckStat(Myself,1,CLERIC_DEFENSIVE_HARMONY)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103289) // Spell: Defensive Harmony
		Spell(Myself,CLERIC_DEFENSIVE_HARMONY)
END

// Level 2
// 4 Rounds (24 seconds) - Self
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_DRAW_UPON_HOLY_MIGHT)
	!CheckSpellState(Myself,DRAW_UPON_HOLY_MIGHT)
	!StateCheck(Myself,STATE_DRAWUPONHOLYMIGHT)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103299) // Spell: Holy Might
		Spell(Myself,CLERIC_DRAW_UPON_HOLY_MIGHT)
END

// Level 10
// 4 Minutes or Until Charges Depleted - Self
IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_ENERGY_BLADES)
	!HasItem("ENEBLADE",Myself)
	!HasItem("MELFMET",Myself)

	OR(4)
		See(NearestEnemyOfType([0.0.0.BARD_ALL]))
		See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
		See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
		See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		////DisplayStringHead(Myself,?) // Spell: Energy Blades
		Spell(Myself,WIZARD_ENERGY_BLADES)
END

IF
	ActionListEmpty()
  	!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_ENERGY_BLADES)
	!HasItem("ENEBLADE",Myself)
	!HasItem("MELFMET",Myself)

	OR(4)
		See(NearestEnemyOfType([0.0.0.BARD_ALL]))
		See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
		See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
		See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		////DisplayStringHead(Myself,?) // Spell: Energy Blades
		Spell(Myself,CLERIC_ENERGY_BLADES)
END

// Level 3
// Until Charges Depleted - Self
IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_MELF_METEOR)
	!HasItem("ENEBLADE",Myself)
	!HasItem("MELFMET",Myself)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103279) // Spell: Melfs Minute Meteors
		Spell(Myself,WIZARD_MELF_METEOR)
END

IF
	ActionListEmpty()
	OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_CATS_GRACE)
	CheckStatLT(PartySlot1,19,DEX)
	!CheckSpellState(PartySlot1,CATS_GRACE)
	
	!CheckStat(PartySlot1,1,MINORGLOBE)
	!CheckStat(PartySlot1,8,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_TURNING)
	!StateCheck(PartySlot1,STATE_INVISIBLE)
	!StateCheck(PartySlot1,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot1,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
	    SetGlobalTimer("castnattack","LOCALS",6)
		Spell(PartySlot1,WIZARD_CATS_GRACE)
END

IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_EMOTION_HOPE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Spell(Myself,WIZARD_EMOTION_HOPE)
END

IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_EMOTION_COURAGE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Spell(Myself,WIZARD_EMOTION_COURAGE)
END

// Level 6
// 10 Rounds/Level (60 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
	!CheckStatGT(Myself,0,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
	!Heard([ANYONE],CASTING_PROTECTION_FROM_MAGIC_ENERGY) // If someone else casting protection from magic energy

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Shout(CASTING_PROTECTION_FROM_MAGIC_ENERGY)
		////DisplayStringHead(Myself,103373) // Spell: Protection From Magic Energy
		Spell(Myself,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
END

// Level 2 - Alteration 8
// 10 Rounds/Level (60 seconds/level) - 1 Creature
IF
	ActionListEmpty()
	OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_STRENGTH)
	CheckStatLT(WeakestOf(Myself),18,STRENGTH_MODIFIER)

	!CheckStat(WeakestOf(Myself),1,MINORGLOBE)
	!CheckStat(WeakestOf(Myself),8,WIZARD_SPELL_IMMUNITY)
	!CheckStat(WeakestOf(Myself),1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(WeakestOf(Myself),1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(WeakestOf(Myself),2)
	!StateCheck(WeakestOf(Myself),STATE_INVISIBLE)
	!StateCheck(WeakestOf(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(WeakestOf(Myself),STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
	    SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103278) // Spell: Strength
		Spell(WeakestOf(Myself),WIZARD_STRENGTH)
END

// Level 5 - Abjuration 1
// 10 Rounds/Level (60 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_PROTECTION_FROM_ACID)
	CheckStatLT(PartySlot1,99,RESISTACID)

	!CheckStat(PartySlot1,1,MINORGLOBE)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot1,5)
	!StateCheck(PartySlot1,STATE_INVISIBLE)
	!StateCheck(PartySlot1,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot1,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103277) // Spell: Protection From Acid
		Spell(PartySlot1,WIZARD_PROTECTION_FROM_ACID)
END

// Level 3 - Abjuration 1
// 10 Rounds/Level (60 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_PROTECTION_FROM_FIRE)
	CheckStatLT(PartySlot1,99,RESISTFIRE)

	!CheckStat(PartySlot1,1,MINORGLOBE)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_IMMUNITY)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_DEFLECTION)
	!CheckStat(PartySlot1,1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(PartySlot1,3)
	!StateCheck(PartySlot1,STATE_INVISIBLE)
	!StateCheck(PartySlot1,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(PartySlot1,STATE_NOT_TARGETABLE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103276) // Spell: Protection From Fire
		Spell(PartySlot1,WIZARD_PROTECTION_FROM_FIRE)
END

// Level 1
// 50 rounds (5 minutes) - Self
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_SHIELD)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		////DisplayStringHead(Myself,71406) // Spell: Shield
		Spell(Myself,WIZARD_SHIELD)
END

// Level 2
// 50 Rounds (5 minutes) - 15ft Radius
IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_RESIST_FEAR)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103283) // Spell: Resist Fear
		Spell(Myself,WIZARD_RESIST_FEAR)
END

IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_SEVEN_EYES)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103303) // Spell: Barkskin
		Spell(Myself,WIZARD_SEVEN_EYES)
END

// Level 2 - Illusion 5
// 4 Rounds + 2 Round/Level (24 seconds + 12 seconds/level) - Self
IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_BLUR)
	!StateCheck(Myself,STATE_BLUR)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		////DisplayStringHead(Myself,?) // Spell: Blur
		Spell(Myself,WIZARD_BLUR)
END

// Level 2
// 3 Rounds + 1 Rounds/Level (18 seconds + 6 seconds/level) - Self
IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_MIRROR_IMAGE)
	!StateCheck(Myself,STATE_MIRRORIMAGE)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103282) // Spell: Mirror Image
		Spell(Myself,WIZARD_MIRROR_IMAGE)
END

// Level 4
// 3 Rounds + 1 Rounds/Level (18 seconds + 6 seconds/level) - 1 Creature
IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_IMPROVED_INVISIBILITY)
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103280) // Spell: Improved Invisibility
		Spell(Myself,WIZARD_IMPROVED_INVISIBILITY)
END

//////////////////////////////////////////////////////////////////////////// Decide On Next Target You Can See
// Protect The Wizard if their attacker is not disabled
IF
	ActionListEmpty()

	HPPercentGT(LastAttackerOf(NearestMyGroupOfType([ALLY.0.0.MAGE_ALL.0.0.0])),0)
	!InParty(LastAttackerOf(NearestMyGroupOfType([ALLY.0.0.MAGE_ALL.0.0.0])))

	!CheckSpellState(LastAttackerOf(NearestMyGroupOfType([ALLY.0.0.MAGE_ALL.0.0.0])),HOPELESSNESS)
	!CheckSpellState(LastAttackerOf(NearestMyGroupOfType([ALLY.0.0.MAGE_ALL.0.0.0])),HELD)
	!CheckSpellState(LastAttackerOf(NearestMyGroupOfType([ALLY.0.0.MAGE_ALL.0.0.0])),ENTANGLE)
	!CheckSpellState(LastAttackerOf(NearestMyGroupOfType([ALLY.0.0.MAGE_ALL.0.0.0])),WEB)
	!StateCheck(LastAttackerOf(NearestMyGroupOfType([ALLY.0.0.MAGE_ALL.0.0.0])),STATE_CHARMED)
	!StateCheck(LastAttackerOf(NearestMyGroupOfType([ALLY.0.0.MAGE_ALL.0.0.0])),STATE_CONFUSED)
	!StateCheck(LastAttackerOf(NearestMyGroupOfType([ALLY.0.0.MAGE_ALL.0.0.0])),STATE_SLEEPING)
	!StateCheck(LastAttackerOf(NearestMyGroupOfType([ALLY.0.0.MAGE_ALL.0.0.0])),STATE_DISABLED)
	!StateCheck(LastAttackerOf(NearestMyGroupOfType([ALLY.0.0.MAGE_ALL.0.0.0])),STATE_PANIC)
	!StateCheck(LastAttackerOf(NearestMyGroupOfType([ALLY.0.0.MAGE_ALL.0.0.0])),STATE_NOT_TARGETABLE)

	See(LastAttackerOf(NearestMyGroupOfType([ALLY.0.0.MAGE_ALL.0.0.0])))
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103271) // Helping Wizard
		Continue()
END

// Help hurt allies if their attacker is not disabled
IF
	ActionListEmpty()

	// Skip if protecting wizard
	OR(2)
		!HPPercentGT(LastAttackerOf(PartySlot1),0)
		!See(LastAttackerOf(PartySlot1))

	HPPercentLT(MostDamagedOf(Myself),80)
	HPPercentGT(LastAttackerOf(MostDamagedOf(Myself)),0)

	!CheckSpellState(LastAttackerOf(MostDamagedOf(Myself)),HOPELESSNESS)
	!CheckSpellState(LastAttackerOf(MostDamagedOf(Myself)),HELD)
	!CheckSpellState(LastAttackerOf(MostDamagedOf(Myself)),ENTANGLE)
	!CheckSpellState(LastAttackerOf(MostDamagedOf(Myself)),WEB)
	!StateCheck(LastAttackerOf(MostDamagedOf(Myself)),STATE_CHARMED)
	!StateCheck(LastAttackerOf(MostDamagedOf(Myself)),STATE_CONFUSED)
	!StateCheck(LastAttackerOf(MostDamagedOf(Myself)),STATE_SLEEPING)
	!StateCheck(LastAttackerOf(MostDamagedOf(Myself)),STATE_DISABLED)
	!StateCheck(LastAttackerOf(MostDamagedOf(Myself)),STATE_PANIC)
	!StateCheck(LastAttackerOf(MostDamagedOf(Myself)),STATE_NOT_TARGETABLE)

	See(LastAttackerOf(MostDamagedOf(Myself)))
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103247) // Helping Allies
		Continue()
END

// Attack Enemy Spellcasters if they are not disabled
IF
	ActionListEmpty()

	// Skip if helping hurt allies
	OR(2)
		!HPPercentLT(MostDamagedOf(Myself),80)
		!See(LastAttackerOf(MostDamagedOf(Myself)))

	// Skip if protecting wizard
	OR(2)
		!HPPercentGT(LastAttackerOf(PartySlot1),0)
		!See(LastAttackerOf(PartySlot1))

	HPPercentGT(NearestEnemyOfType([0.0.0.MAGE_ALL]),0)

	!CheckSpellState(NearestEnemyOfType([0.0.0.MAGE_ALL]),HOPELESSNESS)
	!CheckSpellState(NearestEnemyOfType([0.0.0.MAGE_ALL]),HELD)
	!CheckSpellState(NearestEnemyOfType([0.0.0.MAGE_ALL]),ENTANGLE)
	!CheckSpellState(NearestEnemyOfType([0.0.0.MAGE_ALL]),WEB)
	!StateCheck(NearestEnemyOfType([0.0.0.MAGE_ALL]),STATE_CHARMED)
	!StateCheck(NearestEnemyOfType([0.0.0.MAGE_ALL]),STATE_CONFUSED)
	!StateCheck(NearestEnemyOfType([0.0.0.MAGE_ALL]),STATE_SLEEPING)
	!StateCheck(NearestEnemyOfType([0.0.0.MAGE_ALL]),STATE_DISABLED)
	!StateCheck(NearestEnemyOfType([0.0.0.MAGE_ALL]),STATE_PANIC)
	!StateCheck(NearestEnemyOfType([0.0.0.MAGE_ALL]),STATE_NOT_TARGETABLE)

	See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103270) // Attacking Spellcasters
		Continue()
END

IF
	ActionListEmpty()

	// Skip if helping hurt allies
	OR(2)
		!HPPercentLT(MostDamagedOf(Myself),80)
		!See(LastAttackerOf(MostDamagedOf(Myself)))

	// Skip if protecting wizard
	OR(2)
		!HPPercentGT(LastAttackerOf(PartySlot1),0)
		!See(LastAttackerOf(PartySlot1))

	// Skip if attacking spellcaster
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.MAGE_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.MAGE_ALL]))

	HPPercentGT(NearestEnemyOfType([0.0.0.CLERIC_ALL]),0)

	!CheckSpellState(NearestEnemyOfType([0.0.0.CLERIC_ALL]),HOPELESSNESS)
	!CheckSpellState(NearestEnemyOfType([0.0.0.CLERIC_ALL]),HELD)
	!CheckSpellState(NearestEnemyOfType([0.0.0.CLERIC_ALL]),ENTANGLE)
	!CheckSpellState(NearestEnemyOfType([0.0.0.CLERIC_ALL]),WEB)
	!StateCheck(NearestEnemyOfType([0.0.0.CLERIC_ALL]),STATE_CHARMED)
	!StateCheck(NearestEnemyOfType([0.0.0.CLERIC_ALL]),STATE_CONFUSED)
	!StateCheck(NearestEnemyOfType([0.0.0.CLERIC_ALL]),STATE_SLEEPING)
	!StateCheck(NearestEnemyOfType([0.0.0.CLERIC_ALL]),STATE_DISABLED)
	!StateCheck(NearestEnemyOfType([0.0.0.CLERIC_ALL]),STATE_PANIC)
	!StateCheck(NearestEnemyOfType([0.0.0.CLERIC_ALL]),STATE_NOT_TARGETABLE)

	See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103270) // Attacking Spellcasters
		Continue()
END

IF
	ActionListEmpty()

	// Skip if helping hurt allies
	OR(2)
		!HPPercentLT(MostDamagedOf(Myself),80)
		!See(LastAttackerOf(MostDamagedOf(Myself)))

	// Skip if protecting wizard
	OR(2)
		!HPPercentGT(LastAttackerOf(PartySlot1),0)
		!See(LastAttackerOf(PartySlot1))

	// Skip if attacking spellcaster
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.MAGE_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.CLERIC_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))

	HPPercentGT(NearestEnemyOfType([0.0.0.DRUID_ALL]),0)

	!CheckSpellState(NearestEnemyOfType([0.0.0.DRUID_ALL]),HOPELESSNESS)
	!CheckSpellState(NearestEnemyOfType([0.0.0.DRUID_ALL]),HELD)
	!CheckSpellState(NearestEnemyOfType([0.0.0.DRUID_ALL]),ENTANGLE)
	!CheckSpellState(NearestEnemyOfType([0.0.0.DRUID_ALL]),WEB)
	!StateCheck(NearestEnemyOfType([0.0.0.DRUID_ALL]),STATE_CHARMED)
	!StateCheck(NearestEnemyOfType([0.0.0.DRUID_ALL]),STATE_CONFUSED)
	!StateCheck(NearestEnemyOfType([0.0.0.DRUID_ALL]),STATE_SLEEPING)
	!StateCheck(NearestEnemyOfType([0.0.0.DRUID_ALL]),STATE_DISABLED)
	!StateCheck(NearestEnemyOfType([0.0.0.DRUID_ALL]),STATE_PANIC)
	!StateCheck(NearestEnemyOfType([0.0.0.DRUID_ALL]),STATE_NOT_TARGETABLE)

	See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103270) // Attacking Spellcasters
		Continue()
END

IF
	ActionListEmpty()

	// Skip if helping hurt allies
	OR(2)
		!HPPercentLT(MostDamagedOf(Myself),80)
		!See(LastAttackerOf(MostDamagedOf(Myself)))

	// Skip if protecting wizard
	OR(2)
		!HPPercentGT(LastAttackerOf(PartySlot1),0)
		!See(LastAttackerOf(PartySlot1))

	// Skip if attacking spellcaster
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.MAGE_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.CLERIC_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.DRUID_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.DRUID_ALL]))

	HPPercentGT(NearestEnemyOfType([0.0.0.BARD_ALL]),0)

	!CheckSpellState(NearestEnemyOfType([0.0.0.BARD_ALL]),HOPELESSNESS)
	!CheckSpellState(NearestEnemyOfType([0.0.0.BARD_ALL]),HELD)
	!CheckSpellState(NearestEnemyOfType([0.0.0.BARD_ALL]),ENTANGLE)
	!CheckSpellState(NearestEnemyOfType([0.0.0.BARD_ALL]),WEB)
	!StateCheck(NearestEnemyOfType([0.0.0.BARD_ALL]),STATE_CHARMED)
	!StateCheck(NearestEnemyOfType([0.0.0.BARD_ALL]),STATE_CONFUSED)
	!StateCheck(NearestEnemyOfType([0.0.0.BARD_ALL]),STATE_SLEEPING)
	!StateCheck(NearestEnemyOfType([0.0.0.BARD_ALL]),STATE_DISABLED)
	!StateCheck(NearestEnemyOfType([0.0.0.BARD_ALL]),STATE_PANIC)
	!StateCheck(NearestEnemyOfType([0.0.0.BARD_ALL]),STATE_NOT_TARGETABLE)

	See(NearestEnemyOfType([0.0.0.BARD_ALL]))
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103270) // Attacking Spellcasters
		Continue()
END

// If attacked by an enemy attack them if they are not disabled
IF 
	ActionListEmpty()

	// Skip if protecting wizard
	OR(2)
		!HPPercentGT(LastAttackerOf(PartySlot1),0)
		!See(LastAttackerOf(PartySlot1))

	// Skip if protecting wizard
	OR(2)
		!HPPercentGT(LastAttackerOf([ALLY.0.0.MAGE_ALL.0.0.0]),0)
		!See(LastAttackerOf([ALLY.0.0.MAGE_ALL.0.0.0]))

	// Skip if attacking spellcaster
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.MAGE_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.CLERIC_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.DRUID_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.BARD_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.BARD_ALL]))

	AttackedBy([ENEMY],DEFAULT)
	!InParty(LastAttackerOf(Myself))
	
	!CheckSpellState(LastAttackerOf(Myself),HOPELESSNESS)
	!CheckSpellState(LastAttackerOf(Myself),HELD)
	!CheckSpellState(LastAttackerOf(Myself),ENTANGLE)
	!CheckSpellState(LastAttackerOf(Myself),WEB)
	!StateCheck(LastAttackerOf(Myself),STATE_CHARMED)
	!StateCheck(LastAttackerOf(Myself),STATE_CONFUSED)
	!StateCheck(LastAttackerOf(Myself),STATE_SLEEPING)
	!StateCheck(LastAttackerOf(Myself),STATE_DISABLED)
	!StateCheck(LastAttackerOf(Myself),STATE_PANIC)
	!StateCheck(LastAttackerOf(Myself),STATE_NOT_TARGETABLE)

	See(LastAttackerOf(Myself))
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103269) // Attacking My Attacker
		Continue()
END

// Attack weakest enemy that is not disabled
IF
	ActionListEmpty()

	// Skip if helping hurt allies
	OR(2)
		!HPPercentLT(MostDamagedOf(Myself),80)
		!See(LastAttackerOf(MostDamagedOf(Myself)))

	// Skip if protecting wizard
	OR(2)
		!HPPercentGT(LastAttackerOf(PartySlot1),0)
		!See(LastAttackerOf(PartySlot1))

	// Skip if attacking spellcaster
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.MAGE_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.CLERIC_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.DRUID_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.BARD_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.BARD_ALL]))

	// Skip if attacking my attacker
	!AttackedBy([ENEMY],DEFAULT)

	HPPercentLT(NearestEnemyOf(Myself),50)

	!CheckSpellState(NearestEnemyOf(Myself),HOPELESSNESS)
	!CheckSpellState(NearestEnemyOf(Myself),HELD)
	!CheckSpellState(NearestEnemyOf(Myself),ENTANGLE)
	!CheckSpellState(NearestEnemyOf(Myself),WEB)
	!StateCheck(NearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(NearestEnemyOf(Myself),STATE_CONFUSED)
	!StateCheck(NearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(NearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(NearestEnemyOf(Myself),STATE_NOT_TARGETABLE)

	See(NearestEnemyOf(Myself))
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103268) // Attacking Weakest Enemy
		Continue()
END

IF
	ActionListEmpty()

	// Skip if helping hurt allies
	OR(2)
		!HPPercentLT(MostDamagedOf(Myself),80)
		!See(LastAttackerOf(MostDamagedOf(Myself)))

	// Skip if protecting wizard
	OR(2)
		!HPPercentGT(LastAttackerOf(PartySlot1),0)
		!See(LastAttackerOf(PartySlot1))

	// Skip if attacking spellcaster
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.MAGE_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.CLERIC_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.DRUID_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.BARD_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.BARD_ALL]))

	// Skip if attacking my attacker
	!AttackedBy([ENEMY],DEFAULT)

	// Skip if attacking weakest enemy
	!HPPercentLT(NearestEnemyOf(Myself),50)

	HPPercentLT(SecondNearestEnemyOf(Myself),50)

	!CheckSpellState(SecondNearestEnemyOf(Myself),HOPELESSNESS)
	!CheckSpellState(SecondNearestEnemyOf(Myself),HELD)
	!CheckSpellState(SecondNearestEnemyOf(Myself),ENTANGLE)
	!CheckSpellState(SecondNearestEnemyOf(Myself),WEB)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_CONFUSED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_NOT_TARGETABLE)

	See(SecondNearestEnemyOf(Myself))
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103268) // Attacking Weakest Enemy
		Continue()
END

IF
	ActionListEmpty()

	// Skip if helping hurt allies
	OR(2)
		!HPPercentLT(MostDamagedOf(Myself),80)
		!See(LastAttackerOf(MostDamagedOf(Myself)))

	// Skip if protecting wizard
	OR(2)
		!HPPercentGT(LastAttackerOf(PartySlot1),0)
		!See(LastAttackerOf(PartySlot1))

	// Skip if attacking spellcaster
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.MAGE_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.CLERIC_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.DRUID_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.BARD_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.BARD_ALL]))

	// Skip if attacking my attacker
	!AttackedBy([ENEMY],DEFAULT)

	// Skip if attacking weakest enemy
	!HPPercentLT(NearestEnemyOf(Myself),50)
	!HPPercentLT(SecondNearestEnemyOf(Myself),50)

	HPPercentLT(ThirdNearestEnemyOf(Myself),50)
	
	!CheckSpellState(ThirdNearestEnemyOf(Myself),HOPELESSNESS)
	!CheckSpellState(ThirdNearestEnemyOf(Myself),HELD)
	!CheckSpellState(ThirdNearestEnemyOf(Myself),ENTANGLE)
	!CheckSpellState(ThirdNearestEnemyOf(Myself),WEB)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_CONFUSED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_NOT_TARGETABLE)

	See(ThirdNearestEnemyOf(Myself))
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103268) // Attacking Weakest Enemy
		Continue()
END

// Attack nearby enemies you can see that are not disabled
IF
	ActionListEmpty()

	// Skip if helping hurt allies
	OR(2)
		!HPPercentLT(MostDamagedOf(Myself),80)
		!See(LastAttackerOf(MostDamagedOf(Myself)))

	// Skip if protecting wizard
	OR(2)
		!HPPercentGT(LastAttackerOf(PartySlot1),0)
		!See(LastAttackerOf(PartySlot1))

	// Skip if attacking spellcaster
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.MAGE_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.CLERIC_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.DRUID_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.BARD_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.BARD_ALL]))

	// Skip if attacking my attacker
	!AttackedBy([ENEMY],DEFAULT)

	// Skip if attacking weakest enemy
	!HPPercentLT(NearestEnemyOf(Myself),50)
	!HPPercentLT(SecondNearestEnemyOf(Myself),50)
	!HPPercentLT(ThirdNearestEnemyOf(Myself),50)

	!CheckSpellState(NearestEnemyOf(Myself),HOPELESSNESS)
	!CheckSpellState(NearestEnemyOf(Myself),HELD)
	!CheckSpellState(NearestEnemyOf(Myself),ENTANGLE)
	!CheckSpellState(NearestEnemyOf(Myself),WEB)
	!StateCheck(NearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(NearestEnemyOf(Myself),STATE_CONFUSED)
	!StateCheck(NearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(NearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(NearestEnemyOf(Myself),STATE_NOT_TARGETABLE)

	See(NearestEnemyOf(Myself))
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103267) // Attacking Nearby Enemies
		Continue()
END

IF
	ActionListEmpty()

	// Skip if helping hurt allies
	OR(2)
		!HPPercentLT(MostDamagedOf(Myself),80)
		!See(LastAttackerOf(MostDamagedOf(Myself)))

	// Skip if protecting wizard
	OR(2)
		!HPPercentGT(LastAttackerOf(PartySlot1),0)
		!See(LastAttackerOf(PartySlot1))

	// Skip if attacking spellcaster
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.MAGE_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.CLERIC_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.DRUID_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.BARD_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.BARD_ALL]))

	// Skip if attacking my attacker
	!AttackedBy([ENEMY],DEFAULT)

	// Skip if attacking weakest enemy
	!HPPercentLT(NearestEnemyOf(Myself),50)
	!HPPercentLT(SecondNearestEnemyOf(Myself),50)
	!HPPercentLT(ThirdNearestEnemyOf(Myself),50)

	!CheckSpellState(SecondNearestEnemyOf(Myself),HOPELESSNESS)
	!CheckSpellState(SecondNearestEnemyOf(Myself),HELD)
	!CheckSpellState(SecondNearestEnemyOf(Myself),ENTANGLE)
	!CheckSpellState(SecondNearestEnemyOf(Myself),WEB)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_CONFUSED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_NOT_TARGETABLE)

	See(SecondNearestEnemyOf(Myself))
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103267) // Attacking Nearby Enemies
		Continue()
END

IF
	ActionListEmpty()

	// Skip if helping hurt allies
	OR(2)
		!HPPercentLT(MostDamagedOf(Myself),80)
		!See(LastAttackerOf(MostDamagedOf(Myself)))

	// Skip if protecting wizard
	OR(2)
		!HPPercentGT(LastAttackerOf(PartySlot1),0)
		!See(LastAttackerOf(PartySlot1))

	// Skip if attacking spellcaster
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.MAGE_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.CLERIC_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.DRUID_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.BARD_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.BARD_ALL]))

	// Skip if attacking my attacker
	!AttackedBy([ENEMY],DEFAULT)

	// Skip if attacking weakest enemy
	!HPPercentLT(NearestEnemyOf(Myself),50)
	!HPPercentLT(SecondNearestEnemyOf(Myself),50)
	!HPPercentLT(ThirdNearestEnemyOf(Myself),50)

	!CheckSpellState(ThirdNearestEnemyOf(Myself),HOPELESSNESS)
	!CheckSpellState(ThirdNearestEnemyOf(Myself),HELD)
	!CheckSpellState(ThirdNearestEnemyOf(Myself),ENTANGLE)
	!CheckSpellState(ThirdNearestEnemyOf(Myself),WEB)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_CONFUSED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_NOT_TARGETABLE)

	See(ThirdNearestEnemyOf(Myself))
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103267) // Attacking Nearby Enemies
		Continue()
END

// Attack nearby enemies you can see
IF
	ActionListEmpty()

	// Skip if helping hurt allies
	OR(2)
		!HPPercentLT(MostDamagedOf(Myself),80)
		!See(LastAttackerOf(MostDamagedOf(Myself)))

	// Skip if protecting wizard
	OR(2)
		!HPPercentGT(LastAttackerOf(PartySlot1),0)
		!See(LastAttackerOf(PartySlot1))

	// Skip if attacking spellcaster
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.MAGE_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.CLERIC_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.DRUID_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
	OR(2)
		!HPPercentGT(NearestEnemyOfType([0.0.0.BARD_ALL]),0)
		!See(NearestEnemyOfType([0.0.0.BARD_ALL]))

	// Skip if attacking my attacker
	!AttackedBy([ENEMY],DEFAULT)

	// Skip if attacking weakest enemy
	!HPPercentLT(NearestEnemyOf(Myself),50)
	!HPPercentLT(SecondNearestEnemyOf(Myself),50)
	!HPPercentLT(ThirdNearestEnemyOf(Myself),50)

	See(NearestEnemyOf(Myself))
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103267) // Attacking Nearby Enemies
		Continue()
END

//////////////////////////////////////////////////////////////////////////////////// Berserker Rage

IF
	ActionListEmpty()
	OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(BERSERKER_RAGE)
	!StateCheck(Myself,STATE_BERSERK)
	HPPercentGT(NearestEnemyOf(Myself),0)
	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Spell(Myself,BERSERKER_RAGE)
END

////////////////////////////////////////////////////////////////////////////////////// Offensive Spells On Target You Can See

// Level 7 - Alteration (8)
IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_SPHERE_OF_CHAOS)
	HPPercentGT(NearestEnemyOf(Myself),0)

	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
	!ImmuneToSpellLevel(LastSeenBy(Myself),7)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)

	OR(4)
		CheckStatLT(LastSeenBy(Myself),5,SAVEVSSPELL)
		CheckStatLT(LastSeenBy(Myself),0,ARMORCLASS)
		CheckStatGT(LastSeenBy(Myself),75,MAXHITPOINTS)
		CheckStatLT(LastSeenBy(Myself),10,THAC0)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,?) // Spell: Sphere Of Chaos
		Spell(LastSeenBy(Myself),WIZARD_SPHERE_OF_CHAOS)
END

// Level 10
IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_DRAGONS_BREATH)
	HPPercentGT(NearestEnemyOf(Myself),0)

	!ImmuneToSpellLevel(LastSeenBy(Myself),10)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	CheckStatGT(LastSeenBy(Myself),50,RESISTMAGIC)

	OR(4)
		CheckStatLT(LastSeenBy(Myself),5,SAVEVSSPELL)
		CheckStatLT(LastSeenBy(Myself),0,ARMORCLASS)
		CheckStatGT(LastSeenBy(Myself),75,MAXHITPOINTS)
		CheckStatLT(LastSeenBy(Myself),10,THAC0)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//////DisplayStringHead(Myself,?) // Spell: Dragons Breath
		Spell(LastSeenBy(Myself),WIZARD_DRAGONS_BREATH)
END

// Level 8 - Necromancy (7)
IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_ABI_DALZIMS_HORRID_WILTING)
	HPPercentGT(NearestEnemyOf(Myself),0)

	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	!ImmuneToSpellLevel(LastSeenBy(Myself),8)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)
	
	OR(4)
		CheckStatLT(LastSeenBy(Myself),5,SAVEVSSPELL)
		CheckStatLT(LastSeenBy(Myself),0,ARMORCLASS)
		CheckStatGT(LastSeenBy(Myself),75,MAXHITPOINTS)
		CheckStatLT(LastSeenBy(Myself),10,THAC0)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,?) // Spell: Horrid Wilting
		Spell(LastSeenBy(Myself),WIZARD_ABI_DALZIMS_HORRID_WILTING)
END

IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_MORDENKAINENS_FORCE_MISSILES)
	HPPercentGT(NearestEnemyOf(Myself),0)

	!CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)

	!ImmuneToSpellLevel(LastSeenBy(Myself),4)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		Spell(LastSeenBy(Myself),WIZARD_MORDENKAINENS_FORCE_MISSILES)
END

// Level 6 - Evocation
IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_CHAIN_LIGHTNING)
	HPPercentGT(NearestEnemyOf(Myself),0)

	!CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(LastSeenBy(Myself),6)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	CheckStatLT(LastSeenBy(Myself),49,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),49,RESISTELECTRICITY)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		////DisplayStringHead(Myself,?) // Spell: Chain Lightning
		Spell(LastSeenBy(Myself),WIZARD_CHAIN_LIGHTNING)
END

// Level 3 - Evocation
IF
	Class(Myself,MAGE_ALL)
	HaveSpell(WIZARD_FIREBALL)
	!Range(TenthNearestEnemyOf(Myself),17)
	!StateCheck(TenthNearestEnemyOf(Myself),STATE_REALLY_DEAD)

	!TriggerOverride(TenthNearestEnemyOf(Myself),Range(NearestEnemyOf(Myself),22))
	See(TenthNearestEnemyOf(Myself)) // Target the fireball target
	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		SetGlobalTimer("castingfireball","LOCALS",6) // Starting fireball
		//DisplayStringHead(Myself,103266) // Spell: Fireball
		Spell(TenthNearestEnemyOf(Myself),WIZARD_FIREBALL)
END

// Level 1 - Evocation
IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_MAGIC_MISSILE)
	HPPercentGT(NearestEnemyOf(Myself),0)

	!CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)

	!ImmuneToSpellLevel(LastSeenBy(Myself),1)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103264) // Spell: Magic Missile
		Spell(LastSeenBy(Myself),WIZARD_MAGIC_MISSILE)
END

// Level 1 - Evocation
IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_CHROMATIC_ORB)
	HPPercentGT(NearestEnemyOf(Myself),0)

	!CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(LastSeenBy(Myself),1)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103265) // Spell: Chromatic Orb
		Spell(LastSeenBy(Myself),WIZARD_CHROMATIC_ORB)
END

// Level 3 - Conjuration
IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_FLAME_ARROW)
	HPPercentGT(NearestEnemyOf(Myself),0)

	!CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING) 
	!ImmuneToSpellLevel(LastSeenBy(Myself),3)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)

	CheckStatGT(LastSeenBy(Myself),5,SAVEVSSPELL)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103263) // Spell: Flame Arrow
		Spell(LastSeenBy(Myself),WIZARD_FLAME_ARROW)
END

// Level 2 - Conjuration
IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_MELF_ACID_ARROW)
	HPPercentGT(NearestEnemyOf(Myself),0)

	!CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING) 
	!ImmuneToSpellLevel(LastSeenBy(Myself),2)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	CheckStatLT(LastSeenBy(Myself),75,RESISTACID)
	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103262) // Spell: Melf Acid Arrow
		Spell(LastSeenBy(Myself),WIZARD_MELF_ACID_ARROW)
END

// Level 2 - Evocation
IF
	ActionListEmpty()
    OR(2)
  		CheckStat(Myself,1,AURACLEANSING)
  		!GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(WIZARD_AGANNAZAR_SCORCHER)
	HPPercentGT(NearestEnemyOf(Myself),0)

	!CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) 
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(LastSeenBy(Myself),2)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103261) // Spell: Agannazar Scorcher
		Spell(LastSeenBy(Myself),WIZARD_AGANNAZAR_SCORCHER)
END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_SUNSCORCH)
	HPPercentGT(NearestEnemyOf(Myself),0)

	!CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY) 
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(LastSeenBy(Myself),1)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103260) // Spell: Holy Smite
		Spell(LastSeenBy(Myself),CLERIC_SUNSCORCH)
END

// Level 3 - Necromancy
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_HOLY_SMITE)
	HPPercentGT(NearestEnemyOf(Myself),0)

	!CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY) 
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(LastSeenBy(Myself),3)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103260) // Spell: Holy Smite
		Spell(LastSeenBy(Myself),CLERIC_HOLY_SMITE)
END

// Level 3 - Alteration
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HaveSpell(CLERIC_CALL_LIGHTNING)
	HPPercentGT(NearestEnemyOf(Myself),0)

	!CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY) 
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!ImmuneToSpellLevel(LastSeenBy(Myself),3)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		////DisplayStringHead(Myself,?) // Spell: Call Lightning
		Spell(LastSeenBy(Myself),CLERIC_CALL_LIGHTNING)
END

//////////////////////////////////////////////////////////////////// Offensive Wands On Targets You Can See
//IF
//    ActionListEmpty()
  //  !GlobalTimerNotExpired("castnattack","LOCALS")
//	Class(Myself,MAGE_ALL)
//	HPPercentGT(NearestEnemyOf(Myself),0)
//	HasItem("wand06",Myself)
//	CheckStatGT(LastSeenBy(Myself),5,SAVEVSWANDS)
//	OR(4)
//		CheckStatLT(LastSeenBy(Myself),5,SAVEVSSPELL)
//		CheckStatLT(LastSeenBy(Myself),0,ARMORCLASS)
//		CheckStatGT(LastSeenBy(Myself),75,MAXHITPOINTS)
//		CheckStatLT(LastSeenBy(Myself),10,THAC0)
//	!InParty(LastSeenBy(Myself))
//THEN
//	RESPONSE #100
//        SetGlobalTimer("castnattack","LOCALS",6)
//		//DisplayStringHead(Myself,103257) // Wand: Frost
//		UseItem("wand06",LastSeenBy(Myself))
//END

IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	Class(Myself,MAGE_ALL)
	HPPercentGT(NearestEnemyOf(Myself),0)
	HasItem("wand03",Myself)
	CheckStatGT(LastSeenBy(Myself),5,SAVEVSWANDS)
	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103256) // Wand: Magic Missile
		UseItem("wand03",LastSeenBy(Myself))
END

IF
  	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	Class(Myself,CLERIC_ALL)
	HPPercentGT(NearestEnemyOf(Myself),0)
	HasItem("wand11",Myself)
	CheckStatGT(LastSeenBy(Myself),5,SAVEVSWANDS)
	OR(4)
		CheckStatLT(LastSeenBy(Myself),5,SAVEVSSPELL)
		CheckStatLT(LastSeenBy(Myself),0,ARMORCLASS)
		CheckStatGT(LastSeenBy(Myself),75,MAXHITPOINTS)
		CheckStatLT(LastSeenBy(Myself),10,THAC0)
	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103255) // Wand: Heavens
		UseItem("wand11",LastSeenBy(Myself))
END

IF
	Class(Myself,MAGE_ALL)
	HasItem("wand05",Myself)
	!Range(TenthNearestEnemyOf(Myself),17)
	!StateCheck(TenthNearestEnemyOf(Myself),STATE_REALLY_DEAD)

	!TriggerOverride(TenthNearestEnemyOf(Myself),Range(NearestEnemyOf(Myself),22))
	See(TenthNearestEnemyOf(Myself)) // Target the fireball target
	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		SetGlobalTimer("castingfireball","LOCALS",6) // Starting fireball
		//DisplayStringHead(Myself,103259) // Wand: Fire
		XEquipItem("wand05",Myself,SLOT_MISC0,EQUIP)
		UseItemSlotAbility(TenthNearestEnemyOf(Myself),SLOT_MISC0,0)
END

//IF
//	Class(Myself,MAGE_ALL)
//	HasItem("wand05",Myself)
	//!InLine(LastSeenBy(Myself),PartySlot1)
	//!InLine(LastSeenBy(Myself),PartySlot2)
	//!InLine(LastSeenBy(Myself),PartySlot3)
	//!InLine(LastSeenBy(Myself),PartySlot4)
	//!InLine(LastSeenBy(Myself),PartySlot5)
	//!InLine(LastSeenBy(Myself),PartySlot6)

//	!CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
//	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY) 
//	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
//	!ImmuneToSpellLevel(LastSeenBy(Myself),2)

//	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
//	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
//	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

//	CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
//	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)

//	OR(4)
//		CheckStatLT(LastSeenBy(Myself),5,SAVEVSSPELL)
//		CheckStatLT(LastSeenBy(Myself),0,ARMORCLASS)
//		CheckStatGT(LastSeenBy(Myself),75,MAXHITPOINTS)
//		CheckStatLT(LastSeenBy(Myself),10,THAC0)
//	!InParty(LastSeenBy(Myself))
//THEN
//	RESPONSE #100
//        SetGlobalTimer("castnattack","LOCALS",6)
//		//DisplayStringHead(Myself,71433) // Wand: Fire
//		XEquipItem("wand05",Myself,SLOT_MISC0,EQUIP)
//		UseItemSlotAbility(LastSeenBy(Myself),SLOT_MISC0,1)
//END

//IF
//  ActionListEmpty()
//    !GlobalTimerNotExpired("castnattack","LOCALS")
//	Class(Myself,MAGE_ALL)
//	HasItem("wand10",Myself)
//	See(NearestEnemyOf(Myself))
//THEN
//	RESPONSE #100
//        SetGlobalTimer("castnattack","LOCALS",6)
//		//DisplayStringHead(Myself,71436) // Wand: Monster Summoning
//		UseItem("wand10",LastSeenBy(Myself))
//END

//IF
//  ActionListEmpty()
//    !GlobalTimerNotExpired("castnattack","LOCALS")
//	Class(Myself,MAGE_ALL)
//	HasItem("wand18",Myself)
//	See(NearestEnemyOf(Myself))
//THEN
//	RESPONSE #100
//        SetGlobalTimer("castnattack","LOCALS",6)
//		//DisplayStringHead(Myself,103258) // Wand: Spell Striking
//		UseItem("wand18",LastSeenBy(Myself))
//END

//////////////////////////////////////////////////////////////////// Scrolls: Offensive Spells

// Level 1 - Evocation
IF
	ActionListEmpty()
    !GlobalTimerNotExpired("castnattack","LOCALS")
	HasItem("SCRL77",Myself)
	HPPercentGT(NearestEnemyOf(Myself),0)

	!CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)

	!ImmuneToSpellLevel(LastSeenBy(Myself),1)

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)

	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!InParty(LastSeenBy(Myself))
THEN
	RESPONSE #100
        SetGlobalTimer("castnattack","LOCALS",6)
		//DisplayStringHead(Myself,103264) // Spell: Magic Missile
		UseItem("SCRL77",Myself)
END

//////////////////////////////////////////////////////////////////// Change Melee Weapon If Not Effective

//IF
//	ActionListEmpty()
//	//!GlobalTimerNotExpired("checkweapon0","LOCALS")
//	!IsWeaponRanged(Myself)
//	HPPercentGT(LastSeenBy(Myself),0)
//	!CheckWeaponCanDamageV2(LastSeenBy(Myself),BOTH)
//THEN
//	RESPONSE #100
//		//DisplayStringHead(Myself,71441) // Changing Weapon
//		SelectWeaponAbility(SLOT_WEAPON0,0)
//		//SetGlobalTimer("checkweapon0","LOCALS",20)
//END

//IF
//	ActionListEmpty()
//	//!GlobalTimerNotExpired("checkweapon1","LOCALS")
//	!IsWeaponRanged(Myself)
//	HPPercentGT(LastSeenBy(Myself),0)
//	!WeaponCanDamage(LastSeenBy(Myself),BOTH)
//THEN
//	RESPONSE #100
//		//DisplayStringHead(Myself,71441) // Changing Weapon
//		SelectWeaponAbility(SLOT_WEAPON1,0)
//		//SetGlobalTimer("checkweapon1","LOCALS",20)
//END

//IF
//	ActionListEmpty()
//	!GlobalTimerNotExpired("checkweapon2","LOCALS")
//	!IsWeaponRanged(Myself)
//	HPPercentGT(LastSeenBy(Myself),0)
//	!WeaponCanDamage(LastSeenBy(Myself),BOTH)
//THEN
//	RESPONSE #100
//		//DisplayStringHead(Myself,71441) // Changing Weapon
//		SelectWeaponAbility(SLOT_WEAPON2,0)
//		SetGlobalTimer("checkweapon2","LOCALS",20)
//END

//IF
//	ActionListEmpty()
//	!GlobalTimerNotExpired("checkweapon3","LOCALS")
//	!IsWeaponRanged(Myself)
//	HPPercentGT(LastSeenBy(Myself),0)
//	!WeaponCanDamage(LastSeenBy(Myself),BOTH)
//THEN
//	RESPONSE #100
//		//DisplayStringHead(Myself,71441) // Changing Weapon
//		SelectWeaponAbility(SLOT_WEAPON3,0)
//		SetGlobalTimer("checkweapon3","LOCALS",20)
//END

/////////////////////////////////////////////////////////// Equip Arrows If Out Of Ammo

//IF
//	!HasItemEquiped("AROW01",Myself)
//THEN
//	RESPONSE #100
///		//DisplayStringHead(Myself,10)
//END

IF
	!HasItemEquiped("AROW01",Myself) // passing for both
	HasItemCategory(Myself,BOW,FALSE) // passing for both when false, neither when true
	HasItem("AROW01",Myself) // Arrow
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103254) // Equipping Arrows
		XEquipItem("AROW01",Myself,SLOT_AMMO0,EQUIP)
		Continue()
END

//	HasItem("AROW02",Myself) // Arrow + 1
//	HasItem("AROW03",Myself) // Arrow Of Slaying
//	HasItem("AROW04",Myself) // Acid Arrow + 1
//	HasItem("AROW05",Myself) // Arrow Of Biting
//	HasItem("AROW06",Myself) // Arrow Of Detonation
//	HasItem("AROW07",Myself) // Arrow Of Dispelling
//	HasItem("AROW08",Myself) // Arrow Of Fire + 2
//	HasItem("AROW09",Myself) // Arrow Of Ice
//	HasItem("AROW10",Myself) // Arrow Of Piercing + 1
//	HasItem("AROW11",Myself) // Arrow + 2
//	HasItem("AROW12",Myself) // Arrow Of Biting
//	HasItem("AROW14",Myself) // Poisoned Arrow
//	HasItem("AROW15",Myself) // Arrow Of Ice
//	HasItem("AROW16",Myself) // Arrow Of Ice
//	HasItem("ANGAROW",Myself) // Arrow Of Fire + 2
//	HasItem("AROW1A",Myself) // Arrow + 2
//	HasItem("AROWKC",Myself) // Arrow Of Fire + 2
//	HasItem("ARROPHE2",Myself) // Arrow Of Fire + 2
//	HasItem("bdarow01",Myself) // Arrow Of Antimagic + 1
//	HasItem("bdarow03",Myself) // Flaming Arrow
//	HasItem("bdarow04",Myself) // Arrow + 3
//	HasItem("CUTAROW1",Myself) // Arrow Of Ice
//	HasItem("IAROW01",Myself) // Arrow
//	HasItem("QUIV01",Myself) // Arrow

//////////////////////////////////////////////////////// Share Ammo

IF
	!HasItem("AROW01",Myself) // Arrow
	!HasItem("AROW02",Myself) // Arrow + 1
	!HasItem("AROW03",Myself) // Arrow Of Slaying
	!HasItem("AROW04",Myself) // Acid Arrow + 1
	!HasItem("AROW05",Myself) // Arrow Of Biting
	!HasItem("AROW06",Myself) // Arrow Of Detonation
	!HasItem("AROW07",Myself) // Arrow Of Dispelling
	!HasItem("AROW08",Myself) // Arrow Of Fire + 2
	!HasItem("AROW09",Myself) // Arrow Of Ice
	!HasItem("AROW10",Myself) // Arrow Of Piercing + 1
	!HasItem("AROW11",Myself) // Arrow + 2
	!HasItem("AROW12",Myself) // Arrow Of Biting
	!HasItem("AROW15",Myself) // Arrow Of Ice
	!HasItem("AROW16",Myself) // Arrow Of Ice
//	!HasItem("bdarow01",Myself) // Arrow Of Antimagic + 1
//	!HasItem("bdarow03",Myself) // Flaming Arrow
//	!HasItem("bdarow04",Myself) // Arrow + 3
//	!HasItem("CUTAROW1",Myself) // Arrow Of Ice
	HasItemCategory(Myself,BOW,FALSE)
THEN
    RESPONSE #100
		//DisplayStringHead(Myself,103253) // Help: Need Arrows
        Shout(NEED_ARROWS) // Shout for help
		Continue()
END

IF
    Heard([ANYONE],NEED_ARROWS) // If someone shouted for help
    !HasItem("AROW01",LastHeardBy(Myself))
	HasItem("AROW01",Myself)
THEN
    RESPONSE #100
		//DisplayStringHead(Myself,103252) // Giving Arrows
        GiveItem("AROW01",LastHeardBy(Myself))
		Continue()
END

/////////////////////////////////////////////////////////// Change Ranged Ammo If Not Effective

IF
	ActionListEmpty()
	IsWeaponRanged(Myself)
	HPPercentGT(NearestEnemyOf(Myself),0)
	!WeaponEffectiveVs(NearestEnemyOf(Myself),MAINHAND)
	//!WeaponCanDamage(NearestEnemyOf(Myself),MAINHAND)
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103251) // Changing Weapon
		SelectWeaponAbility(SLOT_AMMO0,0)
		Continue()
END

IF
	ActionListEmpty()
	IsWeaponRanged(Myself)
	HPPercentGT(NearestEnemyOf(Myself),0)
	!WeaponEffectiveVs(NearestEnemyOf(Myself),MAINHAND)
	//!WeaponCanDamage(NearestEnemyOf(Myself),MAINHAND)
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103251) // Changing Weapon
		SelectWeaponAbility(SLOT_AMMO1,0)
		Continue()
END

IF
	ActionListEmpty()
	IsWeaponRanged(Myself)
	HPPercentGT(NearestEnemyOf(Myself),0)
	!WeaponEffectiveVs(NearestEnemyOf(Myself),MAINHAND)
	//!WeaponCanDamage(NearestEnemyOf(Myself),MAINHAND)
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103251) // Changing Weapon
		SelectWeaponAbility(SLOT_AMMO2,0)
		Continue()
END

IF
	ActionListEmpty()
	IsWeaponRanged(Myself)
	HPPercentGT(NearestEnemyOf(Myself),0)
	!WeaponEffectiveVs(NearestEnemyOf(Myself),MAINHAND)
	//!WeaponCanDamage(NearestEnemyOf(Myself),MAINHAND)
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103251) // Changing Weapon
		SelectWeaponAbility(SLOT_AMMO3,0)
		Continue()
END

/////////////////////////////////////////////////////////// Use Melfs Minute Meteors If Equipped

IF
	ActionListEmpty()
	HasItem("MELFMET",Myself)
	HPPercentGT(NearestEnemyOf(Myself),0)
	!InParty(LastSeenBy(Myself))

	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)

	CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
	CheckStatLT(LastSeenBy(Myself),75,RESISTMAGIC)
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103250) // Melfs Minute Meteors
		AttackOneRound(LastSeenBy(Myself))
END

///////////////////////////////////////////////////////// Melee/Ranged Non-Spell Attack
// Attack enemies that have been targeted
IF
	ActionListEmpty()
	//IsWeaponRanged(Myself)
	HPPercentGT(NearestEnemyOf(Myself),0)
	HPPercentGT(LastSeenBy(Myself),0)
	!InParty(LastSeenBy(Myself))
	//!Specifics(LastSeenBy(Myself),ALLIES)
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103360) // Normal Attack On Chosen Target
		SetGlobal("usingNormalAttack","LOCALS",1)
		AttackOneRound(LastSeenBy(Myself))
END

// If cant see nearby enemy go and attack the nearest
IF
	ActionListEmpty()
	//IsWeaponRanged(Myself)
	HPPercentGT(NearestEnemyOf(Myself),0)
	!InParty(NearestEnemyOf(Myself))
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103361) // Normal Attack On Nearby Enemies
		SetGlobal("usingNormalAttack","LOCALS",1)
		AttackOneRound(NearestEnemyOf(Myself))
END

// If no nearby enemies, attack attackers of allies
IF
	ActionListEmpty()
	//IsWeaponRanged(Myself)
	HPPercentGT(LastAttackerOf(PartySlot1),0)
	!InParty(LastAttackerOf(PartySlot1))
THEN
	RESPONSE #100
		AttackOneRound(LastAttackerOf(PartySlot1))
		SetGlobal("usingNormalAttack","LOCALS",1)
		//DisplayStringHead(Myself,103247) // Helping Allies
END

IF
	ActionListEmpty()
	//IsWeaponRanged(Myself)
	HPPercentGT(LastAttackerOf(PartySlot2),0)
	!InParty(LastAttackerOf(PartySlot2))
THEN
	RESPONSE #100
		AttackOneRound(LastAttackerOf(PartySlot2))
		SetGlobal("usingNormalAttack","LOCALS",1)
		//DisplayStringHead(Myself,103247) // Helping Allies
END

IF
	ActionListEmpty()
	//IsWeaponRanged(Myself)
	HPPercentGT(LastAttackerOf(PartySlot3),0)
	!InParty(LastAttackerOf(PartySlot3))
THEN
	RESPONSE #100
		AttackOneRound(LastAttackerOf(PartySlot3))
		SetGlobal("usingNormalAttack","LOCALS",1)
		//DisplayStringHead(Myself,103247) // Helping Allies
END

IF
	ActionListEmpty()
	//IsWeaponRanged(Myself)
	HPPercentGT(LastAttackerOf(PartySlot4),0)
	!InParty(LastAttackerOf(PartySlot4))
THEN
	RESPONSE #100
		AttackOneRound(LastAttackerOf(PartySlot4))
		SetGlobal("usingNormalAttack","LOCALS",1)
		//DisplayStringHead(Myself,103247) // Helping Allies
END

IF
	ActionListEmpty()
	//IsWeaponRanged(Myself)
	HPPercentGT(LastAttackerOf(PartySlot5),0)
	!InParty(LastAttackerOf(PartySlot5))
THEN
	RESPONSE #100
		AttackOneRound(LastAttackerOf(PartySlot5))
		SetGlobal("usingNormalAttack","LOCALS",1)
		//DisplayStringHead(Myself,103247) // Helping Allies
END

IF
	ActionListEmpty()
	//IsWeaponRanged(Myself)
	HPPercentGT(LastAttackerOf(PartySlot6),0)
	!InParty(LastAttackerOf(PartySlot6))
THEN
	RESPONSE #100
		AttackOneRound(LastAttackerOf(PartySlot6))
		SetGlobal("usingNormalAttack","LOCALS",1)
		//DisplayStringHead(Myself,103247) // Helping Allies
END

////////////////////////////////////////////////////////// Wizard Use Healing If No Enemies

/////////////////////////////////////////////////////////// Find traps
IF
	ActionListEmpty()
	Class(Myself,THIEF_ALL)
	!ModalState(DETECTTRAPS)
THEN
	RESPONSE #100
		//DisplayStringHead(Myself,103248) // Finding Traps
		FindTraps()
END

////////////////////////////////////////////////////////// Randomly turn around, makes them look more alive
//IF
//	ActionListEmpty()
//THEN
//	RESPONSE #100
//		//DisplayStringHead(Myself,1539)
//		RandomTurn()
//		ClearAllActions()
//END

//IF
//
//THEN
//	RESPONSE #25
//		MoveToOffset([1.1])
//	RESPONSE #25
//		MoveToOffset([1.-1])
//	RESPONSE #25
//		MoveToOffset([-1.1])
//	RESPONSE #25
//		MoveToOffset([-1.-1])
//END