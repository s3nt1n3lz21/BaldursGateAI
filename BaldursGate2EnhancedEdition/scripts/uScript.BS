IF
	Allegiance(Myself,EVILCUTOFF)
THEN
	RESPONSE #100
		ChangeAIScript("Null",RACE)
END

IF
	Range(Player1,0)
	Global("u_Player1DetectEnemy","GLOBAL",0)
	OR(3)
		Detect(NearestEnemyOf(Myself))
		Detect([EVILCUTOFF])
		Detect([GOODBUTRED])
THEN
	RESPONSE #100
		SetGlobal("u_Player1DetectEnemy","GLOBAL",1)
		SetGlobal("u_AnyoneDetectEnemy","GLOBAL",1)
END

IF
	Range(Player2,0)
	Global("u_Player2DetectEnemy","GLOBAL",0)
	OR(3)
		Detect(NearestEnemyOf(Myself))
		Detect([EVILCUTOFF])
		Detect([GOODBUTRED])
THEN
	RESPONSE #100
		SetGlobal("u_Player2DetectEnemy","GLOBAL",1)
		SetGlobal("u_AnyoneDetectEnemy","GLOBAL",1)
END

IF
	Range(Player3,0)
	Global("u_Player3DetectEnemy","GLOBAL",0)
	OR(3)
		Detect(NearestEnemyOf(Myself))
		Detect([EVILCUTOFF])
		Detect([GOODBUTRED])
THEN
	RESPONSE #100
		SetGlobal("u_Player3DetectEnemy","GLOBAL",1)
		SetGlobal("u_AnyoneDetectEnemy","GLOBAL",1)
END

IF
	Range(Player4,0)
	Global("u_Player4DetectEnemy","GLOBAL",0)
	OR(3)
		Detect(NearestEnemyOf(Myself))
		Detect([EVILCUTOFF])
		Detect([GOODBUTRED])
THEN
	RESPONSE #100
		SetGlobal("u_Player4DetectEnemy","GLOBAL",1)
		SetGlobal("u_AnyoneDetectEnemy","GLOBAL",1)
END

IF
	Range(Player5,0)
	Global("u_Player5DetectEnemy","GLOBAL",0)
	OR(3)
		Detect(NearestEnemyOf(Myself))
		Detect([EVILCUTOFF])
		Detect([GOODBUTRED])
THEN
	RESPONSE #100
		SetGlobal("u_Player5DetectEnemy","GLOBAL",1)
		SetGlobal("u_AnyoneDetectEnemy","GLOBAL",1)
END

IF
	Range(Player6,0)
	Global("u_Player6DetectEnemy","GLOBAL",0)
	OR(3)
		Detect(NearestEnemyOf(Myself))
		Detect([EVILCUTOFF])
		Detect([GOODBUTRED])
THEN
	RESPONSE #100
		SetGlobal("u_Player6DetectEnemy","GLOBAL",1)
		SetGlobal("u_AnyoneDetectEnemy","GLOBAL",1)
END

IF
	Range(Player1,0)
	Global("u_Player1DetectEnemy","GLOBAL",1)
	!Detect(NearestEnemyOf(Myself))
	!Detect([EVILCUTOFF])
	!Detect([GOODBUTRED])
THEN
	RESPONSE #100
		SetGlobal("u_Player1DetectEnemy","GLOBAL",0)
END

IF
	Range(Player2,0)
	Global("u_Player2DetectEnemy","GLOBAL",1)
	!Detect(NearestEnemyOf(Myself))
	!Detect([EVILCUTOFF])
	!Detect([GOODBUTRED])
THEN
	RESPONSE #100
		SetGlobal("u_Player2DetectEnemy","GLOBAL",0)
END

IF
	Range(Player3,0)
	Global("u_Player3DetectEnemy","GLOBAL",1)
	!Detect(NearestEnemyOf(Myself))
	!Detect([EVILCUTOFF])
	!Detect([GOODBUTRED])
THEN
	RESPONSE #100
		SetGlobal("u_Player3DetectEnemy","GLOBAL",0)
END

IF
	Range(Player4,0)
	Global("u_Player4DetectEnemy","GLOBAL",1)
	!Detect(NearestEnemyOf(Myself))
	!Detect([EVILCUTOFF])
	!Detect([GOODBUTRED])
THEN
	RESPONSE #100
		SetGlobal("u_Player4DetectEnemy","GLOBAL",0)
END

IF
	Range(Player5,0)
	Global("u_Player5DetectEnemy","GLOBAL",1)
	!Detect(NearestEnemyOf(Myself))
	!Detect([EVILCUTOFF])
	!Detect([GOODBUTRED])
THEN
	RESPONSE #100
		SetGlobal("u_Player5DetectEnemy","GLOBAL",0)
END

IF
	Range(Player6,0)
	Global("u_Player6DetectEnemy","GLOBAL",1)
	!Detect(NearestEnemyOf(Myself))
	!Detect([EVILCUTOFF])
	!Detect([GOODBUTRED])
THEN
	RESPONSE #100
		SetGlobal("u_Player6DetectEnemy","GLOBAL",0)
END

IF
	Global("u_AnyoneDetectEnemy","GLOBAL",1)
	Global("u_Player1DetectEnemy","GLOBAL",0)
	Global("u_Player2DetectEnemy","GLOBAL",0)
	Global("u_Player3DetectEnemy","GLOBAL",0)
	Global("u_Player4DetectEnemy","GLOBAL",0)
	Global("u_Player5DetectEnemy","GLOBAL",0)
	Global("u_Player6DetectEnemy","GLOBAL",0)
THEN
	RESPONSE #100
		SetGlobal("u_AnyoneDetectEnemy","GLOBAL",0)
END

IF
	Range(Player1,0)
	Global("u_Player1SeeEnemy","GLOBAL",0)
	OR(3)
		See(NearestEnemyOf(Myself))
		See([EVILCUTOFF])
		See([GOODBUTRED])
THEN
	RESPONSE #100
		SetGlobal("u_Player1SeeEnemy","GLOBAL",1)
END

IF
	Range(Player2,0)
	Global("u_Player2SeeEnemy","GLOBAL",0)
	OR(3)
		See(NearestEnemyOf(Myself))
		See([EVILCUTOFF])
		See([GOODBUTRED])
THEN
	RESPONSE #100
		SetGlobal("u_Player2SeeEnemy","GLOBAL",1)
END

IF
	Range(Player3,0)
	Global("u_Player3SeeEnemy","GLOBAL",0)
	OR(3)
		See(NearestEnemyOf(Myself))
		See([EVILCUTOFF])
		See([GOODBUTRED])
THEN
	RESPONSE #100
		SetGlobal("u_Player3SeeEnemy","GLOBAL",1)
END

IF
	Range(Player4,0)
	Global("u_Player4SeeEnemy","GLOBAL",0)
	OR(3)
		See(NearestEnemyOf(Myself))
		See([EVILCUTOFF])
		See([GOODBUTRED])
THEN
	RESPONSE #100
		SetGlobal("u_Player4SeeEnemy","GLOBAL",1)
END

IF
	Range(Player5,0)
	Global("u_Player5SeeEnemy","GLOBAL",0)
	OR(3)
		See(NearestEnemyOf(Myself))
		See([EVILCUTOFF])
		See([GOODBUTRED])
THEN
	RESPONSE #100
		SetGlobal("u_Player5SeeEnemy","GLOBAL",1)
END

IF
	Range(Player6,0)
	Global("u_Player6SeeEnemy","GLOBAL",0)
	OR(3)
		See(NearestEnemyOf(Myself))
		See([EVILCUTOFF])
		See([GOODBUTRED])
THEN
	RESPONSE #100
		SetGlobal("u_Player6SeeEnemy","GLOBAL",1)
END

IF
	Range(Player1,0)
	Global("u_Player1SeeEnemy","GLOBAL",1)
	!See(NearestEnemyOf(Myself))
	!See([EVILCUTOFF])
	!See([GOODBUTRED])
THEN
	RESPONSE #100
		SetGlobal("u_Player1SeeEnemy","GLOBAL",0)
END

IF
	Range(Player2,0)
	Global("u_Player2SeeEnemy","GLOBAL",1)
	!See(NearestEnemyOf(Myself))
	!See([EVILCUTOFF])
	!See([GOODBUTRED])
THEN
	RESPONSE #100
		SetGlobal("u_Player2SeeEnemy","GLOBAL",0)
END

IF
	Range(Player3,0)
	Global("u_Player3SeeEnemy","GLOBAL",1)
	!See(NearestEnemyOf(Myself))
	!See([EVILCUTOFF])
	!See([GOODBUTRED])
THEN
	RESPONSE #100
		SetGlobal("u_Player3SeeEnemy","GLOBAL",0)
END

IF
	Range(Player4,0)
	Global("u_Player4SeeEnemy","GLOBAL",1)
	!See(NearestEnemyOf(Myself))
	!See([EVILCUTOFF])
	!See([GOODBUTRED])
THEN
	RESPONSE #100
		SetGlobal("u_Player4SeeEnemy","GLOBAL",0)
END

IF
	Range(Player5,0)
	Global("u_Player5SeeEnemy","GLOBAL",1)
	!See(NearestEnemyOf(Myself))
	!See([EVILCUTOFF])
	!See([GOODBUTRED])
THEN
	RESPONSE #100
		SetGlobal("u_Player5SeeEnemy","GLOBAL",0)
END

IF
	Range(Player6,0)
	Global("u_Player6SeeEnemy","GLOBAL",1)
	!See(NearestEnemyOf(Myself))
	!See([EVILCUTOFF])
	!See([GOODBUTRED])
THEN
	RESPONSE #100
		SetGlobal("u_Player6SeeEnemy","GLOBAL",0)
END

IF
	Global("u_Archer","LOCALS",0)
	OR(3)
		CheckStatGT(Myself,3,PROFICIENCYCROSSBOW)
		CheckStatGT(Myself,3,PROFICIENCYLONGBOW)
		CheckStatGT(Myself,3,PROFICIENCYSHORTBOW)
	OR(6)
		HasItemSlot(Myself,SLOT_AMMO0)
		HasItemSlot(Myself,SLOT_AMMO1)
		HasItemSlot(Myself,SLOT_AMMO2)
		HasItemEquiped("BOW15",Myself)  // Tansheron's Bow +3
		HasItemEquiped("XBOW15",Myself)  // Firetooth +4
		HasItemEquiped("XBOW16",Myself)  // Firetooth +5
THEN
	RESPONSE #100
		SetGlobal("u_Archer","LOCALS",1)
END

IF
	Global("u_Archer","LOCALS",1)
	!HasItemSlot(Myself,SLOT_AMMO0)
	!HasItemSlot(Myself,SLOT_AMMO1)
	!HasItemSlot(Myself,SLOT_AMMO2)
	!HasItemEquiped("BOW15",Myself)  // Tansheron's Bow +3
	!HasItemEquiped("XBOW15",Myself)  // Firetooth +4
	!HasItemEquiped("XBOW16",Myself)  // Firetooth +5
THEN
	RESPONSE #100
		SetGlobal("u_Archer","LOCALS",0)
END

IF
	Global("u_PartyProtector","LOCALS",0)
	NumCreatureGT([PC],1)
	OR(6)
		HPGT(Player1,300)
		HPGT(Player2,300)
		HPGT(Player3,300)
		HPGT(Player4,300)
		HPGT(Player5,300)
		HPGT(Player6,300)
	HPGT(Myself,300)
THEN
	RESPONSE #100
		SetGlobal("u_PartyProtector","LOCALS",1)
END

IF
	Global("u_PartyProtector","LOCALS",0)
	NumCreatureGT([PC],1)
	!HPGT(Player1,300)
	!HPGT(Player2,300)
	!HPGT(Player3,300)
	!HPGT(Player4,300)
	!HPGT(Player5,300)
	!HPGT(Player6,300)
	OR(6)
		HPGT(Player1,200)
		HPGT(Player2,200)
		HPGT(Player3,200)
		HPGT(Player4,200)
		HPGT(Player5,200)
		HPGT(Player6,200)
	HPGT(Myself,200)
THEN
	RESPONSE #100
		SetGlobal("u_PartyProtector","LOCALS",1)
END

IF
	Global("u_PartyProtector","LOCALS",0)
	NumCreatureGT([PC],1)
	!HPGT(Player1,200)
	!HPGT(Player2,200)
	!HPGT(Player3,200)
	!HPGT(Player4,200)
	!HPGT(Player5,200)
	!HPGT(Player6,200)
	OR(6)
		HPGT(Player1,150)
		HPGT(Player2,150)
		HPGT(Player3,150)
		HPGT(Player4,150)
		HPGT(Player5,150)
		HPGT(Player6,150)
	HPGT(Myself,150)
THEN
	RESPONSE #100
		SetGlobal("u_PartyProtector","LOCALS",1)
END

IF
	Global("u_PartyProtector","LOCALS",0)
	NumCreatureGT([PC],1)
	!HPGT(Player1,150)
	!HPGT(Player2,150)
	!HPGT(Player3,150)
	!HPGT(Player4,150)
	!HPGT(Player5,150)
	!HPGT(Player6,150)
	OR(6)
		HPGT(Player1,100)
		HPGT(Player2,100)
		HPGT(Player3,100)
		HPGT(Player4,100)
		HPGT(Player5,100)
		HPGT(Player6,100)
	HPGT(Myself,100)
THEN
	RESPONSE #100
		SetGlobal("u_PartyProtector","LOCALS",1)
END

IF
	Global("u_PartyProtector","LOCALS",0)
	NumCreatureGT([PC],1)
	!HPGT(Player1,100)
	!HPGT(Player2,100)
	!HPGT(Player3,100)
	!HPGT(Player4,100)
	!HPGT(Player5,100)
	!HPGT(Player6,100)
	OR(6)
		HPGT(Player1,75)
		HPGT(Player2,75)
		HPGT(Player3,75)
		HPGT(Player4,75)
		HPGT(Player5,75)
		HPGT(Player6,75)
	HPGT(Myself,75)
THEN
	RESPONSE #100
		SetGlobal("u_PartyProtector","LOCALS",1)
END

IF
	Global("u_PartyProtector","LOCALS",0)
	NumCreatureGT([PC],1)
	!HPGT(Player1,75)
	!HPGT(Player2,75)
	!HPGT(Player3,75)
	!HPGT(Player4,75)
	!HPGT(Player5,75)
	!HPGT(Player6,75)
	OR(6)
		HPGT(Player1,50)
		HPGT(Player2,50)
		HPGT(Player3,50)
		HPGT(Player4,50)
		HPGT(Player5,50)
		HPGT(Player6,50)
	HPGT(Myself,50)
THEN
	RESPONSE #100
		SetGlobal("u_PartyProtector","LOCALS",1)
END

IF
	Global("u_PartyProtector","LOCALS",0)
	NumCreatureGT([PC],1)
	!HPGT(Player1,50)
	!HPGT(Player2,50)
	!HPGT(Player3,50)
	!HPGT(Player4,50)
	!HPGT(Player5,50)
	!HPGT(Player6,50)
	OR(6)
		HPGT(Player1,35)
		HPGT(Player2,35)
		HPGT(Player3,35)
		HPGT(Player4,35)
		HPGT(Player5,35)
		HPGT(Player6,35)
	HPGT(Myself,35)
THEN
	RESPONSE #100
		SetGlobal("u_PartyProtector","LOCALS",1)
END

IF
	Global("u_PartyProtector","LOCALS",0)
	NumCreatureGT([PC],1)
	!HPGT(Player1,35)
	!HPGT(Player2,35)
	!HPGT(Player3,35)
	!HPGT(Player4,35)
	!HPGT(Player5,35)
	!HPGT(Player6,35)
THEN
	RESPONSE #100
		SetGlobal("u_PartyProtector","LOCALS",1)
END

IF
	Global("u_PartyProtector","LOCALS",1)
	OR(6)
		HPGT(Player1,300)
		HPGT(Player2,300)
		HPGT(Player3,300)
		HPGT(Player4,300)
		HPGT(Player5,300)
		HPGT(Player6,300)
	!HPGT(Myself,300)
THEN
	RESPONSE #100
		SetGlobal("u_PartyProtector","LOCALS",0)
END

IF
	Global("u_PartyProtector","LOCALS",1)
	OR(6)
		HPGT(Player1,200)
		HPGT(Player2,200)
		HPGT(Player3,200)
		HPGT(Player4,200)
		HPGT(Player5,200)
		HPGT(Player6,200)
	!HPGT(Myself,200)
THEN
	RESPONSE #100
		SetGlobal("u_PartyProtector","LOCALS",0)
END

IF
	Global("u_PartyProtector","LOCALS",1)
	OR(6)
		HPGT(Player1,150)
		HPGT(Player2,150)
		HPGT(Player3,150)
		HPGT(Player4,150)
		HPGT(Player5,150)
		HPGT(Player6,150)
	!HPGT(Myself,150)
THEN
	RESPONSE #100
		SetGlobal("u_PartyProtector","LOCALS",0)
END

IF
	Global("u_PartyProtector","LOCALS",1)
	OR(6)
		HPGT(Player1,100)
		HPGT(Player2,100)
		HPGT(Player3,100)
		HPGT(Player4,100)
		HPGT(Player5,100)
		HPGT(Player6,100)
	!HPGT(Myself,100)
THEN
	RESPONSE #100
		SetGlobal("u_PartyProtector","LOCALS",0)
END

IF
	Global("u_PartyProtector","LOCALS",1)
	OR(6)
		HPGT(Player1,75)
		HPGT(Player2,75)
		HPGT(Player3,75)
		HPGT(Player4,75)
		HPGT(Player5,75)
		HPGT(Player6,75)
	!HPGT(Myself,75)
THEN
	RESPONSE #100
		SetGlobal("u_PartyProtector","LOCALS",0)
END

IF
	Global("u_PartyProtector","LOCALS",1)
	OR(6)
		HPGT(Player1,50)
		HPGT(Player2,50)
		HPGT(Player3,50)
		HPGT(Player4,50)
		HPGT(Player5,50)
		HPGT(Player6,50)
	!HPGT(Myself,50)
THEN
	RESPONSE #100
		SetGlobal("u_PartyProtector","LOCALS",0)
END

IF
	Global("u_PartyProtector","LOCALS",1)
	OR(6)
		HPGT(Player1,35)
		HPGT(Player2,35)
		HPGT(Player3,35)
		HPGT(Player4,35)
		HPGT(Player5,35)
		HPGT(Player6,35)
	!HPGT(Myself,35)
THEN
	RESPONSE #100
		SetGlobal("u_PartyProtector","LOCALS",0)
END

IF
	Global("u_OverridePartyProtector","LOCALS",0)
	Global("u_PartyProtector","LOCALS",1)
	OR(2)
		GlobalGT("u_NumberOfStrongProtectors","GLOBAL",1)
		NumCreatureGT([GOODCUTOFF.0.0.0.0.SUMMONED],2)
	OR(2)
		!Class(Myself,FIGHTER_ALL)
		Global("u_Archer","LOCALS",1)
	OR(2)
		!Class(Myself,PALADIN_ALL)
		Global("u_Archer","LOCALS",1)
	OR(2)
		!Class(Myself,RANGER_ALL)
		Global("u_Archer","LOCALS",1)
THEN
	RESPONSE #100
		SetGlobal("u_PartyProtector","LOCALS",0)
		SetGlobal("u_OverridePartyProtector","LOCALS",1)
END

IF
	Global("u_OverridePartyProtector","LOCALS",1)
	!GlobalGT("u_NumberOfStrongProtectors","GLOBAL",1)
	!NumCreatureGT([GOODCUTOFF.0.0.0.0.SUMMONED],2)
THEN
	RESPONSE #100
		SetGlobal("u_OverridePartyProtector","LOCALS",0)
END

IF
	Global("u_IncrementedStrongProtectors","LOCALS",0)
	Global("u_PartyProtector","LOCALS",1)
	OR(3)
		Class(Myself,FIGHTER_ALL)
		Class(Myself,PALADIN_ALL)
		Class(Myself,RANGER_ALL)
	Global("u_Archer","LOCALS",0)
	!Range(Protagonist,0)
THEN
	RESPONSE #100
		IncrementGlobal("u_NumberOfStrongProtectors","GLOBAL",1)
		SetGlobal("u_IncrementedStrongProtectors","LOCALS",1)
END

IF
	Global("u_IncrementedStrongProtectors","LOCALS",1)
	Global("u_PartyProtector","LOCALS",0)
THEN
	RESPONSE #100
		IncrementGlobal("u_NumberOfStrongProtectors","GLOBAL",-1)
		SetGlobal("u_IncrementedStrongProtectors","LOCALS",0)
END

IF
	HotKey(V)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,11973)  // done
		SetGlobal("u_AIOff","LOCALS",0)
		SetGlobal("u_MovementOff","LOCALS",0)
		SetGlobal("u_SpellCastingOff","LOCALS",0)
		SetGlobal("u_BypassCutoff","LOCALS",0)
END

IF
	HotKey(D)
	Global("u_AIOff","LOCALS",0)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,16470)  // Off
		SetGlobal("u_AIOff","LOCALS",1)
END

IF
	HotKey(D)
	Global("u_AIOff","LOCALS",1)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,16469)  // On
		SetGlobal("u_AIOff","LOCALS",0)
END

IF
	ActionListEmpty()
	Global("u_AIOff","LOCALS",1)
THEN
	RESPONSE #100
		NoAction()
END

IF
	HotKey(N)
	Global("u_MovementOff","LOCALS",0)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,16470)  // Off
		SetGlobal("u_MovementOff","LOCALS",1)
END

IF
	HotKey(N)
	Global("u_MovementOff","LOCALS",1)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,16469)  // On
		SetGlobal("u_MovementOff","LOCALS",0)
END

IF
	HotKey(S)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,16470)  // Off
		SetGlobal("u_SpellcastingOff","LOCALS",1)
END

IF
	HotKey(S)
	Global("u_SpellcastingOff","LOCALS",1)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,16469)  // On
		SetGlobal("u_SpellcastingOff","LOCALS",0)
END

IF
	HotKey(B)
	Global("u_BypassCutoff","LOCALS",0)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,16469)  // On
		SetGlobal("u_BypassCutoff","LOCALS",1)
END

IF
	HotKey(B)
	Global("u_BypassCutoff","LOCALS",1)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,16470)  // Off
		SetGlobal("u_BypassCutoff","LOCALS",0)
END

IF
	Global("u_AnyoneDetectEnemy","GLOBAL",0)
	OR(2)
		!Global("u_InMeleeRange","LOCALS",0)
		!Global("u_OutOfCombatRange","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobal("u_InMeleeRange","LOCALS",0)
		SetGlobal("u_OutOfCombatRange","LOCALS",0)
END

IF
	PartyRested()
THEN
	RESPONSE #100
		SetGlobal("u_UsedEfreetiBottle","LOCALS",0)
		SetGlobal("u_UsedBlackSpiderFigurine","LOCALS",0)
		SetGlobal("u_UsedMoonDogFigurine","LOCALS",0)
		SetGlobal("u_UsedGoldenLionFigurine","LOCALS",0)
		SetGlobal("u_UsedHornOfValhalla","LOCALS",0)
		SetGlobal("u_UsedGolemManual","LOCALS",0)
		SetGlobal("u_UsedVhailorsHelm","LOCALS",0)
		SetGlobal("u_UsedHarpOfDiscord","LOCALS",0)
		SetGlobal("u_UsedHarpOfPandemonium","LOCALS",0)
		SetGlobal("u_UsedAzlaersHarp","LOCALS",0)
		SetGlobal("u_UsedMethildsHarp","LOCALS",0)
		SetGlobal("u_PartyProtector","LOCALS",0)
		SetGlobal("u_IncrementedStrongProtectors","LOCALS",0)
		SetGlobal("u_OverridePartyProtector","LOCALS",0)
		SetGlobal("u_NumberOfStrongProtectors","GLOBAL",0)
END

IF
	HaveSpell(AVENGER_SHAPESHIFT_NATURAL_FORM)  // SPIN122.SPL (Shapeshift: Natural Form)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		Global("u_AnyoneDetectEnemy","GLOBAL",0)
THEN
	RESPONSE #100
		Spell(Myself,AVENGER_SHAPESHIFT_NATURAL_FORM)  // SPIN122.SPL (Shapeshift: Natural Form)
END

IF
	HaveSpell(SHAPESHIFTER_SHAPESHIFT_NATURAL_FORM)  // SPIN124.SPL (Shapeshift: Natural Form)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		Global("u_AnyoneDetectEnemy","GLOBAL",0)
THEN
	RESPONSE #100
		Spell(Myself,SHAPESHIFTER_SHAPESHIFT_NATURAL_FORM)  // SPIN124.SPL (Shapeshift: Natural Form)
END

IF
	HaveSpellRES("SpInHum")  // Shapeshift: Natural Form
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		Global("u_AnyoneDetectEnemy","GLOBAL",0)
THEN
	RESPONSE #100
		SpellRES("SpInHum",Myself)  // Shapeshift: Natural Form
END

IF
	Global("u_MeleeWeaponEquipped","LOCALS",0)
	Detect(NearestEnemyOf(Myself))
	OR(2)
		Range(LastSeenBy(Myself),4)
		Global("u_PartyProtector","LOCALS",1)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		SetGlobal("u_MeleeWeaponEquipped","LOCALS",1)
END

IF
	OR(4)
		Class(Myself,MAGE_ALL)
		Class(Myself,CLERIC_ALL)
		Class(Myself,DRUID_ALL)
		Class(Myself,BARD_ALL)
	See(NearestEnemyOfType([EVILCUTOFF.0.0.OGRE_MAGE]))
	Gender(LastSeenBy(Myself),SUMMONED)
	Range(LastSeenBy(Myself),10)
	Global("u_MovementOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		RunAwayFrom(LastSeenBy(Myself),30)
		SetInterrupt(TRUE)
END

IF
	HPPercentLT(Myself,70)
	Range(LastAttackerOf(Myself),10)
	OR(3)
		Class(Myself,MAGE_ALL)
		Class(Myself,CLERIC_ALL)
		Class(Myself,DRUID_ALL)
	Global("u_PartyProtector","LOCALS",0)
	Global("u_MovementOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		DisplayStringHead(Myself,46151)  // Help!
		RunAwayFrom(LastAttackerOf(Myself),30)
		SetInterrupt(TRUE)
END

IF
	HPPercentLT(Myself,50)
	Range(LastAttackerOf(Myself),10)
	Global("u_PartyProtector","LOCALS",0)
	Global("u_MovementOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		DisplayStringHead(Myself,46151)  // Help!
		RunAwayFrom(LastAttackerOf(Myself),30)
		SetInterrupt(TRUE)
END

IF
	!Range(NearestEnemyOf(Myself),4)
	OR(8)
		AttackedBy([GOODCUTOFF],DEFAULT)
		AttackedBy([EVILBUTGREEN],DEFAULT)
		AttackedBy(Player1,DEFAULT)
		AttackedBy(Player2,DEFAULT)
		AttackedBy(Player3,DEFAULT)
		AttackedBy(Player4,DEFAULT)
		AttackedBy(Player5,DEFAULT)
		AttackedBy(Player6,DEFAULT)
	Global("u_MovementOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		RunAwayFrom(LastAttackerOf(Myself),15)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	Global("u_InMeleeRange","LOCALS",0)
	OR(5)
		Class(Myself,MAGE_ALL)
		Class(Myself,CLERIC_ALL)
		Class(Myself,DRUID_ALL)
		Class(Myself,BARD_ALL)
		HPPercentLT(Myself,60)
	OR(5)
		HaveSpell(0)
		HaveSpell(CLERIC_DOOM)  // SPPR113.SPL (Doom)
		HaveSpell(CLERIC_MASS_CURE)  // SPPR514.SPL (Mass Cure)
		HaveSpell(CLERIC_HEAL)  // SPPR607.SPL (Heal)
		HPPercentLT(Myself,60)
	Range(NearestEnemyOf(Myself),6)
	Global("u_PartyProtector","LOCALS",0)
	Global("u_MovementOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobal("u_InMeleeRange","LOCALS",1)
		SetGlobalTimer("u_InMeleeTimer","LOCALS",ONE_ROUND)
END

IF
	ActionListEmpty()
	Global("u_InMeleeRange","LOCALS",1)
	!Range(NearestEnemyOf(Myself),6)
THEN
	RESPONSE #100
		SetGlobal("u_InMeleeRange","LOCALS",0)
END

IF
	Global("u_InMeleeRange","LOCALS",1)
	Range(NearestEnemyOf(Myself),6)
	!GlobalTimerNotExpired("u_InMeleeTimer","LOCALS")
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobal("u_InMeleeRange","LOCALS",0)
		RunAwayFrom(LastSeenBy(Myself),30)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_STONE_SKIN)  // SPWI408.SPL (Stoneskin)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	CheckStatLT(Myself,1,STONESKINS)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_STONE_SKIN)  // SPWI408.SPL (Stoneskin)
END

IF
	ActionListEmpty()
	HaveSpell(CLERIC_IRONSKIN)  // SPPR506.SPL (Iron Skins)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	CheckStatLT(Myself,1,STONESKINS)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,CLERIC_IRONSKIN)  // SPPR506.SPL (Iron Skins)
END

IF
	ActionListEmpty()
	!HasItem("ENEBLADE",Myself)  // Energy Blade
	!HasItem("MELFMET",Myself)  // Melf's Minute Meteor
	HaveSpell(WIZARD_MELF_METEOR)  // SPWI325.SPL (Melf's Minute Meteors)
	!HaveSpell(WIZARD_ENERGY_BLADES)  // SPWI920.SPL (Energy Blades)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_MELF_METEOR)  // SPWI325.SPL (Melf's Minute Meteors)
END

IF
	Global("u_AnyoneDetectEnemy","GLOBAL",1)
	StateCheck(Myself,STATE_POISONED)
	HPPercentLT(Myself,80)
	HasItem("POTN17",Myself)  // Elixir of Health
	OR(2)
		!HasItem("BAG04",Myself)  // Bag of Holding
		HasItemEquiped("POTN17",Myself)  // Elixir of Health
	OR(2)
		!HasItem("BAG06",Myself)  // Potion Case
		HasItemEquiped("POTN17",Myself)  // Elixir of Health
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		UseItem("POTN17",Myself)  // Elixir of Health
		DisplayStringHead(Myself,7011)  // Elixir of Health
		SetInterrupt(TRUE)
END

IF
	Global("u_AnyoneDetectEnemy","GLOBAL",1)
	StateCheck(Myself,STATE_POISONED)
	HasItem("POTN20",Myself)  // Antidote
	OR(2)
		!HasItem("BAG04",Myself)  // Bag of Holding
		HasItemEquiped("POTN20",Myself)  // Antidote
	OR(2)
		!HasItem("BAG06",Myself)  // Potion Case
		HasItemEquiped("POTN20",Myself)  // Antidote
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		UseItem("POTN20",Myself)  // Antidote
		DisplayStringHead(Myself,7029)  // Antidote
		SetInterrupt(TRUE)
END

IF
	StateCheck(Myself,STATE_POISONED)
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	StateCheck(Myself,STATE_POISONED)
	HaveSpell(CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
		SetInterrupt(TRUE)
END

IF
	StateCheck(Myself,STATE_POISONED)
	HaveSpell(0)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,0)
		SetInterrupt(TRUE)
END

IF
	See(MostDamagedOf([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	!GlobalTimerNotExpired("u_Curing","GLOBAL")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_Curing","GLOBAL",ONE_ROUND)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	See(MostDamagedOf([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	HaveSpell(CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	!GlobalTimerNotExpired("u_Curing","GLOBAL")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_Curing","GLOBAL",ONE_ROUND)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
		SetInterrupt(TRUE)
END

IF
	See(MostDamagedOf([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	HaveSpell(0)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	!GlobalTimerNotExpired("u_Curing","GLOBAL")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_Curing","GLOBAL",ONE_ROUND)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),0)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	Global("u_AnyoneDetectEnemy","GLOBAL",1)
	HPPercentLT(MostDamagedOf([PC]),70)
	CheckStatGT(MostDamagedOf([PC]),100,MAXHITPOINTS)
	!Range(MostDamagedOf([PC]),0)
	HasItem("POTN55",Myself)  // Potion of Superior Healing
	!HasItem("POTN55",MostDamagedOf([PC]))  // Potion of Superior Healing
	OR(16)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC3)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC4)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC5)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC6)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC7)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC8)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC9)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC10)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC11)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC12)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC13)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC14)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC15)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC16)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC17)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC18)
THEN
	RESPONSE #100
		GiveItem("POTN55",MostDamagedOf([PC]))  // Potion of Superior Healing
END

IF
	ActionListEmpty()
	Global("u_AnyoneDetectEnemy","GLOBAL",1)
	HPPercentLT(MostDamagedOf([PC]),70)
	CheckStatLT(MostDamagedOf([PC]),200,MAXHITPOINTS)
	!Range(MostDamagedOf([PC]),0)
	HasItem("POTN52",Myself)  // Potion of Extra Healing
	!HasItem("POTN52",MostDamagedOf([PC]))  // Potion of Extra Healing
	OR(16)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC3)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC4)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC5)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC6)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC7)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC8)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC9)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC10)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC11)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC12)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC13)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC14)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC15)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC16)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC17)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC18)
THEN
	RESPONSE #100
		GiveItem("POTN52",MostDamagedOf([PC]))  // Potion of Extra Healing
END

IF
	ActionListEmpty()
	Global("u_AnyoneDetectEnemy","GLOBAL",1)
	HPPercentLT(MostDamagedOf([PC]),70)
	CheckStatLT(MostDamagedOf([PC]),100,MAXHITPOINTS)
	!Range(MostDamagedOf([PC]),0)
	HasItem("POTN08",Myself)  // Potion of Healing
	!HasItem("POTN08",MostDamagedOf([PC]))  // Potion of Healing
	OR(16)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC3)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC4)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC5)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC6)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC7)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC8)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC9)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC10)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC11)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC12)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC13)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC14)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC15)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC16)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC17)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC18)
THEN
	RESPONSE #100
		GiveItem("POTN08",MostDamagedOf([PC]))  // Potion of Healing
END

IF
	Global("u_AnyoneDetectEnemy","GLOBAL",1)
	HasItem("POTN55",Myself)  // Potion of Superior Healing
	!HasItemEquiped("POTN55",Myself)  // Potion of Superior Healing
	HPPercentLT(Myself,70)
	CheckStatGT(Myself,100,MAXHITPOINTS)
	OR(2)
		HasItem("BAG04",Myself)  // Bag of Holding
		HasItem("BAG06",Myself)  // Potion Case
	OR(3)
		!HasItemSlot(Myself,SLOT_MISC0)
		!HasItemSlot(Myself,SLOT_MISC1)
		!HasItemSlot(Myself,SLOT_MISC2)
THEN
	RESPONSE #100
		EquipItem("POTN55")  // Potion of Superior Healing
END

IF
	Global("u_AnyoneDetectEnemy","GLOBAL",1)
	HasItem("POTN52",Myself)  // Potion of Extra Healing
	!HasItemEquiped("POTN52",Myself)  // Potion of Extra Healing
	HPPercentLT(Myself,70)
	CheckStatLT(Myself,200,MAXHITPOINTS)
	OR(2)
		HasItem("BAG04",Myself)  // Bag of Holding
		HasItem("BAG06",Myself)  // Potion Case
	OR(3)
		!HasItemSlot(Myself,SLOT_MISC0)
		!HasItemSlot(Myself,SLOT_MISC1)
		!HasItemSlot(Myself,SLOT_MISC2)
THEN
	RESPONSE #100
		EquipItem("POTN52")  // Potion of Extra Healing
END

IF
	Global("u_AnyoneDetectEnemy","GLOBAL",1)
	HasItem("POTN08",Myself)  // Potion of Healing
	!HasItemEquiped("POTN08",Myself)  // Potion of Healing
	HPPercentLT(Myself,70)
	CheckStatLT(Myself,100,MAXHITPOINTS)
	OR(2)
		HasItem("BAG04",Myself)  // Bag of Holding
		HasItem("BAG06",Myself)  // Potion Case
	OR(3)
		!HasItemSlot(Myself,SLOT_MISC0)
		!HasItemSlot(Myself,SLOT_MISC1)
		!HasItemSlot(Myself,SLOT_MISC2)
THEN
	RESPONSE #100
		EquipItem("POTN55")  // Potion of Superior Healing
END

IF
	Global("u_AnyoneDetectEnemy","GLOBAL",1)
	HasItem("POTN55",Myself)  // Potion of Superior Healing
	OR(2)
		!HasItem("BAG04",Myself)  // Bag of Holding
		HasItemEquiped("POTN55",Myself)  // Potion of Superior Healing
	OR(2)
		!HasItem("BAG06",Myself)  // Potion Case
		HasItemEquiped("POTN55",Myself)  // Potion of Superior Healing
	HPPercentLT(Myself,70)
	CheckStatGT(Myself,100,MAXHITPOINTS)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		UseItem("POTN55",Myself)  // Potion of Superior Healing
		DisplayStringHead(Myself,64945)  // Potion of Superior Healing
		SetInterrupt(TRUE)
END

IF
	Global("u_AnyoneDetectEnemy","GLOBAL",1)
	HasItem("POTN52",Myself)  // Potion of Extra Healing
	OR(2)
		!HasItem("BAG04",Myself)  // Bag of Holding
		HasItemEquiped("POTN52",Myself)  // Potion of Extra Healing
	OR(2)
		!HasItem("BAG06",Myself)  // Potion Case
		HasItemEquiped("POTN52",Myself)  // Potion of Extra Healing
	HPPercentLT(Myself,70)
	CheckStatLT(Myself,200,MAXHITPOINTS)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		UseItem("POTN52",Myself)  // Potion of Extra Healing
		DisplayStringHead(Myself,18893)  // Potion of Extra Healing
		SetInterrupt(TRUE)
END

IF
	Global("u_AnyoneDetectEnemy","GLOBAL",1)
	HasItem("POTN08",Myself)  // Potion of Healing
	OR(2)
		!HasItem("BAG04",Myself)  // Bag of Holding
		HasItemEquiped("POTN08",Myself)  // Potion of Healing
	OR(2)
		!HasItem("BAG06",Myself)  // Potion Case
		HasItemEquiped("POTN08",Myself)  // Potion of Healing
	HPPercentLT(Myself,70)
	CheckStatLT(Myself,100,MAXHITPOINTS)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		UseItem("POTN08",Myself)  // Potion of Healing
		DisplayStringHead(Myself,6990)  // Potion of Healing
		SetInterrupt(TRUE)
END

IF
	OR(5)
		HaveSpell(CLERIC_SUMMON_DEVA)  // SPPR726.SPL (Summon Deva)
		HaveSpell(CLERIC_SUMMON_FALLEN_DEVA)  // SPPR727.SPL (Summon Fallen Deva)
		HaveSpell(CLERIC_STORM_OF_VENGEANCE)  // SPPR722.SPL (Storm of Vengeance)
		HaveSpell(CLERIC_IMPLOSION)  // SPPR728.SPL (Implosion)
		HaveSpell(CLERIC_ELEMENTAL_SWARM)  // SPPR723.SPL (Elemental Summoning)
	OR(5)
		HPPercentLT(Player1,60)
		HPPercentLT(Player2,60)
		HPPercentLT(Player3,60)
		HPPercentLT(Player4,60)
		HPPercentLT(Player5,60)
	OR(5)
		HPPercentLT(Player2,60)
		HPPercentLT(Player3,60)
		HPPercentLT(Player4,60)
		HPPercentLT(Player5,60)
		HPPercentLT(Player6,60)
	OR(5)
		HPPercentLT(Player1,60)
		HPPercentLT(Player3,60)
		HPPercentLT(Player4,60)
		HPPercentLT(Player5,60)
		HPPercentLT(Player6,60)
	OR(5)
		HPPercentLT(Player1,60)
		HPPercentLT(Player2,60)
		HPPercentLT(Player4,60)
		HPPercentLT(Player5,60)
		HPPercentLT(Player6,60)
	OR(5)
		HPPercentLT(Player1,60)
		HPPercentLT(Player2,60)
		HPPercentLT(Player3,60)
		HPPercentLT(Player5,60)
		HPPercentLT(Player6,60)
	OR(5)
		HPPercentLT(Player1,60)
		HPPercentLT(Player2,60)
		HPPercentLT(Player3,60)
		HPPercentLT(Player4,60)
		HPPercentLT(Player6,60)
	HaveSpell(0)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_Healing","GLOBAL",ONE_ROUND)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,0)
		DisplayStringHead(Myself,35603)  // Greater Restoration
		SetInterrupt(TRUE)
END

IF
	OR(5)
		HPPercentLT(Player1,80)
		HPPercentLT(Player2,80)
		HPPercentLT(Player3,80)
		HPPercentLT(Player4,80)
		HPPercentLT(Player5,80)
	OR(5)
		HPPercentLT(Player2,80)
		HPPercentLT(Player3,80)
		HPPercentLT(Player4,80)
		HPPercentLT(Player5,80)
		HPPercentLT(Player6,80)
	OR(5)
		HPPercentLT(Player1,80)
		HPPercentLT(Player3,80)
		HPPercentLT(Player4,80)
		HPPercentLT(Player5,80)
		HPPercentLT(Player6,80)
	OR(5)
		HPPercentLT(Player1,80)
		HPPercentLT(Player2,80)
		HPPercentLT(Player4,80)
		HPPercentLT(Player5,80)
		HPPercentLT(Player6,80)
	OR(5)
		HPPercentLT(Player1,80)
		HPPercentLT(Player2,80)
		HPPercentLT(Player3,80)
		HPPercentLT(Player5,80)
		HPPercentLT(Player6,80)
	OR(5)
		HPPercentLT(Player1,80)
		HPPercentLT(Player2,80)
		HPPercentLT(Player3,80)
		HPPercentLT(Player4,80)
		HPPercentLT(Player6,80)
	HaveSpell(CLERIC_MASS_CURE)  // SPPR514.SPL (Mass Cure)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_Healing","GLOBAL",ONE_ROUND)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_MASS_CURE)  // SPPR514.SPL (Mass Cure)
		DisplayStringHead(Myself,7468)  // Mass Cure
		SetInterrupt(TRUE)
END

IF
	HPPercentLT(Myself,50)
	HaveSpell(CLERIC_HEAL)  // SPPR607.SPL (Heal)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_HEAL)  // SPPR607.SPL (Heal)
		DisplayStringHead(Myself,12138)  // Healing
		SetInterrupt(TRUE)
END

IF
	HPPercentLT(Myself,50)
	HaveSpell(PALADIN_LAY_ON_HANDS)  // SPCL211.SPL (Lay On Hands)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		Spell(Myself,PALADIN_LAY_ON_HANDS)  // SPCL211.SPL (Lay On Hands)
		DisplayStringHead(Myself,12032)  // Lay On Hands
		SetInterrupt(TRUE)
END

IF
	HPPercentLT(Myself,50)
	HaveSpell(MONK_LAY_ON_HANDS)  // SPCL815.SPL (Lay On Hands)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		Spell(Myself,MONK_LAY_ON_HANDS)  // SPCL815.SPL (Lay On Hands)
		DisplayStringHead(Myself,12032)  // Lay On Hands
		SetInterrupt(TRUE)
END

IF
	HPPercentLT(Myself,50)
	HaveSpell(MAZZY_LAY)  // SPIN827.SPL (Lay On Hands)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		Spell(Myself,MAZZY_LAY)  // SPIN827.SPL (Lay On Hands)
		DisplayStringHead(Myself,12032)  // Lay On Hands
		SetInterrupt(TRUE)
END

IF
	HPPercentLT(Myself,70)
	OR(2)
		CheckStatLT(Myself,150,MAXHITPOINTS)
		Global("u_AnyoneDetectEnemy","GLOBAL",0)
	HaveSpell(CLERIC_CURE_SERIOUS_WOUNDS)  // SPPR401.SPL (Cure Serious Wounds)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_CURE_SERIOUS_WOUNDS)  // SPPR401.SPL (Cure Serious Wounds)
		SetInterrupt(TRUE)
END

IF
	HPPercentLT(Myself,70)
	OR(2)
		CheckStatLT(Myself,100,MAXHITPOINTS)
		Global("u_AnyoneDetectEnemy","GLOBAL",0)
	HaveSpell(CLERIC_CURE_MEDIUM_WOUNDS)  // SPPR315.SPL (Cure Medium Wounds)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_CURE_MEDIUM_WOUNDS)  // SPPR315.SPL (Cure Medium Wounds)
		SetInterrupt(TRUE)
END

IF
	HPPercentLT(Myself,70)
	OR(2)
		CheckStatLT(Myself,70,MAXHITPOINTS)
		Global("u_AnyoneDetectEnemy","GLOBAL",0)
	HaveSpell(CLERIC_CURE_LIGHT_WOUNDS)  // SPPR103.SPL (Cure Light Wounds)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_CURE_LIGHT_WOUNDS)  // SPPR103.SPL (Cure Light Wounds)
		SetInterrupt(TRUE)
END

IF
	HPPercentLT(Myself,70)
	CheckStatLT(Myself,70,MAXHITPOINTS)
	HaveSpell(0)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,0)
		SetInterrupt(TRUE)
END

IF
	HPPercentLT(Myself,60)
	HaveSpell(CLERIC_CURE_CRITICAL_WOUNDS)  // SPPR502.SPL (Cure Critical Wounds)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_CURE_CRITICAL_WOUNDS)  // SPPR502.SPL (Cure Critical Wounds)
		SetInterrupt(TRUE)
END

IF
	HPPercentLT(MostDamagedOf([PC]),50)
	!StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
	!StateCheck(MostDamagedOf([PC]),STATE_IMPROVEDINVISIBILITY)
	HaveSpell(CLERIC_HEAL)  // SPPR607.SPL (Heal)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	OR(2)
		!GlobalTimerNotExpired("u_Healing","GLOBAL")
		HPPercentLT(MostDamagedOf([PC]),40)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_Healing","GLOBAL",ONE_ROUND)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(MostDamagedOf([PC]),CLERIC_HEAL)  // SPPR607.SPL (Heal)
		DisplayStringHead(Myself,12138)  // Healing
		SetInterrupt(TRUE)
END

IF
	HPPercentLT(MostDamagedOf([PC]),50)
	!StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
	!StateCheck(MostDamagedOf([PC]),STATE_IMPROVEDINVISIBILITY)
	HaveSpell(PALADIN_LAY_ON_HANDS)  // SPCL211.SPL (Lay On Hands)
	OR(2)
		!GlobalTimerNotExpired("u_Healing","GLOBAL")
		HPPercentLT(MostDamagedOf([PC]),40)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_Healing","GLOBAL",ONE_ROUND)
		Spell(MostDamagedOf([PC]),PALADIN_LAY_ON_HANDS)  // SPCL211.SPL (Lay On Hands)
		DisplayStringHead(Myself,12032)  // Lay On Hands
		SetInterrupt(TRUE)
END

IF
	HPPercentLT(MostDamagedOf([PC]),50)
	!StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
	!StateCheck(MostDamagedOf([PC]),STATE_IMPROVEDINVISIBILITY)
	HaveSpell(MAZZY_LAY)  // SPIN827.SPL (Lay On Hands)
	OR(2)
		!GlobalTimerNotExpired("u_Healing","GLOBAL")
		HPPercentLT(MostDamagedOf([PC]),40)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_Healing","GLOBAL",ONE_ROUND)
		Spell(MostDamagedOf([PC]),MAZZY_LAY)  // SPIN827.SPL (Lay On Hands)
		DisplayStringHead(Myself,12032)  // Lay On Hands
		SetInterrupt(TRUE)
END

IF
	HPPercentLT(MostDamagedOf([PC]),70)
	OR(3)
		CheckStatLT(MostDamagedOf([PC]),150,MAXHITPOINTS)
		HPPercentLT(MostDamagedOf([PC]),40)
		Global("u_AnyoneDetectEnemy","GLOBAL",0)
	HaveSpell(CLERIC_CURE_SERIOUS_WOUNDS)  // SPPR401.SPL (Cure Serious Wounds)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	!StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
	!StateCheck(MostDamagedOf([PC]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!GlobalTimerNotExpired("u_Healing","GLOBAL")
		HPPercentLT(MostDamagedOf([PC]),40)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_Healing","GLOBAL",ONE_ROUND)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(MostDamagedOf([PC]),CLERIC_CURE_SERIOUS_WOUNDS)  // SPPR401.SPL (Cure Serious Wounds)
		SetInterrupt(TRUE)
END

IF
	HPPercentLT(MostDamagedOf([PC]),70)
	OR(3)
		CheckStatLT(MostDamagedOf([PC]),100,MAXHITPOINTS)
		HPPercentLT(MostDamagedOf([PC]),40)
		Global("u_AnyoneDetectEnemy","GLOBAL",0)
	HaveSpell(CLERIC_CURE_MEDIUM_WOUNDS)  // SPPR315.SPL (Cure Medium Wounds)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	!StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
	!StateCheck(MostDamagedOf([PC]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!GlobalTimerNotExpired("u_Healing","GLOBAL")
		HPPercentLT(MostDamagedOf([PC]),40)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_Healing","GLOBAL",ONE_ROUND)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(MostDamagedOf([PC]),CLERIC_CURE_MEDIUM_WOUNDS)  // SPPR315.SPL (Cure Medium Wounds)
		SetInterrupt(TRUE)
END

IF
	HPPercentLT(MostDamagedOf([PC]),70)
	OR(3)
		CheckStatLT(MostDamagedOf([PC]),70,MAXHITPOINTS)
		HPPercentLT(MostDamagedOf([PC]),40)
		Global("u_AnyoneDetectEnemy","GLOBAL",0)
	HaveSpell(CLERIC_CURE_LIGHT_WOUNDS)  // SPPR103.SPL (Cure Light Wounds)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	!StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
	!StateCheck(MostDamagedOf([PC]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!GlobalTimerNotExpired("u_Healing","GLOBAL")
		HPPercentLT(MostDamagedOf([PC]),40)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_Healing","GLOBAL",ONE_ROUND)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(MostDamagedOf([PC]),CLERIC_CURE_LIGHT_WOUNDS)  // SPPR103.SPL (Cure Light Wounds)
		SetInterrupt(TRUE)
END

IF
	HPPercentLT(MostDamagedOf([PC]),70)
	OR(3)
		CheckStatLT(MostDamagedOf([PC]),70,MAXHITPOINTS)
		HPPercentLT(MostDamagedOf([PC]),40)
		Global("u_AnyoneDetectEnemy","GLOBAL",0)
	HaveSpell(0)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	!StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
	!StateCheck(MostDamagedOf([PC]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!GlobalTimerNotExpired("u_Healing","GLOBAL")
		HPPercentLT(MostDamagedOf([PC]),40)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_Healing","GLOBAL",ONE_ROUND)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(MostDamagedOf([PC]),0)
		SetInterrupt(TRUE)
END

IF
	HPPercentLT(MostDamagedOf([PC]),70)
	HaveSpell(CLERIC_CURE_CRITICAL_WOUNDS)  // SPPR502.SPL (Cure Critical Wounds)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	!StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
	!StateCheck(MostDamagedOf([PC]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!GlobalTimerNotExpired("u_Healing","GLOBAL")
		HPPercentLT(MostDamagedOf([PC]),40)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("u_Healing","GLOBAL",ONE_ROUND)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(MostDamagedOf([PC]),CLERIC_CURE_CRITICAL_WOUNDS)  // SPPR502.SPL (Cure Critical Wounds)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	Global("u_AnyoneDetectEnemy","GLOBAL",0)
	HaveSpell(CLERIC_GOOD_BERRIES)  // SPPR207.SPL (Goodberry)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	OR(16)
		!HasItemSlot(Myself,SLOT_MISC3)
		!HasItemSlot(Myself,SLOT_MISC4)
		!HasItemSlot(Myself,SLOT_MISC5)
		!HasItemSlot(Myself,SLOT_MISC6)
		!HasItemSlot(Myself,SLOT_MISC7)
		!HasItemSlot(Myself,SLOT_MISC8)
		!HasItemSlot(Myself,SLOT_MISC9)
		!HasItemSlot(Myself,SLOT_MISC10)
		!HasItemSlot(Myself,SLOT_MISC11)
		!HasItemSlot(Myself,SLOT_MISC12)
		!HasItemSlot(Myself,SLOT_MISC13)
		!HasItemSlot(Myself,SLOT_MISC14)
		!HasItemSlot(Myself,SLOT_MISC15)
		!HasItemSlot(Myself,SLOT_MISC16)
		!HasItemSlot(Myself,SLOT_MISC17)
		!HasItemSlot(Myself,SLOT_MISC18)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		Spell(Myself,CLERIC_GOOD_BERRIES)  // SPPR207.SPL (Goodberry)
END

IF
	ActionListEmpty()
	Global("u_AnyoneDetectEnemy","GLOBAL",0)
	HPPercentLT(MostDamagedOf([PC]),90)
	!Range(MostDamagedOf([PC]),0)
	HasItem("GBERRY",Myself)  // Good Berry
	!HasItem("GBERRY",MostDamagedOf([PC]))  // Good Berry
	OR(16)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC3)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC4)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC5)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC6)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC7)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC8)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC9)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC10)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC11)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC12)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC13)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC14)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC15)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC16)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC17)
		!HasItemSlot(MostDamagedOf([PC]),SLOT_MISC18)
THEN
	RESPONSE #100
		GiveItem("GBERRY",MostDamagedOf([PC]))  // Good Berry
END

IF
	ActionListEmpty()
	Global("u_AnyoneDetectEnemy","GLOBAL",0)
	HasItem("GBERRY",Myself)  // Good Berry
	HPPercentLT(Myself,100)
THEN
	RESPONSE #100
		UseItem("GBERRY",Myself)  // Good Berry
END

IF
	HPPercentLT(Myself,70)
	OR(2)
		See([PC.0.0.CLERIC_ALL])
		See([PC.0.0.DRUID_ALL])
	!GlobalTimerNotExpired("u_RunTimer","LOCALS")
	Global("u_PartyProtector","LOCALS",0)
	Global("u_MovementOff","LOCALS",0)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		MoveToObject(LastSeenBy(Myself))
		DisplayStringHead(Myself,3747)  // I am wounded.
		SetGlobalTimer("u_RunTimer","LOCALS",TEN_ROUNDS)
		SetInterrupt(TRUE)
END

IF
	ActionListEmpty()
	OR(2)
		Class(Myself,THIEF_ALL)
		Class(Myself,MONK)
	!ModalState(DETECTTRAPS)
	!ModalState(STEALTH)
	Global("u_AnyoneDetectEnemy","GLOBAL",0)
THEN
	RESPONSE #100
		FindTraps()
END

IF
	ActionListEmpty()
	Global("u_AnyoneDetectEnemy","GLOBAL",0)
	Global("u_BypassCutoff","LOCALS",0)
THEN
	RESPONSE #100
		NoAction()
END

IF
	ActionListEmpty()
	OR(2)
		Class(Myself,CLERIC_ALL)
		Class(Myself,PALADIN_ALL)
	!Range("Keldorn",0)  // Keldorn
	Range(NearestEnemyOfType([0.UNDEAD]),10)
	!ModalState(TURNUNDEAD)
	!GlobalTimerNotExpired("u_TurnTimer","LOCALS")
THEN
	RESPONSE #100
		DisplayStringHead(Myself,4974)  // Turn Undead
		Turn()
		Wait(3)
		SetGlobalTimer("u_TurnTimer","LOCALS",THREE_ROUNDS)
END

IF
	See(NearestEnemyOf(Myself))
	HPGT(LastSeenBy(Myself),100)
	HasItemEquiped("TOME04",Myself)  // Juggernaut Golem Manual
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	Global("u_UsedGolemManual","LOCALS",0)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,66374)  // Juggernaut Golem Manual
		UseItem("TOME04",LastSeenBy(Myself))  // Juggernaut Golem Manual
		SetGlobal("u_UsedGolemManual","LOCALS",1)
END

IF
	See(NearestEnemyOf(Myself))
	HPGT(LastSeenBy(Myself),60)
	HasItemEquiped("TOME03",Myself)  // Stone Golem Manual
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	Global("u_UsedGolemManual","LOCALS",0)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,66373)  // Stone Golem Manual
		UseItem("TOME03",LastSeenBy(Myself))  // Stone Golem Manual
		SetGlobal("u_UsedGolemManual","LOCALS",1)
END

IF
	See(NearestEnemyOf(Myself))
	HPGT(LastSeenBy(Myself),50)
	HasItemEquiped("TOME02",Myself)  // Clay Golem Manual
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	Global("u_UsedGolemManual","LOCALS",0)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,66363)  // Clay Golem Manual
		UseItem("TOME02",LastSeenBy(Myself))  // Clay Golem Manual
		SetGlobal("u_UsedGolemManual","LOCALS",1)
END

IF
	See(NearestEnemyOf(Myself))
	HPGT(LastSeenBy(Myself),40)
	HasItemEquiped("TOME01",Myself)  // Golem Manual
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	Global("u_UsedGolemManual","LOCALS",0)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,66360)  // Golem Manual
		UseItem("TOME01",LastSeenBy(Myself))  // Golem Manual
		SetGlobal("u_UsedGolemManual","LOCALS",1)
END

IF
	See(NearestEnemyOf(Myself))
	HPGT(LastSeenBy(Myself),80)
	HasItemEquiped("MISC7T",Myself)  // Moon Dog Figurine
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	Global("u_UsedMoonDogFigurine","LOCALS",0)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,31962)  // Moon Dog Figurine
		UseItem("MISC7T",Myself)  // Moon Dog Figurine
		SetGlobal("u_UsedMoonDogFigurine","LOCALS",1)
END

IF
	See(NearestEnemyOf(Myself))
	HPGT(LastSeenBy(Myself),80)
	HasItemEquiped("MISC3C",Myself)  // Efreeti Bottle
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	Global("u_UsedEfreetiBottle","LOCALS",0)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,8435)  // Efreeti Bottle
		UseItem("MISC3C",LastSeenBy(Myself))  // Efreeti Bottle
		SetGlobal("u_UsedEfreetiBottle","LOCALS",1)
END

IF
	See(NearestEnemyOf(Myself))
	HPGT(LastSeenBy(Myself),50)
	HasItemEquiped("MISC3E",Myself)  // Black Spider Figurine
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	Global("u_UsedBlackSpiderFigurine","LOCALS",0)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,38529)  // Black Spider Figurine
		UseItem("MISC3E",LastSeenBy(Myself))  // Black Spider Figurine
		SetGlobal("u_UsedBlackSpiderFigurine","LOCALS",1)
END

IF
	See(NearestEnemyOf(Myself))
	HPGT(LastSeenBy(Myself),50)
	HasItemEquiped("MISC3D",Myself)  // Golden Lion Figurine
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	Global("u_UsedGoldenLionFigurine","LOCALS",0)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,33125)  // Golden Lion Figurine
		UseItem("MISC3D",LastSeenBy(Myself))  // Golden Lion Figurine
		SetGlobal("u_UsedGoldenLionFigurine","LOCALS",1)
END

IF
	See(NearestEnemyOf(Myself))
	HPGT(LastSeenBy(Myself),60)
	HasItemEquiped("MISC3K",Myself)  // Iron Horn of Valhalla
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	Global("u_UsedHornOfValhalla","LOCALS",0)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,38541)  // Iron Horn of Valhalla
		UseItem("MISC3K",LastSeenBy(Myself))  // Iron Horn of Valhalla
		SetGlobal("u_UsedHornOfValhalla","LOCALS",1)
END

IF
	See(NearestEnemyOf(Myself))
	HPGT(LastSeenBy(Myself),50)
	HasItemEquiped("MISC3J",Myself)  // Bronze Horn of Valhalla
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	Global("u_UsedHornOfValhalla","LOCALS",0)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,38540)  // Bronze Horn of Valhalla
		UseItem("MISC3J",LastSeenBy(Myself))  // Bronze Horn of Valhalla
		SetGlobal("u_UsedHornOfValhalla","LOCALS",1)
END

IF
	See(NearestEnemyOf(Myself))
	HPGT(LastSeenBy(Myself),40)
	HasItemEquiped("MISC3I",Myself)  // Silver Horn of Valhalla
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	Global("u_UsedHornOfValhalla","LOCALS",0)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,38533)  // Silver Horn of Valhalla
		UseItem("MISC3I",LastSeenBy(Myself))  // Silver Horn of Valhalla
		SetGlobal("u_UsedHornOfValhalla","LOCALS",1)
END

IF
	ActionListEmpty()
	!StateCheck(Myself,STATE_HASTED)
	HasItem("POTN14",Myself)  // Oil of Speed
	OR(2)
		!HasItem("BAG04",Myself)  // Bag of Holding
		HasItemEquiped("POTN14",Myself)  // Oil of Speed
	OR(2)
		!HasItem("BAG06",Myself)  // Potion Case
		HasItemEquiped("POTN14",Myself)  // Oil of Speed
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		DisplayStringHead(Myself,7008)  // Oil of Speed
		UseItem("POTN14",Myself)  // Oil of Speed
END

IF
	ActionListEmpty()
	CheckStatLT(Myself,17,DEX)
	HasItem("POTN19",Myself)  // Potion of Agility
	OR(2)
		!HasItem("BAG04",Myself)  // Bag of Holding
		HasItemEquiped("POTN19",Myself)  // Potion of Agility
	OR(2)
		!HasItem("BAG06",Myself)  // Potion Case
		HasItemEquiped("POTN19",Myself)  // Potion of Agility
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		DisplayStringHead(Myself,7016)  // Potion of Agility
		UseItem("POTN19",Myself)  // Potion of Agility
END

IF
	ActionListEmpty()
	CheckStatLT(Myself,17,CON)
	HasItem("POTN28",Myself)  // Potion of Fortitude
	OR(2)
		!HasItem("BAG04",Myself)  // Bag of Holding
		HasItemEquiped("POTN28",Myself)  // Potion of Fortitude
	OR(2)
		!HasItem("BAG06",Myself)  // Potion Case
		HasItemEquiped("POTN28",Myself)  // Potion of Fortitude
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		DisplayStringHead(Myself,7053)  // Potion of Fortitude
		UseItem("POTN28",Myself)  // Potion of Fortitude
END

IF
	OR(8)
		Detect([EVILCUTOFF.0.0.MAGE_ALL])
		Detect([EVILCUTOFF.0.0.CLERIC_ALL])
		Detect([EVILCUTOFF.0.0.BARD_ALL])
		Detect([EVILCUTOFF.0.0.DRUID_ALL])
		Detect([EVILCUTOFF.0.MIND_FLAYER])
		Detect([EVILCUTOFF.0.UMBERHULK])
		Detect([EVILCUTOFF.0.RAKSHASA])
		Detect([EVILCUTOFF.0.VAMPIRE])
	!HasImmunityEffects(Myself)
	HasItem("POTN21",Myself)  // Potion of Clarity
	OR(2)
		!HasItem("BAG04",Myself)  // Bag of Holding
		HasItemEquiped("POTN21",Myself)  // Potion of Clarity
	OR(2)
		!HasItem("BAG06",Myself)  // Potion Case
		HasItemEquiped("POTN21",Myself)  // Potion of Clarity
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		DisplayStringHead(Myself,7046)  // Potion of Clarity
		UseItem("POTN21",Myself)  // Potion of Clarity
END

IF
	OR(7)
		Detect([EVILCUTOFF.0.0.MAGE_ALL])
		Detect([EVILCUTOFF.0.0.CLERIC_ALL])
		Detect([EVILCUTOFF.0.0.BARD_ALL])
		Detect([EVILCUTOFF.0.0.DRUID_ALL])
		Detect([EVILCUTOFF.0.BEHOLDER])
		Detect([EVILCUTOFF.0.MIND_FLAYER])
		Detect([EVILCUTOFF.0.RAKSHASA])
	!HasImmunityEffects(Myself)
	HasItem("POTN33",Myself)  // Potion of Magic Blocking
	OR(2)
		!HasItem("BAG04",Myself)  // Bag of Holding
		HasItemEquiped("POTN33",Myself)  // Potion of Magic Blocking
	OR(2)
		!HasItem("BAG06",Myself)  // Potion Case
		HasItemEquiped("POTN33",Myself)  // Potion of Magic Blocking
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		DisplayStringHead(Myself,7058)  // Potion of Magic Blocking
		UseItem("POTN33",Myself)  // Potion of Magic Blocking
END

IF
	OR(7)
		Detect([EVILCUTOFF.0.0.MAGE_ALL])
		Detect([EVILCUTOFF.0.0.CLERIC_ALL])
		Detect([EVILCUTOFF.0.0.BARD_ALL])
		Detect([EVILCUTOFF.0.0.DRUID_ALL])
		Detect([EVILCUTOFF.0.BEHOLDER])
		Detect([EVILCUTOFF.0.MIND_FLAYER])
		Detect([EVILCUTOFF.0.RAKSHASA])
	CheckStatLT(Myself,50,RESISTMAGIC)
	HasItem("POTN35",Myself)  // Potion of Magic Shielding
	OR(2)
		!HasItem("BAG04",Myself)  // Bag of Holding
		HasItemEquiped("POTN35",Myself)  // Potion of Magic Shielding
	OR(2)
		!HasItem("BAG06",Myself)  // Potion Case
		HasItemEquiped("POTN35",Myself)  // Potion of Magic Shielding
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		DisplayStringHead(Myself,7060)  // Potion of Magic Shielding
		UseItem("POTN35",Myself)  // Potion of Magic Shielding
END

IF
	OR(7)
		Detect([EVILCUTOFF.0.0.MAGE_ALL])
		Detect([EVILCUTOFF.0.0.CLERIC_ALL])
		Detect([EVILCUTOFF.0.0.BARD_ALL])
		Detect([EVILCUTOFF.0.0.DRUID_ALL])
		Detect([EVILCUTOFF.0.BEHOLDER])
		Detect([EVILCUTOFF.0.MIND_FLAYER])
		Detect([EVILCUTOFF.0.RAKSHASA])
	CheckStatLT(Myself,50,RESISTMAGIC)
	HasItem("POTN34",Myself)  // Potion of Magic Protection
	OR(2)
		!HasItem("BAG04",Myself)  // Bag of Holding
		HasItemEquiped("POTN34",Myself)  // Potion of Magic Protection
	OR(2)
		!HasItem("BAG06",Myself)  // Potion Case
		HasItemEquiped("POTN34",Myself)  // Potion of Magic Protection
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		DisplayStringHead(Myself,7059)  // Potion of Magic Protection
		UseItem("POTN34",Myself)  // Potion of Magic Protection
END

IF
	Detect([EVILCUTOFF.0.MIND_FLAYER])
	CheckStatLT(Myself,10,INT)
	HasItem("POTN29",Myself)  // Potion of Genius
	OR(2)
		!HasItem("BAG04",Myself)  // Bag of Holding
		HasItemEquiped("POTN29",Myself)  // Potion of Genius
	OR(2)
		!HasItem("BAG06",Myself)  // Potion Case
		HasItemEquiped("POTN29",Myself)  // Potion of Genius
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		DisplayStringHead(Myself,7054)  // Potion of Genius
		UseItem("POTN29",Myself)  // Potion of Genius
END

IF
	Detect([EVILCUTOFF.0.MIND_FLAYER])
	CheckStatLT(Myself,10,INT)
	HasItem("POTN37",Myself)  // Potion of Mind Focusing
	OR(2)
		!HasItem("BAG04",Myself)  // Bag of Holding
		HasItemEquiped("POTN37",Myself)  // Potion of Mind Focusing
	OR(2)
		!HasItem("BAG06",Myself)  // Potion Case
		HasItemEquiped("POTN37",Myself)  // Potion of Mind Focusing
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		DisplayStringHead(Myself,7062)  // Potion of Mind Focusing
		UseItem("POTN37",Myself)  // Potion of Mind Focusing
END

IF
	StateCheck(Myself,STATE_SILENCED)
	HaveSpell(WIZARD_VOCALIZE)  // SPWI219.SPL (Vocalize)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_VOCALIZE)  // SPWI219.SPL (Vocalize)
END

IF
	See(Nearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	See(SecondNearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	See(ThirdNearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	See(FourthNearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	See(FifthNearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	See(SixthNearest([PC]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	Allegiance(LastSeenBy(Myself),PC)
	HaveSpell(WIZARD_TRUE_DISPEL_MAGIC)  // SPWI326.SPL (Dispel Magic)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_TRUE_DISPEL_MAGIC)  // SPWI326.SPL (Dispel Magic)
		DisplayStringHead(Myself,12026)  // Dispel Magic
END

IF
	Allegiance(LastSeenBy(Myself),PC)
	HaveSpell(CLERIC_DISPEL_MAGIC)  // SPPR303.SPL (Dispel Magic)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_DISPEL_MAGIC)  // SPPR303.SPL (Dispel Magic)
		DisplayStringHead(Myself,12026)  // Dispel Magic
END

IF
	Allegiance(LastSeenBy(Myself),PC)
	HaveSpell(INQUIS_DISPEL_MAGIC)  // SPCL231.SPL (Dispel Magic)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),INQUIS_DISPEL_MAGIC)  // SPCL231.SPL (Dispel Magic)
		DisplayStringHead(Myself,12026)  // Dispel Magic
END

IF
	See(Nearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_SLOWED)
	See(SecondNearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_SLOWED)
	See(ThirdNearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_SLOWED)
	See(FourthNearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_SLOWED)
	See(FifthNearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_SLOWED)
	See(SixthNearest([PC]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	Allegiance(LastSeenBy(Myself),PC)
	StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
	HasItemEquiped("MISC3O",Myself)  // Methild's Harp
	GlobalLT("u_UsedMethildsHarp","LOCALS",3)
THEN
	RESPONSE #100
		UseItem("MISC3O",LastSeenBy(Myself))  // Methild's Harp
		IncrementGlobal("u_UsedMethildsHarp","LOCALS",1)
		DisplayStringHead(Myself,38792)  // Methild's Harp
END

IF
	Allegiance(LastSeenBy(Myself),PC)
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
		StateCheck(LastSeenBy(Myself),STATE_SLOWED)
	HaveSpell(CLERIC_FREE_ACTION)  // SPPR403.SPL (Free Action)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_FREE_ACTION)  // SPPR403.SPL (Free Action)
		DisplayStringHead(Myself,12102)  // Free Action
END

IF
	See(Nearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_PANIC)
	See(SecondNearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_PANIC)
	See(ThirdNearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_PANIC)
	See(FourthNearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_PANIC)
	See(FifthNearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!StateCheck(LastSeenBy(Myself),STATE_PANIC)
	See(SixthNearest([PC]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	Allegiance(LastSeenBy(Myself),PC)
	StateCheck(LastSeenBy(Myself),STATE_PANIC)
	HasItemEquiped("MISC3N",Myself)  // Azlaer's Harp
	GlobalLT("u_UsedAzlaersHarp","LOCALS",3)
THEN
	RESPONSE #100
		UseItem("MISC3N",LastSeenBy(Myself))  // Azlaer's Harp
		IncrementGlobal("u_UsedAzlaersHarp","LOCALS",1)
		DisplayStringHead(Myself,38791)  // Azlaer's Harp
END

IF
	Allegiance(LastSeenBy(Myself),PC)
	StateCheck(LastSeenBy(Myself),STATE_PANIC)
	HaveSpell(CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Remove Fear)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Remove Fear)
		DisplayStringHead(Myself,12083)  // Remove Fear
END

IF
	See(Nearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	See(SecondNearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	See(ThirdNearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	See(FourthNearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	See(FifthNearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	See(SixthNearest([PC]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	Allegiance(LastSeenBy(Myself),PC)
	HaveSpell(CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
		DisplayStringHead(Myself,48784)  // Restoration
END

IF
	OR(3)
		HitBy([ANYONE],SLASHING)
		HitBy([ANYONE],CRUSHING)
		HitBy([ANYONE],PIERCING)
	HaveSpell(WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)  // SPWI611.SPL (Protection From Magical Weapons)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_WeaponProtection","LOCALS")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)  // SPWI611.SPL (Protection From Magical Weapons)
		SetGlobalTimer("u_WeaponProtection","LOCALS",FOUR_ROUNDS)
END

IF
	ActionListEmpty()
	HPGT(NearestEnemyOf(Myself),60)
	NumCreatureGT([EVILCUTOFF],3)
	HasItemEquiped("WA2HELM",Myself)  // Vhailor's Helm
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	Global("u_UsedVhailorsHelm","LOCALS",0)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobal("u_UsedVhailorsHelm","LOCALS",1)
		UseItem("WA2HELM",Myself)  // Vhailor's Helm
		DisplayStringHead(Myself,61575)  // Vhailor's Helm
END

IF
	ActionListEmpty()
	HPGT(NearestEnemyOf(Myself),60)
	NumCreatureGT([EVILCUTOFF],3)
	HaveSpell(WIZARD_SIMULACRUM)  // SPWI804.SPL (Simulacrum)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_Simulacrum","LOCALS")
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_Simulacrum","LOCALS",THREE_TURNS)
		Spell(Myself,WIZARD_SIMULACRUM)  // SPWI804.SPL (Simulacrum)
		DisplayStringHead(Myself,26234)  // Simulacrum
END

IF
	ActionListEmpty()
	HPGT(NearestEnemyOf(Myself),50)
	NumCreatureGT([EVILCUTOFF],2)
	HaveSpell(WIZARD_PROJECT_IMAGE)  // SPWI703.SPL (Project Image)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_Simulacrum","LOCALS")
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_Simulacrum","LOCALS",TWO_TURNS)
		Spell(Myself,WIZARD_PROJECT_IMAGE)  // SPWI703.SPL (Project Image)
		DisplayStringHead(Myself,25944)  // Project Image
END

IF
	ActionListEmpty()
	HPGT(NearestEnemyOf(Myself),40)
	NumCreatureGT([EVILCUTOFF],1)
	HaveSpell(WIZARD_MISLEAD)  // SPWI607.SPL (Mislead)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_Simulacrum","LOCALS")
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_Simulacrum","LOCALS",TWO_TURNS)
		Spell(Myself,WIZARD_MISLEAD)  // SPWI607.SPL (Mislead)
		DisplayStringHead(Myself,8291)  // Mislead
END

IF
	ActionListEmpty()
	!HasItem("ENEBLADE",Myself)  // Energy Blade
	!HasItem("MELFMET",Myself)  // Melf's Minute Meteor
	HaveSpell(WIZARD_ENERGY_BLADES)  // SPWI920.SPL (Energy Blades)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_ENERGY_BLADES)  // SPWI920.SPL (Energy Blades)
END

IF
	ActionListEmpty()
	!HasItem("ENEBLADE",Myself)  // Energy Blade
	!HasItem("MELFMET",Myself)  // Melf's Minute Meteor
	HaveSpell(CLERIC_ENERGY_BLADES)  // SPPR721.SPL (Energy Blades)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_ENERGY_BLADES)  // SPPR721.SPL (Energy Blades)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_MASS_INVISIBILITY)  // SPWI721.SPL (Mass Invisibility)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	!StateCheck(Myself,STATE_INVISIBLE)
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		Global("u_BypassCutoff","LOCALS",1)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_MASS_INVISIBILITY)  // SPWI721.SPL (Mass Invisibility)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_INVISIBILITY_10_FOOT)  // SPWI307.SPL (Invisibility, 10' Radius)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	!StateCheck(Myself,STATE_INVISIBLE)
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		Global("u_BypassCutoff","LOCALS",1)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_INVISIBILITY_10_FOOT)  // SPWI307.SPL (Invisibility, 10' Radius)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_IMPROVED_INVISIBILITY)  // SPWI405.SPL (Improved Invisibility)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	!StateCheck(Myself,STATE_INVISIBLE)
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_IMPROVED_INVISIBILITY)  // SPWI405.SPL (Improved Invisibility)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_SHADOW_DOOR)  // SPWI505.SPL (Shadow Door)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	!StateCheck(Myself,STATE_INVISIBLE)
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_SHADOW_DOOR)  // SPWI505.SPL (Shadow Door)
END

IF
	ActionListEmpty()
	OR(7)
		Detect([EVILCUTOFF.0.0.MAGE_ALL])
		Detect([EVILCUTOFF.0.0.CLERIC_ALL])
		Detect([EVILCUTOFF.0.0.BARD_ALL])
		Detect([EVILCUTOFF.0.0.DRUID_ALL])
		Detect([EVILCUTOFF.0.BEHOLDER])
		Detect([EVILCUTOFF.0.MIND_FLAYER])
		Detect([EVILCUTOFF.0.RAKSHASA])
	HaveSpell(WIZARD_SPELL_TURNING)  // SPWI701.SPL (Spell Turning)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	!HasBounceEffects(Myself)
	!HasImmunityEffects(Myself)
	!StateCheck(Myself,STATE_INVISIBLE)
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		Global("u_BypassCutoff","LOCALS",1)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_SPELL_TURNING)  // SPWI701.SPL (Spell Turning)
END

IF
	ActionListEmpty()
	OR(7)
		Detect([EVILCUTOFF.0.0.MAGE_ALL])
		Detect([EVILCUTOFF.0.0.CLERIC_ALL])
		Detect([EVILCUTOFF.0.0.BARD_ALL])
		Detect([EVILCUTOFF.0.0.DRUID_ALL])
		Detect([EVILCUTOFF.0.BEHOLDER])
		Detect([EVILCUTOFF.0.MIND_FLAYER])
		Detect([EVILCUTOFF.0.RAKSHASA])
	HaveSpell(WIZARD_SPELL_DEFLECTION)  // SPWI618.SPL (Spell Deflection)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	!HasBounceEffects(Myself)
	!HasImmunityEffects(Myself)
	!StateCheck(Myself,STATE_INVISIBLE)
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		Global("u_BypassCutoff","LOCALS",1)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_SPELL_DEFLECTION)  // SPWI618.SPL (Spell Deflection)
END

IF
	ActionListEmpty()
	OR(7)
		Detect([EVILCUTOFF.0.0.MAGE_ALL])
		Detect([EVILCUTOFF.0.0.CLERIC_ALL])
		Detect([EVILCUTOFF.0.0.BARD_ALL])
		Detect([EVILCUTOFF.0.0.DRUID_ALL])
		Detect([EVILCUTOFF.0.BEHOLDER])
		Detect([EVILCUTOFF.0.MIND_FLAYER])
		Detect([EVILCUTOFF.0.RAKSHASA])
	HaveSpell(WIZARD_SPELL_SHIELD)  // SPWI519.SPL (Spell Shield)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	!HasBounceEffects(Myself)
	!HasImmunityEffects(Myself)
	!StateCheck(Myself,STATE_INVISIBLE)
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		Global("u_BypassCutoff","LOCALS",1)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_SPELL_SHIELD)  // SPWI519.SPL (Spell Shield)
END

IF
	ActionListEmpty()
	OR(7)
		Detect([EVILCUTOFF.0.0.MAGE_ALL])
		Detect([EVILCUTOFF.0.0.CLERIC_ALL])
		Detect([EVILCUTOFF.0.0.BARD_ALL])
		Detect([EVILCUTOFF.0.0.DRUID_ALL])
		Detect([EVILCUTOFF.0.BEHOLDER])
		Detect([EVILCUTOFF.0.MIND_FLAYER])
		Detect([EVILCUTOFF.0.RAKSHASA])
	HaveSpell(WIZARD_MINOR_SPELL_DEFLECTION)  // SPWI318.SPL (Minor Spell Deflection)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	!HasBounceEffects(Myself)
	!HasImmunityEffects(Myself)
	!StateCheck(Myself,STATE_INVISIBLE)
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		Global("u_BypassCutoff","LOCALS",1)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_MINOR_SPELL_DEFLECTION)  // SPWI318.SPL (Minor Spell Deflection)
END

IF
	ActionListEmpty()
	OR(7)
		Detect([EVILCUTOFF.0.0.MAGE_ALL])
		Detect([EVILCUTOFF.0.0.CLERIC_ALL])
		Detect([EVILCUTOFF.0.0.BARD_ALL])
		Detect([EVILCUTOFF.0.0.DRUID_ALL])
		Detect([EVILCUTOFF.0.BEHOLDER])
		Detect([EVILCUTOFF.0.MIND_FLAYER])
		Detect([EVILCUTOFF.0.RAKSHASA])
	HaveSpell(WIZARD_SPELL_TRAP)  // SPWI902.SPL (Spell Trap)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		Global("u_BypassCutoff","LOCALS",1)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_SPELL_TRAP)  // SPWI902.SPL (Spell Trap)
END

IF
	ActionListEmpty()
	HaveSpell(CLERIC_PIXIE_DUST)  // SPPR516.SPL (Pixie Dust)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	!StateCheck(Myself,STATE_INVISIBLE)
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		Global("u_BypassCutoff","LOCALS",1)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,CLERIC_PIXIE_DUST)  // SPPR516.SPL (Pixie Dust)
END

IF
	ActionListEmpty()
	HaveSpell(CLERIC_SANCTUARY)  // SPPR109.SPL (Sanctuary)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	!CheckStat(Myself,1,SANCTUARY)
	!StateCheck(Myself,STATE_INVISIBLE)
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,CLERIC_SANCTUARY)  // SPPR109.SPL (Sanctuary)
END

IF
	ActionListEmpty()
	OR(7)
		Detect([EVILCUTOFF.0.0.MAGE_ALL])
		Detect([EVILCUTOFF.0.0.CLERIC_ALL])
		Detect([EVILCUTOFF.0.0.BARD_ALL])
		Detect([EVILCUTOFF.0.0.DRUID_ALL])
		Detect([EVILCUTOFF.0.BEHOLDER])
		Detect([EVILCUTOFF.0.MIND_FLAYER])
		Detect([EVILCUTOFF.0.RAKSHASA])
	HaveSpell(CLERIC_SHIELD_OF_THE_ARCHONS)  // SPPR701.SPL (Shield of the Archons)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	!HasBounceEffects(Myself)
	!HasImmunityEffects(Myself)
	!StateCheck(Myself,STATE_INVISIBLE)
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		Global("u_BypassCutoff","LOCALS",1)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,CLERIC_SHIELD_OF_THE_ARCHONS)  // SPPR701.SPL (Shield of the Archons)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	!StateCheck(Myself,STATE_HASTED)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		Global("u_BypassCutoff","LOCALS",1)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_HASTE)  // SPWI305.SPL (Haste)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	!StateCheck(Myself,STATE_HASTED)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		Global("u_BypassCutoff","LOCALS",1)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_HASTE)  // SPWI305.SPL (Haste)
END

IF
	ActionListEmpty()
	Range("Mazzy",0)  // Mazzy
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	!StateCheck(Myself,STATE_HASTED)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		Global("u_BypassCutoff","LOCALS",1)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		SpellNoDec(Myself,MAZZY_HASTE)  // SPIN828.SPL (Haste)
END

IF
	ActionListEmpty()
	Alignment(NearestEnemyOf(Myself),MASK_EVIL)
	HaveSpell(CLERIC_PROTECTION_FROM_EVIL_10_FOOT)  // SPPR408.SPL (Protection From Evil, 10' Radius)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		Global("u_BypassCutoff","LOCALS",1)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,CLERIC_PROTECTION_FROM_EVIL_10_FOOT)  // SPPR408.SPL (Protection From Evil, 10' Radius)
END

IF
	ActionListEmpty()
	HaveSpell(CLERIC_DEFENSIVE_HARMONY)  // SPPR406.SPL (Defensive Harmony)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		Global("u_BypassCutoff","LOCALS",1)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,CLERIC_DEFENSIVE_HARMONY)  // SPPR406.SPL (Defensive Harmony)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_SPIRIT_ARMOR)  // SPWI414.SPL (Spirit Armor)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	CheckStatGT(Myself,1,ARMORCLASS)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_SPIRIT_ARMOR)  // SPWI414.SPL (Spirit Armor)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_GHOST_ARMOR)  // SPWI317.SPL (Ghost Armor)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	CheckStatGT(Myself,2,ARMORCLASS)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_GHOST_ARMOR)  // SPWI317.SPL (Ghost Armor)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_ARMOR)  // SPWI102.SPL (Armor)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	CheckStatGT(Myself,6,ARMORCLASS)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_ARMOR)  // SPWI102.SPL (Armor)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_SHIELD)  // SPWI114.SPL (Shield)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	CheckStatGT(Myself,4,ARMORCLASS)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_SHIELD)  // SPWI114.SPL (Shield)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_MIRROR_IMAGE)  // SPWI212.SPL (Mirror Image)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	!StateCheck(Myself,STATE_MIRRORIMAGE)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_MIRROR_IMAGE)  // SPWI212.SPL (Mirror Image)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_BLUR)  // SPWI201.SPL (Blur)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	!StateCheck(Myself,STATE_BLUR)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_BLUR)  // SPWI201.SPL (Blur)
END

IF
	ActionListEmpty()
	HaveSpell(CLERIC_BARKSKIN)  // SPPR202.SPL (Barkskin)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	CheckStatGT(Myself,1,ARMORCLASS)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,CLERIC_BARKSKIN)  // SPPR202.SPL (Barkskin)
END

IF
	ActionListEmpty()
	HaveSpell(CLERIC_ARMOR_OF_FAITH)  // SPPR111.SPL (Armor of Faith)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	!GlobalTimerNotExpired("u_ArmorOfFaith","LOCALS")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_ArmorOfFaith","LOCALS",TWO_TURNS)
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,CLERIC_ARMOR_OF_FAITH)  // SPPR111.SPL (Armor of Faith)
END

IF
	ActionListEmpty()
	CheckStat(Myself,1,DEATH_WARD)
	OR(3)
		Detect([EVILCUTOFF.0.0.MAGE_ALL])
		Detect([EVILCUTOFF.0.0.CLERIC_ALL])
		Detect([EVILCUTOFF.0.BEHOLDER])
	HaveSpell(CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		Global("u_BypassCutoff","LOCALS",1)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
END

IF
	See(Nearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		HasImmunityEffects(LastSeenBy(Myself))
	See(SecondNearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		HasImmunityEffects(LastSeenBy(Myself))
	See(ThirdNearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		HasImmunityEffects(LastSeenBy(Myself))
	See(FourthNearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		HasImmunityEffects(LastSeenBy(Myself))
	See(FifthNearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		HasImmunityEffects(LastSeenBy(Myself))
	See(SixthNearest([PC]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	ActionListEmpty()
	Allegiance(LastSeenBy(Myself),PC)
	OR(8)
		Detect([EVILCUTOFF.0.0.MAGE_ALL])
		Detect([EVILCUTOFF.0.0.CLERIC_ALL])
		Detect([EVILCUTOFF.0.0.BARD_ALL])
		Detect([EVILCUTOFF.0.0.DRUID_ALL])
		Detect([EVILCUTOFF.0.MIND_FLAYER])
		Detect([EVILCUTOFF.0.UMBERHULK])
		Detect([EVILCUTOFF.0.RAKSHASA])
		Detect([EVILCUTOFF.0.VAMPIRE])
	!HasImmunityEffects(LastSeenBy(Myself))
	HaveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		Global("u_BypassCutoff","LOCALS",1)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(LastSeenBy(Myself),CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
END

IF
	See(Nearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!CheckStatLT(LastSeenBy(Myself),17,STR)
	See(SecondNearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!CheckStatLT(LastSeenBy(Myself),17,STR)
	See(ThirdNearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!CheckStatLT(LastSeenBy(Myself),17,STR)
	See(FourthNearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!CheckStatLT(LastSeenBy(Myself),17,STR)
	See(FifthNearest([PC]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_NORMAL)
		!CheckStatLT(LastSeenBy(Myself),17,STR)
	See(SixthNearest([PC]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	ActionListEmpty()
	Allegiance(LastSeenBy(Myself),PC)
	!Class(LastSeenBy(Myself),MAGE_ALL)
	!Class(LastSeenBy(Myself),CLERIC_ALL)
	!Class(LastSeenBy(Myself),DRUID_ALL)
	!Class(LastSeenBy(Myself),BARD_ALL)
	HaveSpell(WIZARD_STRENGTH)  // SPWI214.SPL (Strength)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	CheckStatLT(LastSeenBy(Myself),17,STR)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		Global("u_BypassCutoff","LOCALS",1)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(LastSeenBy(Myself),WIZARD_STRENGTH)  // SPWI214.SPL (Strength)
END

IF
	ActionListEmpty()
	Allegiance(LastSeenBy(Myself),PC)
	!Class(LastSeenBy(Myself),MAGE_ALL)
	!Class(LastSeenBy(Myself),CLERIC_ALL)
	!Class(LastSeenBy(Myself),DRUID_ALL)
	!Class(LastSeenBy(Myself),BARD_ALL)
	Range("Mazzy",0)  // Mazzy
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	CheckStatLT(LastSeenBy(Myself),17,STR)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		Global("u_BypassCutoff","LOCALS",1)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		SpellNoDec(LastSeenBy(Myself),MAZZY_STRENGTH)  // SPIN826.SPL (Strength)
END

IF
	ActionListEmpty()
	!StateCheck(Myself,STATE_BLESS)
	HaveSpell(CLERIC_BLESS)  // SPPR101.SPL (Bless)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		Global("u_BypassCutoff","LOCALS",1)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,CLERIC_BLESS)  // SPPR101.SPL (Bless)
END

IF
	ActionListEmpty()
	!StateCheck(Myself,STATE_CHANT)
	HaveSpell(CLERIC_CHANT)  // SPPR203.SPL (Chant)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	OR(2)
		!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		Global("u_BypassCutoff","LOCALS",1)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SetGlobalTimer("u_DefensiveSpellCast","LOCALS",TWO_ROUNDS)
		Spell(Myself,CLERIC_CHANT)  // SPPR203.SPL (Chant)
END

IF
	Detect(NearestEnemyOf(Myself))
	OR(7)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		SpellCast([EVILCUTOFF],WIZARD_INVISIBILITY)  // SPWI206.SPL (Invisibility)
		SpellCast([EVILCUTOFF],WIZARD_IMPROVED_INVISIBILITY)  // SPWI405.SPL (Improved Invisibility)
		SpellCast([EVILCUTOFF],WIZARD_MIRROR_IMAGE)  // SPWI212.SPL (Mirror Image)
		SpellCast([EVILCUTOFF],WIZARD_MISLEAD)  // SPWI607.SPL (Mislead)
		SpellCast([EVILCUTOFF],WIZARD_PROJECT_IMAGE)  // SPWI703.SPL (Project Image)
	OR(2)
		HaveSpell(INQUIS_DISPEL_MAGIC)  // SPCL231.SPL (Dispel Magic)
		Range("Keldorn",0)  // Keldorn
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SpellNoDec(Myself,INQUIS_TRUE_SIGHT)  // SPCL232.SPL (True Sight)
		DisplayStringHead(Myself,25633)  // True Sight
END

IF
	OR(3)
		Detect(NearestEnemyOf(Myself))
		Detect([EVILCUTOFF])
		Detect([GOODBUTRED])
	OR(7)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		SpellCast([EVILCUTOFF],WIZARD_INVISIBILITY)  // SPWI206.SPL (Invisibility)
		SpellCast([EVILCUTOFF],WIZARD_IMPROVED_INVISIBILITY)  // SPWI405.SPL (Improved Invisibility)
		SpellCast([EVILCUTOFF],WIZARD_MIRROR_IMAGE)  // SPWI212.SPL (Mirror Image)
		SpellCast([EVILCUTOFF],WIZARD_MISLEAD)  // SPWI607.SPL (Mislead)
		SpellCast([EVILCUTOFF],WIZARD_PROJECT_IMAGE)  // SPWI703.SPL (Project Image)
	HaveSpell(WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Sight)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Sight)
		DisplayStringHead(Myself,25633)  // True Sight
END

IF
	OR(3)
		Detect(NearestEnemyOf(Myself))
		Detect([EVILCUTOFF])
		Detect([GOODBUTRED])
	OR(7)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		SpellCast([EVILCUTOFF],WIZARD_INVISIBILITY)  // SPWI206.SPL (Invisibility)
		SpellCast([EVILCUTOFF],WIZARD_IMPROVED_INVISIBILITY)  // SPWI405.SPL (Improved Invisibility)
		SpellCast([EVILCUTOFF],WIZARD_MIRROR_IMAGE)  // SPWI212.SPL (Mirror Image)
		SpellCast([EVILCUTOFF],WIZARD_MISLEAD)  // SPWI607.SPL (Mislead)
		SpellCast([EVILCUTOFF],WIZARD_PROJECT_IMAGE)  // SPWI703.SPL (Project Image)
	HaveSpell(CLERIC_TRUE_SIGHT)  // SPPR505.SPL (True Seeing)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_TRUE_SIGHT)  // SPPR505.SPL (True Seeing)
		DisplayStringHead(Myself,25633)  // True Sight
END

IF
	OR(3)
		Detect(NearestEnemyOf(Myself))
		Detect([EVILCUTOFF])
		Detect([GOODBUTRED])
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	HaveSpell(CLERIC_INVISIBILITY_PURGE)  // SPPR309.SPL (Invisibility Purge)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_INVISIBILITY_PURGE)  // SPPR309.SPL (Invisibility Purge)
		DisplayStringHead(LastSeenBy(Myself),12095)  // Invisibility Purge
END

IF
	ActionListEmpty()
	!See(NearestEnemyOf(Myself))
	OR(2)
		CheckStatGT(Myself,50,HIDEINSHADOWS)
		CheckStatGT(Myself,50,STEALTH)
	!ModalState(STEALTH)
	!StateCheck(Myself,STATE_INVISIBLE)
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	!GlobalTimerNotExpired("u_AttemptedToHide","LOCALS")
THEN
	RESPONSE #100
		SetGlobalTimer("u_AttemptedToHide","LOCALS",TWO_ROUNDS)
		Hide()
END

IF
	See(NearestEnemyOf(Myself))
	GlobalGT("u_MoveToPlayer","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobal("u_MoveToPlayer","LOCALS",0)
		ClearActions(Myself)
END

IF
	Global("MoveToPlayer","LOCALS",6)
	!Global("u_Player6SeeEnemy","GLOBAL",1)
THEN
	RESPONSE #100
		SetGlobal("MoveToPlayer","LOCALS",0)
		ClearActions(Myself)
END

IF
	Global("MoveToPlayer","LOCALS",5)
	!Global("u_Player5SeeEnemy","GLOBAL",1)
THEN
	RESPONSE #100
		SetGlobal("MoveToPlayer","LOCALS",0)
		ClearActions(Myself)
END

IF
	Global("MoveToPlayer","LOCALS",4)
	!Global("u_Player4SeeEnemy","GLOBAL",1)
THEN
	RESPONSE #100
		SetGlobal("MoveToPlayer","LOCALS",0)
		ClearActions(Myself)
END

IF
	Global("MoveToPlayer","LOCALS",3)
	!Global("u_Player3SeeEnemy","GLOBAL",1)
THEN
	RESPONSE #100
		SetGlobal("MoveToPlayer","LOCALS",0)
		ClearActions(Myself)
END

IF
	Global("MoveToPlayer","LOCALS",2)
	!Global("u_Player2SeeEnemy","GLOBAL",1)
THEN
	RESPONSE #100
		SetGlobal("MoveToPlayer","LOCALS",0)
		ClearActions(Myself)
END

IF
	Global("MoveToPlayer","LOCALS",1)
	!Global("u_Player1SeeEnemy","GLOBAL",1)
THEN
	RESPONSE #100
		SetGlobal("MoveToPlayer","LOCALS",0)
		ClearActions(Myself)
END

IF
	ActionListEmpty()
	!See(NearestEnemyOf(Myself))
	Global("u_Player6SeeEnemy","GLOBAL",1)
	!Range(Player6,1)
	HPPercentGT(Myself,50)
	Global("u_MovementOff","LOCALS",0)
THEN
	RESPONSE #100
		MoveToObject(Player6)
		SetGlobal("u_MoveToPlayer","LOCALS",6)
END

IF
	ActionListEmpty()
	!See(NearestEnemyOf(Myself))
	Global("u_Player5SeeEnemy","GLOBAL",1)
	!Range(Player5,1)
	HPPercentGT(Myself,50)
	Global("u_MovementOff","LOCALS",0)
THEN
	RESPONSE #100
		MoveToObject(Player5)
		SetGlobal("u_MoveToPlayer","LOCALS",5)
END

IF
	ActionListEmpty()
	!See(NearestEnemyOf(Myself))
	Global("u_Player4SeeEnemy","GLOBAL",1)
	!Range(Player4,1)
	HPPercentGT(Myself,50)
	Global("u_MovementOff","LOCALS",0)
THEN
	RESPONSE #100
		MoveToObject(Player4)
		SetGlobal("u_MoveToPlayer","LOCALS",4)
END

IF
	ActionListEmpty()
	!See(NearestEnemyOf(Myself))
	Global("u_Player3SeeEnemy","GLOBAL",1)
	!Range(Player3,1)
	HPPercentGT(Myself,50)
	Global("u_MovementOff","LOCALS",0)
THEN
	RESPONSE #100
		MoveToObject(Player3)
		SetGlobal("u_MoveToPlayer","LOCALS",3)
END

IF
	ActionListEmpty()
	!See(NearestEnemyOf(Myself))
	Global("u_Player2SeeEnemy","GLOBAL",1)
	!Range(Player2,1)
	HPPercentGT(Myself,50)
	Global("u_MovementOff","LOCALS",0)
THEN
	RESPONSE #100
		MoveToObject(Player2)
		SetGlobal("u_MoveToPlayer","LOCALS",2)
END

IF
	ActionListEmpty()
	!See(NearestEnemyOf(Myself))
	Global("u_Player1SeeEnemy","GLOBAL",1)
	!Range(Player1,1)
	HPPercentGT(Myself,50)
	Global("u_MovementOff","LOCALS",0)
THEN
	RESPONSE #100
		MoveToObject(Player1)
		SetGlobal("u_MoveToPlayer","LOCALS",1)
END

IF
	OR(2)
		See(Nearest([GOODBUTRED.0.DEMONIC]))
		True()
	OR(2)
		Detect(Nearest([EVILCUTOFF]))
		True()
	Detect(NearestEnemyOf(Myself))
	See(NearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	NumCreatureGT([EVILCUTOFF],9)
	OR(2)
		!LevelGT(LastSeenBy(Myself),10)
		LevelGT(TenthNearestEnemyOf(Myself),10)
	!InParty(TenthNearestEnemyOf(Myself))
	Allegiance(TenthNearestEnemyOf(Myself),EVILCUTOFF)
	!Class(TenthNearestEnemyOf(Myself),INNOCENT)
	!StateCheck(TenthNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(TenthNearestEnemyOf(Myself),STATE_HELPLESS)
	!StateCheck(TenthNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(TenthNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(TenthNearestEnemyOf(Myself),STATE_BLIND)
	!StateCheck(TenthNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(TenthNearestEnemyOf(Myself),STATE_CONFUSED)
	OR(2)
		!HPGT(LastSeenBy(Myself),20)
		HPGT(TenthNearestEnemyOf(Myself),20)
	OR(2)
		!Class(Myself,MAGE_ALL)
		!StateCheck(TenthNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,CLERIC_ALL)
		!StateCheck(TenthNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,DRUID_ALL)
		!StateCheck(TenthNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,BARD_ALL)
		!StateCheck(TenthNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	See(TenthNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	NumCreatureGT([EVILCUTOFF],8)
	OR(2)
		!LevelGT(LastSeenBy(Myself),10)
		LevelGT(NinthNearestEnemyOf(Myself),10)
	!InParty(NinthNearestEnemyOf(Myself))
	Allegiance(NinthNearestEnemyOf(Myself),EVILCUTOFF)
	!Class(NinthNearestEnemyOf(Myself),INNOCENT)
	!StateCheck(NinthNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(NinthNearestEnemyOf(Myself),STATE_HELPLESS)
	!StateCheck(NinthNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(NinthNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(NinthNearestEnemyOf(Myself),STATE_BLIND)
	!StateCheck(NinthNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(NinthNearestEnemyOf(Myself),STATE_CONFUSED)
	OR(2)
		!HPGT(LastSeenBy(Myself),20)
		HPGT(NinthNearestEnemyOf(Myself),20)
	OR(2)
		!Class(Myself,MAGE_ALL)
		!StateCheck(NinthNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,CLERIC_ALL)
		!StateCheck(NinthNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,DRUID_ALL)
		!StateCheck(NinthNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,BARD_ALL)
		!StateCheck(NinthNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	See(NinthNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	NumCreatureGT([EVILCUTOFF],7)
	OR(2)
		!LevelGT(LastSeenBy(Myself),10)
		LevelGT(EighthNearestEnemyOf(Myself),10)
	!InParty(EighthNearestEnemyOf(Myself))
	Allegiance(EighthNearestEnemyOf(Myself),EVILCUTOFF)
	!Class(EighthNearestEnemyOf(Myself),INNOCENT)
	!StateCheck(EighthNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(EighthNearestEnemyOf(Myself),STATE_HELPLESS)
	!StateCheck(EighthNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(EighthNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(EighthNearestEnemyOf(Myself),STATE_BLIND)
	!StateCheck(EighthNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(EighthNearestEnemyOf(Myself),STATE_CONFUSED)
	OR(2)
		!HPGT(LastSeenBy(Myself),20)
		HPGT(EighthNearestEnemyOf(Myself),20)
	OR(2)
		!Class(Myself,MAGE_ALL)
		!StateCheck(EighthNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,CLERIC_ALL)
		!StateCheck(EighthNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,DRUID_ALL)
		!StateCheck(EighthNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,BARD_ALL)
		!StateCheck(EighthNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	See(EighthNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	NumCreatureGT([EVILCUTOFF],6)
	OR(2)
		!LevelGT(LastSeenBy(Myself),10)
		LevelGT(SeventhNearestEnemyOf(Myself),10)
	!InParty(SeventhNearestEnemyOf(Myself))
	Allegiance(SeventhNearestEnemyOf(Myself),EVILCUTOFF)
	!Class(SeventhNearestEnemyOf(Myself),INNOCENT)
	!StateCheck(SeventhNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(SeventhNearestEnemyOf(Myself),STATE_HELPLESS)
	!StateCheck(SeventhNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(SeventhNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(SeventhNearestEnemyOf(Myself),STATE_BLIND)
	!StateCheck(SeventhNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(SeventhNearestEnemyOf(Myself),STATE_CONFUSED)
	OR(2)
		!HPGT(LastSeenBy(Myself),20)
		HPGT(SeventhNearestEnemyOf(Myself),20)
	OR(2)
		!Class(Myself,MAGE_ALL)
		!StateCheck(SeventhNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,CLERIC_ALL)
		!StateCheck(SeventhNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,DRUID_ALL)
		!StateCheck(SeventhNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,BARD_ALL)
		!StateCheck(SeventhNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	See(SeventhNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	NumCreatureGT([EVILCUTOFF],5)
	OR(2)
		!LevelGT(LastSeenBy(Myself),10)
		LevelGT(SixthNearestEnemyOf(Myself),10)
	!InParty(SixthNearestEnemyOf(Myself))
	Allegiance(SixthNearestEnemyOf(Myself),EVILCUTOFF)
	!Class(SixthNearestEnemyOf(Myself),INNOCENT)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_HELPLESS)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_BLIND)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_CONFUSED)
	OR(2)
		!HPGT(LastSeenBy(Myself),20)
		HPGT(SixthNearestEnemyOf(Myself),20)
	OR(2)
		!Class(Myself,MAGE_ALL)
		!StateCheck(SixthNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,CLERIC_ALL)
		!StateCheck(SixthNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,DRUID_ALL)
		!StateCheck(SixthNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,BARD_ALL)
		!StateCheck(SixthNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	See(SixthNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	NumCreatureGT([EVILCUTOFF],4)
	OR(2)
		!LevelGT(LastSeenBy(Myself),10)
		LevelGT(FifthNearestEnemyOf(Myself),10)
	!InParty(FifthNearestEnemyOf(Myself))
	Allegiance(FifthNearestEnemyOf(Myself),EVILCUTOFF)
	!Class(FifthNearestEnemyOf(Myself),INNOCENT)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_HELPLESS)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_BLIND)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_CONFUSED)
	OR(2)
		!HPGT(LastSeenBy(Myself),20)
		HPGT(FifthNearestEnemyOf(Myself),20)
	OR(2)
		!Class(Myself,MAGE_ALL)
		!StateCheck(FifthNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,CLERIC_ALL)
		!StateCheck(FifthNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,DRUID_ALL)
		!StateCheck(FifthNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,BARD_ALL)
		!StateCheck(FifthNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	See(FifthNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	NumCreatureGT([EVILCUTOFF],3)
	OR(2)
		!LevelGT(LastSeenBy(Myself),10)
		LevelGT(FourthNearestEnemyOf(Myself),10)
	!InParty(FourthNearestEnemyOf(Myself))
	Allegiance(FourthNearestEnemyOf(Myself),EVILCUTOFF)
	!Class(FourthNearestEnemyOf(Myself),INNOCENT)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_HELPLESS)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_BLIND)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_CONFUSED)
	OR(2)
		!HPGT(LastSeenBy(Myself),20)
		HPGT(FourthNearestEnemyOf(Myself),20)
	OR(2)
		!Class(Myself,MAGE_ALL)
		!StateCheck(FourthNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,CLERIC_ALL)
		!StateCheck(FourthNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,DRUID_ALL)
		!StateCheck(FourthNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,BARD_ALL)
		!StateCheck(FourthNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	See(FourthNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	NumCreatureGT([EVILCUTOFF],2)
	OR(2)
		!LevelGT(LastSeenBy(Myself),10)
		LevelGT(ThirdNearestEnemyOf(Myself),10)
	!InParty(ThirdNearestEnemyOf(Myself))
	Allegiance(ThirdNearestEnemyOf(Myself),EVILCUTOFF)
	!Class(ThirdNearestEnemyOf(Myself),INNOCENT)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_HELPLESS)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_BLIND)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_CONFUSED)
	OR(2)
		!HPGT(LastSeenBy(Myself),20)
		HPGT(ThirdNearestEnemyOf(Myself),20)
	OR(2)
		!Class(Myself,MAGE_ALL)
		!StateCheck(ThirdNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,CLERIC_ALL)
		!StateCheck(ThirdNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,DRUID_ALL)
		!StateCheck(ThirdNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,BARD_ALL)
		!StateCheck(ThirdNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	See(ThirdNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	NumCreatureGT([EVILCUTOFF],1)
	OR(2)
		!LevelGT(LastSeenBy(Myself),10)
		LevelGT(SecondNearestEnemyOf(Myself),10)
	!InParty(SecondNearestEnemyOf(Myself))
	Allegiance(SecondNearestEnemyOf(Myself),EVILCUTOFF)
	!Class(SecondNearestEnemyOf(Myself),INNOCENT)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_HELPLESS)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_BLIND)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_CONFUSED)
	OR(2)
		!HPGT(LastSeenBy(Myself),20)
		HPGT(SecondNearestEnemyOf(Myself),20)
	OR(2)
		!Class(Myself,MAGE_ALL)
		!StateCheck(SecondNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,CLERIC_ALL)
		!StateCheck(SecondNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,DRUID_ALL)
		!StateCheck(SecondNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,BARD_ALL)
		!StateCheck(SecondNearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	See(SecondNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!InParty(NearestEnemyOf(Myself))
	OR(2)
		!LevelGT(LastSeenBy(Myself),10)
		LevelGT(NearestEnemyOf(Myself),10)
	Allegiance(NearestEnemyOf(Myself),EVILCUTOFF)
	!Class(NearestEnemyOf(Myself),INNOCENT)
	!StateCheck(NearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(NearestEnemyOf(Myself),STATE_HELPLESS)
	!StateCheck(NearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(NearestEnemyOf(Myself),STATE_STUNNED)
	OR(2)
		!HPGT(LastSeenBy(Myself),20)
		HPGT(NearestEnemyOf(Myself),20)
	OR(2)
		!Class(Myself,MAGE_ALL)
		!StateCheck(NearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,CLERIC_ALL)
		!StateCheck(NearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,DRUID_ALL)
		!StateCheck(NearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,BARD_ALL)
		!StateCheck(NearestEnemyOf(Myself),STATE_IMPROVEDINVISIBILITY)
	See(NearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	OR(2)
		!LevelGT(LastSeenBy(Myself),15)
		LevelGT(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),10)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_CHARMED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_HELPLESS)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_SLEEPING)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_STUNNED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_BLIND)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_PANIC)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_CONFUSED)
	OR(2)
		!HPGT(LastSeenBy(Myself),20)
		HPGT(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),20)
	OR(2)
		!Class(Myself,MAGE_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,CLERIC_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,DRUID_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,BARD_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_IMPROVEDINVISIBILITY)
	See(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	OR(2)
		!LevelGT(LastSeenBy(Myself),15)
		LevelGT(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),10)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_CHARMED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_HELPLESS)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_SLEEPING)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_STUNNED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_BLIND)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_PANIC)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_CONFUSED)
	OR(2)
		!Class(Myself,MAGE_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,CLERIC_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,DRUID_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,BARD_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_IMPROVEDINVISIBILITY)
	See(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	OR(2)
		!LevelGT(LastSeenBy(Myself),15)
		LevelGT(SecondNearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),10)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),STATE_CHARMED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),STATE_HELPLESS)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),STATE_SLEEPING)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),STATE_STUNNED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),STATE_BLIND)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),STATE_PANIC)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),STATE_CONFUSED)
	OR(2)
		!HPGT(LastSeenBy(Myself),20)
		HPGT(SecondNearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),20)
	OR(2)
		!Class(Myself,MAGE_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,CLERIC_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,DRUID_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,BARD_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),STATE_IMPROVEDINVISIBILITY)
	See(SecondNearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	OR(2)
		!LevelGT(LastSeenBy(Myself),15)
		LevelGT(NearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),10)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),STATE_CHARMED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),STATE_HELPLESS)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),STATE_SLEEPING)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),STATE_STUNNED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),STATE_BLIND)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),STATE_PANIC)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),STATE_CONFUSED)
	OR(2)
		!Class(Myself,MAGE_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,CLERIC_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,DRUID_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,BARD_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]),STATE_IMPROVEDINVISIBILITY)
	See(NearestEnemyOfType([EVILCUTOFF.0.WRAITH.MIST]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	OR(2)
		!LevelGT(LastSeenBy(Myself),15)
		LevelGT(SecondNearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),10)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),STATE_CHARMED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),STATE_HELPLESS)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),STATE_SLEEPING)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),STATE_STUNNED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),STATE_BLIND)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),STATE_PANIC)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),STATE_CONFUSED)
	OR(2)
		!HPGT(LastSeenBy(Myself),20)
		HPGT(SecondNearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),20)
	OR(2)
		!Class(Myself,MAGE_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,CLERIC_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,DRUID_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,BARD_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),STATE_IMPROVEDINVISIBILITY)
	See(SecondNearestEnemyOfType([EVILCUTOFF.0.DEMONIC]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	OR(2)
		!LevelGT(LastSeenBy(Myself),15)
		LevelGT(NearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),10)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),STATE_CHARMED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),STATE_HELPLESS)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),STATE_SLEEPING)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),STATE_STUNNED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),STATE_BLIND)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),STATE_PANIC)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),STATE_CONFUSED)
	OR(2)
		!Class(Myself,MAGE_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,CLERIC_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,DRUID_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,BARD_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.DEMONIC]),STATE_IMPROVEDINVISIBILITY)
	See(NearestEnemyOfType([EVILCUTOFF.0.DEMONIC]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	OR(2)
		!LevelGT(LastSeenBy(Myself),15)
		LevelGT(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),10)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_CHARMED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_HELPLESS)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_SLEEPING)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_STUNNED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_BLIND)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_PANIC)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_CONFUSED)
	OR(2)
		!HPGT(LastSeenBy(Myself),20)
		HPGT(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),20)
	OR(2)
		!Class(Myself,MAGE_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,CLERIC_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,DRUID_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,BARD_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_IMPROVEDINVISIBILITY)
	See(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	OR(2)
		!LevelGT(LastSeenBy(Myself),15)
		LevelGT(NearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),10)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_CHARMED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_HELPLESS)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_SLEEPING)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_STUNNED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_BLIND)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_PANIC)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_CONFUSED)
	OR(2)
		!Class(Myself,MAGE_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,CLERIC_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,DRUID_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,BARD_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_IMPROVEDINVISIBILITY)
	See(NearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	OR(2)
		!LevelGT(LastSeenBy(Myself),15)
		LevelGT(SecondNearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),10)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_CHARMED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_HELPLESS)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_SLEEPING)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_STUNNED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_BLIND)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_PANIC)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_CONFUSED)
	OR(2)
		!HPGT(LastSeenBy(Myself),20)
		HPGT(SecondNearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),20)
	OR(2)
		!Class(Myself,MAGE_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,CLERIC_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,DRUID_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,BARD_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_IMPROVEDINVISIBILITY)
	See(SecondNearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	OR(2)
		!LevelGT(LastSeenBy(Myself),15)
		LevelGT(NearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),10)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_CHARMED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_HELPLESS)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_SLEEPING)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_STUNNED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_BLIND)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_PANIC)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_CONFUSED)
	OR(2)
		!Class(Myself,MAGE_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,CLERIC_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,DRUID_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,BARD_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_IMPROVEDINVISIBILITY)
	See(NearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	OR(2)
		!LevelGT(LastSeenBy(Myself),15)
		LevelGT(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),10)
	!InParty(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]))
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_CHARMED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_HELPLESS)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_SLEEPING)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_STUNNED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_BLIND)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_PANIC)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_CONFUSED)
	OR(2)
		!HPGT(LastSeenBy(Myself),20)
		HPGT(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),20)
	OR(2)
		!Class(Myself,MAGE_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,CLERIC_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,DRUID_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,BARD_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_IMPROVEDINVISIBILITY)
	See(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	OR(2)
		!LevelGT(LastSeenBy(Myself),15)
		LevelGT(NearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),10)
	!InParty(NearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]))
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_CHARMED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_HELPLESS)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_SLEEPING)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_STUNNED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_BLIND)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_PANIC)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_CONFUSED)
	OR(2)
		!Class(Myself,MAGE_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,CLERIC_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,DRUID_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,BARD_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_IMPROVEDINVISIBILITY)
	See(NearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	OR(2)
		!LevelGT(LastSeenBy(Myself),15)
		LevelGT(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),10)
	!InParty(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]))
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_CHARMED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_HELPLESS)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_SLEEPING)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_STUNNED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_BLIND)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_PANIC)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_CONFUSED)
	OR(2)
		!HPGT(LastSeenBy(Myself),20)
		HPGT(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),20)
	OR(2)
		!Class(Myself,MAGE_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,CLERIC_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,DRUID_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,BARD_ALL)
		!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_IMPROVEDINVISIBILITY)
	See(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	OR(2)
		!LevelGT(LastSeenBy(Myself),15)
		LevelGT(NearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),10)
	!InParty(NearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]))
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_CHARMED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_HELPLESS)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_SLEEPING)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_STUNNED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_BLIND)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_PANIC)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_CONFUSED)
	OR(2)
		!Class(Myself,MAGE_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,CLERIC_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,DRUID_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!Class(Myself,BARD_ALL)
		!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_IMPROVEDINVISIBILITY)
	See(NearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.DRAGON]),STATE_CHARMED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.DRAGON]),STATE_HELPLESS)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.DRAGON]),STATE_SLEEPING)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.DRAGON]),STATE_STUNNED)
	See(NearestEnemyOfType([EVILCUTOFF.0.DRAGON]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	Range("Minsc",0)  // Minsc
	!Race(LastSeenBy(Myself),VAMPIRE)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_CHARMED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_HELPLESS)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_SLEEPING)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_STUNNED)
	See(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	Range("Valygar",0)  // Valygar
	!Race(LastSeenBy(Myself),GOLEM)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.GOLEM]),STATE_CHARMED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.GOLEM]),STATE_HELPLESS)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.GOLEM]),STATE_SLEEPING)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.GOLEM]),STATE_STUNNED)
	See(NearestEnemyOfType([EVILCUTOFF.0.GOLEM]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	HPPercentLT(MostDamagedOf([PC]),60)
	OR(2)
		!LevelGT(LastSeenBy(Myself),10)
		LevelGT(LastAttackerOf(MostDamagedOf([PC])),10)
	!InParty(LastAttackerOf(MostDamagedOf([PC])))
	!Class(LastAttackerOf(MostDamagedOf([PC])),INNOCENT)
	!StateCheck(LastAttackerOf(MostDamagedOf([PC])),STATE_CHARMED)
	!StateCheck(LastAttackerOf(MostDamagedOf([PC])),STATE_HELPLESS)
	!StateCheck(LastAttackerOf(MostDamagedOf([PC])),STATE_SLEEPING)
	!StateCheck(LastAttackerOf(MostDamagedOf([PC])),STATE_STUNNED)
	See(LastAttackerOf(MostDamagedOf([PC])))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	OR(2)
		AttackedBy([EVILCUTOFF],DEFAULT)
		AttackedBy([GOODBUTRED.0.DEMONIC],DEFAULT)
	HPPercentLT(Myself,70)
	!InParty(LastAttackerOf(Myself))
	!Class(LastAttackerOf(Myself),INNOCENT)
	!StateCheck(LastAttackerOf(Myself),STATE_CHARMED)
	!StateCheck(LastAttackerOf(Myself),STATE_HELPLESS)
	!StateCheck(LastAttackerOf(Myself),STATE_SLEEPING)
	!StateCheck(LastAttackerOf(Myself),STATE_STUNNED)
	See(LastAttackerOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	GlobalTimerNotExpired("u_TimeStop","LOCALS")
	See(NearestEnemyOf(Myself))
	NumCreatureGT([EVILCUTOFF],1)
	!GlobalTimerNotExpired("u_TimeStopTarget2","LOCALS")
	See(SecondNearestEnemyOf(Myself))
	NumCreatureGT([EVILCUTOFF],2)
	!GlobalTimerNotExpired("u_TimeStopTarget3","LOCALS")
	See(ThirdNearestEnemyOf(Myself))
	NumCreatureGT([EVILCUTOFF],3)
	!GlobalTimerNotExpired("u_TimeStopTarget4","LOCALS")
	See(FourthNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	Global("u_PartyProtector","LOCALS",0)
	OR(2)
		HaveSpell(0)
		HaveSpell(CLERIC_DOOM)  // SPPR113.SPL (Doom)
	StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	See(NearestEnemyOf(Myself))
	StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	See(SecondNearestEnemyOf(Myself))
	StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	See(ThirdNearestEnemyOf(Myself))
	StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	See(FourthNearestEnemyOf(Myself))
	StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	See(FifthNearestEnemyOf(Myself))
	StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	See(SixthNearestEnemyOf(Myself))
	StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	See(SeventhNearestEnemyOf(Myself))
	StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	See(EighthNearestEnemyOf(Myself))
	StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	See(NinthNearestEnemyOf(Myself))
	StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	Global("u_SpellcastingOff","LOCALS",0)
	See(TenthNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	ActionListEmpty()
	OR(3)
		InParty(LastSeenBy(Myself))
		Allegiance(LastSeenBy(Myself),GOODCUTOFF)
		Class(LastSeenBy(Myself),INNOCENT)
	!Race(LastSeenBy(Myself),DEMONIC)
THEN
	RESPONSE #100
		NoAction()
END

IF
	ActionListEmpty()
	HPGT(LastSeenBy(Myself),50)
	NumCreatureGT([EVILCUTOFF],3)
	HaveSpell(WIZARD_TIME_STOP)  // SPWI909.SPL (Time Stop)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	!GlobalTimerNotExpired("u_TimeStop","LOCALS")
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_TIME_STOP)  // SPWI909.SPL (Time Stop)
		SetGlobalTimer("u_TimeStop","LOCALS",THREE_ROUNDS)
		SetGlobalTimer("u_TimeStopTarget2","LOCALS",ONE_MINUTE)
		SetGlobalTimer("u_TimeStopTarget3","LOCALS",9)
		SetGlobalTimer("u_TimeStopTarget4","LOCALS",14)
END

IF
	ActionListEmpty()
	HPGT(LastSeenBy(Myself),50)
	NumCreatureGT([EVILCUTOFF],3)
	HaveSpell(WIZARD_IMPROVED_ALUCRITY)  // SPWI921.SPL (Improved Alacrity)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	!GlobalTimerNotExpired("u_ImprovedAlacrity","LOCALS")
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_IMPROVED_ALUCRITY)  // SPWI921.SPL (Improved Alacrity)
		SetGlobalTimer("u_ImprovedAlacrity","LOCALS",TWO_ROUNDS)
END

IF
	ActionListEmpty()
	GlobalTimerNotExpired("u_TimeStop","LOCALS")
	HaveSpell(WIZARD_IMPRISONMENT)  // SPWI910.SPL (Imprisonment)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_IMPRISONMENT)  // SPWI910.SPL (Imprisonment)
END

IF
	ActionListEmpty()
	OR(5)
		HasBounceEffects(LastSeenBy(Myself))
		CheckStatGT(LastSeenBy(Myself),0,STONESKINS)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		StateCheck(LastSeenBy(Myself),STATE_BLUR)
		StateCheck(LastSeenBy(Myself),STATE_HASTED)
	HaveSpell(WIZARD_REMOVE_MAGIC)  // SPWI302.SPL (Remove Magic)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	OR(2)
		!GlobalTimerNotExpired("u_TimeStop","LOCALS")
		GlobalTimerNotExpired("u_TimeStopTarget2","LOCALS")
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_REMOVE_MAGIC)  // SPWI302.SPL (Remove Magic)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_GREATER_MALISON)  // SPWI412.SPL (Greater Malison)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureGT([EVILCUTOFF],2)
	OR(2)
		CheckStatGT(LastSeenBy(Myself),10,SAVEVSDEATH)
		CheckStatGT(LastSeenBy(Myself),10,SAVEVSSPELL)
	OR(2)
		!GlobalTimerNotExpired("u_TimeStop","LOCALS")
		GlobalTimerNotExpired("u_TimeStopTarget2","LOCALS")
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_GREATER_MALISON)  // SPWI412.SPL (Greater Malison)
END

IF
	ActionListEmpty()
	NumCreatureGT([EVILCUTOFF],3)
	HaveSpell(WIZARD_COMET)  // SPWI925.SPL (Comet)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	HPGT(LastSeenBy(Myself),60)
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_COMET)  // SPWI925.SPL (Comet)
END

IF
	ActionListEmpty()
	NumCreatureGT([EVILCUTOFF],3)
	HaveSpell(WIZARD_DRAGONS_BREATH)  // SPWI922.SPL (Dragon's Breath)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	HPGT(LastSeenBy(Myself),60)
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_DRAGONS_BREATH)  // SPWI922.SPL (Dragon's Breath)
END

IF
	ActionListEmpty()
	NumCreatureGT([EVILCUTOFF],3)
	HaveSpell(WIZARD_ABI_DALZIMS_HORRID_WILTING)  // SPWI812.SPL (Abi-Dalzim's Horrid Wilting)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	HPGT(LastSeenBy(Myself),50)
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_ABI_DALZIMS_HORRID_WILTING)  // SPWI812.SPL (Abi-Dalzim's Horrid Wilting)
END

IF
	ActionListEmpty()
	NumCreatureGT([EVILCUTOFF],3)
	HaveSpell(WIZARD_DEATH_SPELL)  // SPWI605.SPL (Death Spell)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	HPGT(LastSeenBy(Myself),30)
	OR(2)
		HPLT(LastSeenBy(Myself),80)
		Gender(LastSeenBy(Myself),SUMMONED)
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_DEATH_SPELL)  // SPWI605.SPL (Death Spell)
END

IF
	ActionListEmpty()
	NumCreatureGT([EVILCUTOFF],3)
	HaveSpell(WIZARD_PRISMATIC_SPRAY)  // SPWI714.SPL (Prismatic Spray)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	HPGT(LastSeenBy(Myself),50)
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_PRISMATIC_SPRAY)  // SPWI714.SPL (Prismatic Spray)
END

IF
	ActionListEmpty()
	NumCreatureGT([EVILCUTOFF],3)
	HaveSpell(WIZARD_CHAIN_LIGHTNING)  // SPWI615.SPL (Chain Lightning)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	HPGT(LastSeenBy(Myself),30)
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_CHAIN_LIGHTNING)  // SPWI615.SPL (Chain Lightning)
END

IF
	ActionListEmpty()
	NumCreatureGT([EVILCUTOFF],3)
	HaveSpell(CLERIC_STORM_OF_VENGEANCE)  // SPPR722.SPL (Storm of Vengeance)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	HPGT(LastSeenBy(Myself),60)
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_STORM_OF_VENGEANCE)  // SPPR722.SPL (Storm of Vengeance)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),5)
	NumCreatureGT([EVILCUTOFF],2)
	HaveSpell(CLERIC_NATURE_BEAUTY)  // SPPR704.SPL (Nature's Beauty)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	HPGT(LastSeenBy(Myself),50)
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_NATURE_BEAUTY)  // SPPR704.SPL (Nature's Beauty)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),10)
	Alignment(LastSeenBy(Myself),MASK_EVIL)
	NumCreatureGT([EVILCUTOFF],3)
	CheckStatLT(LastSeenBy(Myself),70,RESISTMAGIC)
	HaveSpell(CLERIC_HOLY_WORD)  // SPPR710.SPL (Holy Word)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	HPGT(LastSeenBy(Myself),50)
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_HOLY_WORD)  // SPPR710.SPL (Holy Word)
END

IF
	ActionListEmpty()
	General(LastSeenBy(Myself),UNDEAD)
	NumCreatureGT([EVILCUTOFF],3)
	HaveSpell(CLERIC_SUNRAY)  // SPPR707.SPL (Sunray)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	HPGT(LastSeenBy(Myself),50)
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_SUNRAY)  // SPPR707.SPL (Sunray)
END

IF
	ActionListEmpty()
	Alignment(LastSeenBy(Myself),MASK_EVIL)
	!Alignment(Player1,MASK_EVIL)
	!Alignment(Player2,MASK_EVIL)
	!Alignment(Player3,MASK_EVIL)
	!Alignment(Player4,MASK_EVIL)
	!Alignment(Player5,MASK_EVIL)
	!Alignment(Player6,MASK_EVIL)
	NumCreatureGT([EVILCUTOFF],3)
	HaveSpell(CLERIC_HOLY_SMITE)  // SPPR313.SPL (Holy Smite)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_HOLY_SMITE)  // SPPR313.SPL (Holy Smite)
END

IF
	ActionListEmpty()
	NumCreatureGT([EVILCUTOFF],2)
	AreaCheck("UTDOOR)")
	HaveSpell(CLERIC_CALL_LIGHTNING)  // SPPR302.SPL (Call Lightning)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_CALL_LIGHTNING)  // SPPR302.SPL (Call Lightning)
END

IF
	ActionListEmpty()
	OR(2)
		Class(LastSeenBy(Myself),MAGE_ALL)
		NumCreatureGT([EVILCUTOFF],2)
	HaveSpell(CLERIC_INSECT_PLAGUE)  // SPPR517.SPL (Insect Plague)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_INSECT_PLAGUE)  // SPPR517.SPL (Insect Plague)
END

IF
	ActionListEmpty()
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	Range(LastSeenBy(Myself),10)
	GlobalLT("u_UsedHarpOfPandemonium","LOCALS",3)
	HasItemEquiped("WA2HARP",Myself)  // Harp of Pandemonium
THEN
	RESPONSE #100
		UseItem("WA2HARP",LastSeenBy(Myself))  // Harp of Pandemonium
		IncrementGlobal("u_UsedHarpOfPandemonium","LOCALS",1)
		DisplayStringHead(Myself,61573)  // Harp of Pandemonium
END

IF
	ActionListEmpty()
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	Range(LastSeenBy(Myself),10)
	GlobalLT("u_UsedHarpOfDiscord","LOCALS",3)
	HasItemEquiped("MISC3M",Myself)  // Harp of Discord
THEN
	RESPONSE #100
		UseItem("MISC3M",LastSeenBy(Myself))  // Harp of Discord
		IncrementGlobal("u_UsedHarpOfDiscord","LOCALS",1)
		DisplayStringHead(Myself,38790)  // Harp of Discord
END

IF
	ActionListEmpty()
	!StateCheck(LastSeenBy(Myself),STATE_BLIND)
	HaveSpell(WIZARD_POWER_WORD_BLIND)  // SPWI815.SPL (Power Word, Blind)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureGT([EVILCUTOFF],2)
	HPGT(LastSeenBy(Myself),40)
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_POWER_WORD_BLIND)  // SPWI815.SPL (Power Word, Blind)
END

IF
	ActionListEmpty()
	!General(LastSeenBy(Myself),UNDEAD)
	!StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
	HaveSpell(WIZARD_HOLD_MONSTER)  // SPWI507.SPL (Hold Monster)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureGT([EVILCUTOFF],2)
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_HOLD_MONSTER)  // SPWI507.SPL (Hold Monster)
END

IF
	ActionListEmpty()
	General(LastSeenBy(Myself),HUMANOID)
	!StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
	HaveSpell(WIZARD_HOLD_PERSON)  // SPWI306.SPL (Hold Person)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureGT([EVILCUTOFF],2)
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_HOLD_PERSON)  // SPWI306.SPL (Hold Person)
END

IF
	ActionListEmpty()
	!StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
	HaveSpell(WIZARD_EMOTION_HOPELESSNESS)  // SPWI411.SPL (Emotion: Hopelessness)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureGT([EVILCUTOFF],2)
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_EMOTION_HOPELESSNESS)  // SPWI411.SPL (Emotion: Hopelessness)
END

IF
	ActionListEmpty()
	!StateCheck(LastSeenBy(Myself),STATE_BLIND)
	HaveSpell(WIZARD_GLITTERDUST)  // SPWI224.SPL (Glitterdust)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureGT([EVILCUTOFF],2)
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_GLITTERDUST)  // SPWI224.SPL (Glitterdust)
END

IF
	ActionListEmpty()
	!General(LastSeenBy(Myself),UNDEAD)
	!StateCheck(LastSeenBy(Myself),STATE_PANIC)
	HaveSpell(WIZARD_HORROR)  // SPWI205.SPL (Horror)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureGT([EVILCUTOFF],2)
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_HORROR)  // SPWI205.SPL (Horror)
END

IF
	ActionListEmpty()
	!StateCheck(LastSeenBy(Myself),STATE_SLOWED)
	HaveSpell(WIZARD_SLOW)  // SPWI312.SPL (Slow)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureGT([EVILCUTOFF],2)
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_SLOW)  // SPWI312.SPL (Slow)
END

IF
	ActionListEmpty()
	!StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
	HaveSpell(CLERIC_GREATER_COMMAND)  // SPPR512.SPL (Greater Command)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureGT([EVILCUTOFF],2)
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_GREATER_COMMAND)  // SPPR512.SPL (Greater Command)
END

IF
	ActionListEmpty()
	General(LastSeenBy(Myself),HUMANOID)
	!StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
	HaveSpell(CLERIC_HOLD_PERSON)  // SPPR208.SPL (Hold Person)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureGT([EVILCUTOFF],2)
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_HOLD_PERSON)  // SPPR208.SPL (Hold Person)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),10)
	LevelLT(LastSeenBy(Myself),10)
	!StateCheck(LastSeenBy(Myself),STATE_PANIC)
	HaveSpell(CLERIC_CLOAK_OF_FEAR)  // SPPR416.SPL (Cloak of Fear)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureGT([EVILCUTOFF],2)
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_CLOAK_OF_FEAR)  // SPPR416.SPL (Cloak of Fear)
END

IF
	ActionListEmpty()
	General(LastSeenBy(Myself),ANIMAL)
	!StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
	HaveSpell(CLERIC_HOLD_ANIMAL)  // SPPR305.SPL (Hold Animal)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureGT([EVILCUTOFF],2)
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_HOLD_ANIMAL)  // SPPR305.SPL (Hold Animal)
END

IF
	ActionListEmpty()
	OR(2)
		Class(LastSeenBy(Myself),MAGE_ALL)
		Class(LastSeenBy(Myself),CLERIC_ALL)
	HPGT(LastSeenBy(Myself),30)
	HaveSpell(WIZARD_SUMMON_NISHRUU)  // SPWI624.SPL (Summon Nishruu)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_SUMMON_NISHRUU)  // SPWI624.SPL (Summon Nishruu)
END

IF
	ActionListEmpty()
	Class(LastSeenBy(Myself),MAGE_ALL)
	OR(2)
		CheckStatGT(LastSeenBy(Myself),0,STONESKINS)
		CheckStatGT(LastSeenBy(Myself),0,SHIELDGLOBE)
	HaveSpell(WIZARD_BREACH)  // SPWI513.SPL (Breach)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	OR(2)
		!GlobalTimerNotExpired("u_TimeStop","LOCALS")
		GlobalTimerNotExpired("u_TimeStopTarget2","LOCALS")
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,5021)  // Breach
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_BREACH)  // SPWI513.SPL (Breach)
END

IF
	ActionListEmpty()
	Class(LastSeenBy(Myself),0)
	OR(2)
		HasBounceEffects(LastSeenBy(Myself))
		HasImmunityEffects(LastSeenBy(Myself))
	HaveSpell(WIZARD_SPELL_STRIKE)  // SPWI903.SPL (Spellstrike)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	OR(2)
		!GlobalTimerNotExpired("u_TimeStop","LOCALS")
		GlobalTimerNotExpired("u_TimeStopTarget2","LOCALS")
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_SPELL_STRIKE)  // SPWI903.SPL (Spellstrike)
END

IF
	ActionListEmpty()
	Class(LastSeenBy(Myself),MAGE_ALL)
	OR(2)
		HasBounceEffects(LastSeenBy(Myself))
		HasImmunityEffects(LastSeenBy(Myself))
	HaveSpell(WIZARD_SECRET_WORD)  // SPWI419.SPL (Secret Word)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	OR(2)
		!GlobalTimerNotExpired("u_TimeStop","LOCALS")
		GlobalTimerNotExpired("u_TimeStopTarget2","LOCALS")
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_SECRET_WORD)  // SPWI419.SPL (Secret Word)
END

IF
	ActionListEmpty()
	Class(LastSeenBy(Myself),MAGE_ALL)
	OR(2)
		HasBounceEffects(LastSeenBy(Myself))
		HasImmunityEffects(LastSeenBy(Myself))
	HaveSpell(WIZARD_SPELL_THRUST)  // SPWI321.SPL (Spell Thrust)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	OR(2)
		!GlobalTimerNotExpired("u_TimeStop","LOCALS")
		GlobalTimerNotExpired("u_TimeStopTarget2","LOCALS")
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_SPELL_THRUST)  // SPWI321.SPL (Spell Thrust)
END

IF
	ActionListEmpty()
	CheckStatGT(LastSeenBy(Myself),40,RESISTMAGIC)
	HaveSpell(WIZARD_LOWER_RESISTANCE)  // SPWI514.SPL (Lower Resistance)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	OR(2)
		!GlobalTimerNotExpired("u_TimeStop","LOCALS")
		GlobalTimerNotExpired("u_TimeStopTarget2","LOCALS")
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_LOWER_RESISTANCE)  // SPWI514.SPL (Lower Resistance)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_DOMINATION)  // SPWI506.SPL (Domination)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureGT([EVILCUTOFF],2)
	!HasBounceEffects(LastSeenBy(Myself))
	!GlobalTimerNotExpired("u_TimeStop","LOCALS")
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_DOMINATION)  // SPWI506.SPL (Domination)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_DIRE_CHARM)  // SPWI316.SPL (Dire Charm)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureGT([EVILCUTOFF],2)
	!HasBounceEffects(LastSeenBy(Myself))
	!GlobalTimerNotExpired("u_TimeStop","LOCALS")
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_DIRE_CHARM)  // SPWI316.SPL (Dire Charm)
END

IF
	ActionListEmpty()
	General(LastSeenBy(Myself),HUMANOID)
	HaveSpell(WIZARD_CHARM_PERSON)  // SPWI104.SPL (Charm Person)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureGT([EVILCUTOFF],2)
	!HasBounceEffects(LastSeenBy(Myself))
	LevelLT(LastSeenBy(Myself),10)
	!GlobalTimerNotExpired("u_TimeStop","LOCALS")
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_CHARM_PERSON)  // SPWI104.SPL (Charm Person)
END

IF
	ActionListEmpty()
	HaveSpell(CLERIC_MENTAL_DOMINATION)  // SPPR405.SPL (Mental Domination)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureGT([EVILCUTOFF],2)
	!HasBounceEffects(LastSeenBy(Myself))
	!GlobalTimerNotExpired("u_TimeStop","LOCALS")
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_MENTAL_DOMINATION)  // SPPR405.SPL (Mental Domination)
END

IF
	ActionListEmpty()
	OR(2)
		General(LastSeenBy(Myself),HUMANOID)
		General(LastSeenBy(Myself),ANIMAL)
	HaveSpell(CLERIC_CHARM_PERSON)  // SPPR204.SPL (Charm Person or Mammal)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	!HasBounceEffects(LastSeenBy(Myself))
	LevelLT(LastSeenBy(Myself),10)
	!GlobalTimerNotExpired("u_TimeStop","LOCALS")
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_CHARM_PERSON)  // SPPR204.SPL (Charm Person or Mammal)
END

IF
	ActionListEmpty()
	General(LastSeenBy(Myself),ANIMAL)
	HaveSpell(RANGER_CHARM_ANIMAL)  // SPCL311.SPL (Charm Animal)
	NumCreatureGT([EVILCUTOFF],2)
	!HasBounceEffects(LastSeenBy(Myself))
	!GlobalTimerNotExpired("u_TimeStop","LOCALS")
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),RANGER_CHARM_ANIMAL)  // SPCL311.SPL (Charm Animal)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_POWER_WORD_KILL)  // SPWI912.SPL (Power Word, Kill)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	HPLT(LastSeenBy(Myself),60)
	HPGT(LastSeenBy(Myself),30)
	!HasBounceEffects(LastSeenBy(Myself))
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_POWER_WORD_KILL)  // SPWI912.SPL (Power Word, Kill)
END

IF
	ActionListEmpty()
	OR(2)
		Class(LastSeenBy(Myself),MAGE_ALL)
		Class(LastSeenBy(Myself),CLERIC_ALL)
	!StateCheck(LastSeenBy(Myself),STATE_SILENCED)
	HaveSpell(WIZARD_POWER_WORD_SILENCE)  // SPWI612.SPL (Power Word, Silence)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	!HasBounceEffects(LastSeenBy(Myself))
	!HasImmunityEffects(LastSeenBy(Myself))
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_POWER_WORD_SILENCE)  // SPWI612.SPL (Power Word, Silence)
END

IF
	ActionListEmpty()
	OR(2)
		Class(LastSeenBy(Myself),MAGE_ALL)
		Class(LastSeenBy(Myself),CLERIC_ALL)
	!StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
	HaveSpell(WIZARD_FEEBLEMIND)  // SPWI509.SPL (Feeblemind)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	!HasBounceEffects(LastSeenBy(Myself))
	!HasImmunityEffects(LastSeenBy(Myself))
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_FEEBLEMIND)  // SPWI509.SPL (Feeblemind)
END

IF
	ActionListEmpty()
	OR(2)
		Class(LastSeenBy(Myself),MAGE_ALL)
		Class(LastSeenBy(Myself),CLERIC_ALL)
	HaveSpell(CLERIC_SUMMON_INSECTS)  // SPPR319.SPL (Summon Insects)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_SUMMON_INSECTS)  // SPPR319.SPL (Summon Insects)
END

IF
	ActionListEmpty()
	!StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
	HaveSpell(WIZARD_BIGBYS_CRUSHING_HAND)  // SPWI918.SPL (Bigby's Crushing Hand)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	HPGT(LastSeenBy(Myself),80)
	!HasBounceEffects(LastSeenBy(Myself))
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_BIGBYS_CRUSHING_HAND)  // SPWI918.SPL (Bigby's Crushing Hand)
END

IF
	ActionListEmpty()
	!StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
	HaveSpell(WIZARD_BIGBYS_CLENCHED_FIST)  // SPWI818.SPL (Bigby's Clenched Fist)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	HPGT(LastSeenBy(Myself),70)
	!HasBounceEffects(LastSeenBy(Myself))
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_BIGBYS_CLENCHED_FIST)  // SPWI818.SPL (Bigby's Clenched Fist)
END

IF
	ActionListEmpty()
	HPLT(LastSeenBy(Myself),90)
	!StateCheck(LastSeenBy(Myself),STATE_STUNNED)
	HaveSpell(WIZARD_POWER_WORD_STUN)  // SPWI715.SPL (Power Word, Stun)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	HPGT(LastSeenBy(Myself),50)
	NumCreatureGT([EVILCUTOFF],1)
	!HasBounceEffects(LastSeenBy(Myself))
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_POWER_WORD_STUN)  // SPWI715.SPL (Power Word, Stun)
END

IF
	ActionListEmpty()
	HPLT(LastSeenBy(Myself),20)
	!StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
	HaveSpell(0)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureGT([EVILCUTOFF],1)
	!HasBounceEffects(LastSeenBy(Myself))
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_POWER_WORD_SLEEP)  // SPWI220.SPL (Power Word, Sleep)
END

IF
	ActionListEmpty()
	LevelLT(LastSeenBy(Myself),10)
	HaveSpell(WIZARD_POLYMORPH_OTHER)  // SPWI415.SPL (Polymorph Other)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureGT([EVILCUTOFF],1)
	!HasBounceEffects(LastSeenBy(Myself))
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_POLYMORPH_OTHER)  // SPWI415.SPL (Polymorph Other)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_CHROMATIC_ORB)  // SPWI118.SPL (Chromatic Orb)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureGT([EVILCUTOFF],1)
	LevelLT(LastSeenBy(Myself),10)
	!HasBounceEffects(LastSeenBy(Myself))
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_CHROMATIC_ORB)  // SPWI118.SPL (Chromatic Orb)
END

IF
	ActionListEmpty()
	!General(LastSeenBy(Myself),UNDEAD)
	!StateCheck(LastSeenBy(Myself),STATE_PANIC)
	HaveSpell(WIZARD_SPOOK)  // SPWI125.SPL (Spook)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureGT([EVILCUTOFF],1)
	LevelLT(LastSeenBy(Myself),10)
	!HasBounceEffects(LastSeenBy(Myself))
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_SPOOK)  // SPWI125.SPL (Spook)
END

IF
	ActionListEmpty()
	!StateCheck(LastSeenBy(Myself),STATE_BLIND)
	HaveSpell(WIZARD_BLINDNESS)  // SPWI106.SPL (Blindness)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureGT([EVILCUTOFF],1)
	LevelLT(LastSeenBy(Myself),10)
	!HasBounceEffects(LastSeenBy(Myself))
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_BLINDNESS)  // SPWI106.SPL (Blindness)
END

IF
	ActionListEmpty()
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	HaveSpell(CLERIC_RIGID_THINKING)  // SPPR311.SPL (Rigid Thinking)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureGT([EVILCUTOFF],1)
	!HasBounceEffects(LastSeenBy(Myself))
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_RIGID_THINKING)  // SPPR311.SPL (Rigid Thinking)
END

IF
	ActionListEmpty()
	!StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
	HaveSpell(CLERIC_COMMAND)  // SPPR102.SPL (Command)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureGT([EVILCUTOFF],1)
	LevelLT(LastSeenBy(Myself),10)
	!HasBounceEffects(LastSeenBy(Myself))
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_COMMAND)  // SPPR102.SPL (Command)
END

IF
	ActionListEmpty()
	HPGT(LastSeenBy(Myself),80)
	HaveSpell(0)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreature([GOODCUTOFF.0.PLANATAR],0)
	NumCreature([GOODCUTOFF.0.DARKPLANATAR],0)
	NumCreature([GOODCUTOFF.0.SOLAR],0)
	NumCreature([GOODCUTOFF.0.ANTISOLAR.0.0.SUMMONED],0)
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		!Range(LastSeenBy(Myself),10)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_SUMMON_PLANATAR_GOOD)  // SPWI923.SPL (Summon Planetar)
END

IF
	ActionListEmpty()
	HPGT(LastSeenBy(Myself),80)
	HaveSpell(0)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreature([GOODCUTOFF.0.PLANATAR],0)
	NumCreature([GOODCUTOFF.0.DARKPLANATAR],0)
	NumCreature([GOODCUTOFF.0.SOLAR],0)
	NumCreature([GOODCUTOFF.0.ANTISOLAR.0.0.SUMMONED],0)
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		!Range(LastSeenBy(Myself),10)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_SUMMON_PLANATAR_EVIL)  // SPWI924.SPL (Summon Dark Planetar)
END

IF
	ActionListEmpty()
	HPGT(LastSeenBy(Myself),80)
	HaveSpell(CLERIC_SUMMON_DEVA)  // SPPR726.SPL (Summon Deva)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreature([GOODCUTOFF.0.PLANATAR],0)
	NumCreature([GOODCUTOFF.0.DARKPLANATAR],0)
	NumCreature([GOODCUTOFF.0.SOLAR],0)
	NumCreature([GOODCUTOFF.0.ANTISOLAR.0.0.SUMMONED],0)
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		!Range(LastSeenBy(Myself),10)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_SUMMON_DEVA)  // SPPR726.SPL (Summon Deva)
END

IF
	ActionListEmpty()
	HPGT(LastSeenBy(Myself),80)
	HaveSpell(CLERIC_SUMMON_FALLEN_DEVA)  // SPPR727.SPL (Summon Fallen Deva)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreature([GOODCUTOFF.0.PLANATAR],0)
	NumCreature([GOODCUTOFF.0.DARKPLANATAR],0)
	NumCreature([GOODCUTOFF.0.SOLAR],0)
	NumCreature([GOODCUTOFF.0.ANTISOLAR.0.0.SUMMONED],0)
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		!Range(LastSeenBy(Myself),10)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_SUMMON_FALLEN_DEVA)  // SPPR727.SPL (Summon Fallen Deva)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_SUMMON_DJINNI)  // SPWI718.SPL (Summon Djinni)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	HPGT(LastSeenBy(Myself),50)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		!Range(LastSeenBy(Myself),10)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_SUMMON_DJINNI)  // SPWI718.SPL (Summon Djinni)
END

IF
	ActionListEmpty()
	HaveSpell(CLERIC_CALL_WOODLAND_BEINGS)  // SPPR410.SPL (Call Woodland Beings)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		!Range(LastSeenBy(Myself),10)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_CALL_WOODLAND_BEINGS)  // SPPR410.SPL (Call Woodland Beings)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_MORDENKAINENS_SWORD)  // SPWI716.SPL (Mordenkainen's Sword)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	HPGT(LastSeenBy(Myself),50)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		!Range(LastSeenBy(Myself),10)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_MORDENKAINENS_SWORD)  // SPWI716.SPL (Mordenkainen's Sword)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_INVISIBLE_STALKER)  // SPWI601.SPL (Invisible Stalker)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	HPGT(LastSeenBy(Myself),50)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		!Range(LastSeenBy(Myself),10)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_INVISIBLE_STALKER)  // SPWI601.SPL (Invisible Stalker)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_SPIDER_SPAWN)  // SPWI423.SPL (Spider Spawn)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	NumCreatureGT([EVILCUTOFF],3)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		!Range(LastSeenBy(Myself),10)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_SPIDER_SPAWN)  // SPWI423.SPL (Spider Spawn)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_MONSTER_SUMMONING_1)  // SPWI309.SPL (Monster Summoning I)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	NumCreatureGT([EVILCUTOFF],3)
	!HPGT(LastSeenBy(Myself),50)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		!Range(LastSeenBy(Myself),10)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_MONSTER_SUMMONING_1)  // SPWI309.SPL (Monster Summoning I)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_MONSTER_SUMMONING_3)  // SPWI504.SPL (Monster Summoning III)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	NumCreatureGT([EVILCUTOFF],3)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		!Range(LastSeenBy(Myself),10)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_MONSTER_SUMMONING_3)  // SPWI504.SPL (Monster Summoning III)
END

IF
	ActionListEmpty()
	HaveSpell(CLERIC_GREATER_ELEMENTAL_SWARM)  // SPPR724.SPL (Greater Elemental Summoning)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	HPGT(LastSeenBy(Myself),100)
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		!Range(LastSeenBy(Myself),10)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_GREATER_ELEMENTAL_SWARM)  // SPPR724.SPL (Greater Elemental Summoning)
END

IF
	ActionListEmpty()
	HaveSpell(CLERIC_ELEMENTAL_SWARM)  // SPPR723.SPL (Elemental Summoning)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	HPGT(LastSeenBy(Myself),80)
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		!Range(LastSeenBy(Myself),10)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_ELEMENTAL_SWARM)  // SPPR723.SPL (Elemental Summoning)
END

IF
	ActionListEmpty()
	HaveSpell(CLERIC_CONJURE_FIRE_ELEMENTAL)  // SPPR605.SPL (Conjure Fire Elemental)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	HPGT(LastSeenBy(Myself),50)
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		!Range(LastSeenBy(Myself),10)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_CONJURE_FIRE_ELEMENTAL)  // SPPR605.SPL (Conjure Fire Elemental)
END

IF
	ActionListEmpty()
	NumCreatureGT([EVILCUTOFF],3)
	HPGT(LastSeenBy(Myself),30)
	HaveSpell(CLERIC_ANIMATE_DEAD)  // SPPR301.SPL (Animate Dead)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		!Range(LastSeenBy(Myself),10)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_ANIMATE_DEAD)  // SPPR301.SPL (Animate Dead)
END

IF
	ActionListEmpty()
	HaveSpell(CLERIC_ANIMAL_SUMMONING_1)  // SPPR402.SPL (Animal Summoning I)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	!HPGT(LastSeenBy(Myself),50)
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	NumCreatureGT([EVILCUTOFF],3)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		!Range(LastSeenBy(Myself),10)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_ANIMAL_SUMMONING_1)  // SPPR402.SPL (Animal Summoning I)
END

IF
	ActionListEmpty()
	HaveSpell(CLERIC_ANIMAL_SUMMONING_2)  // SPPR501.SPL (Animal Summoning II)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	!HPGT(LastSeenBy(Myself),70)
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	NumCreatureGT([EVILCUTOFF],3)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		!Range(LastSeenBy(Myself),10)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_ANIMAL_SUMMONING_2)  // SPPR501.SPL (Animal Summoning II)
END

IF
	ActionListEmpty()
	HaveSpell(CLERIC_ANIMAL_SUMMONING_3)  // SPPR602.SPL (Animal Summoning III)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	!HPGT(LastSeenBy(Myself),100)
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],5)
	NumCreatureGT([EVILCUTOFF],3)
	OR(2)
		Global("u_PartyProtector","LOCALS",0)
		!Range(LastSeenBy(Myself),10)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_ANIMAL_SUMMONING_3)  // SPPR602.SPL (Animal Summoning III)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_FLAME_ARROW)  // SPWI303.SPL (Flame Arrow)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	!HasBounceEffects(LastSeenBy(Myself))
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_FLAME_ARROW)  // SPWI303.SPL (Flame Arrow)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_MELF_ACID_ARROW)  // SPWI211.SPL (Melf's Acid Arrow)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	!HasBounceEffects(LastSeenBy(Myself))
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_MELF_ACID_ARROW)  // SPWI211.SPL (Melf's Acid Arrow)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_MAGIC_MISSILE)  // SPWI112.SPL (Magic Missile)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	!HasBounceEffects(LastSeenBy(Myself))
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_MAGIC_MISSILE)  // SPWI112.SPL (Magic Missile)
END

IF
	ActionListEmpty()
	HaveSpell(CLERIC_IMPLOSION)  // SPPR728.SPL (Implosion)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	HPGT(LastSeenBy(Myself),80)
	!HasBounceEffects(LastSeenBy(Myself))
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_IMPLOSION)  // SPPR728.SPL (Implosion)
END

IF
	ActionListEmpty()
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGICFIRE)
	HaveSpell(CLERIC_FLAME_STRIKE)  // SPPR503.SPL (Flame Strike)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	!HasBounceEffects(LastSeenBy(Myself))
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_FLAME_STRIKE)  // SPPR503.SPL (Flame Strike)
END

IF
	ActionListEmpty()
	HaveSpell(CLERIC_SUMMON_INSECTS)  // SPPR319.SPL (Summon Insects)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	!HasBounceEffects(LastSeenBy(Myself))
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_SUMMON_INSECTS)  // SPPR319.SPL (Summon Insects)
END

IF
	ActionListEmpty()
	HaveSpell(CLERIC_BOLT_OF_GLORY)  // SPPR612.SPL (Bolt of Glory)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	!HasBounceEffects(LastSeenBy(Myself))
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_BOLT_OF_GLORY)  // SPPR612.SPL (Bolt of Glory)
END

IF
	ActionListEmpty()
	HaveSpell(CLERIC_DOOM)  // SPPR113.SPL (Doom)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	!HasBounceEffects(LastSeenBy(Myself))
	Global("u_PartyProtector","LOCALS",0)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_DOOM)  // SPPR113.SPL (Doom)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)  // SPWI611.SPL (Protection From Magical Weapons)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	!GlobalTimerNotExpired("u_WeaponProtection","LOCALS")
	OR(2)
		Global("u_PartyProtector","LOCALS",1)
		Range(LastSeenBy(Myself),4)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)  // SPWI611.SPL (Protection From Magical Weapons)
		SetGlobalTimer("u_WeaponProtection","LOCALS",FOUR_ROUNDS)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_STRENGTH)  // SPWI214.SPL (Strength)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	CheckStatLT(Myself,17,STR)
	OR(2)
		Global("u_PartyProtector","LOCALS",1)
		Range(LastSeenBy(Myself),4)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_STRENGTH)  // SPWI214.SPL (Strength)
END

IF
	ActionListEmpty()
	Range("Mazzy",0)  // Mazzy
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	OR(2)
		!GlobalTimerNotExpired("u_DefensiveSpellCast","LOCALS")
		Global("u_BypassCutoff","LOCALS",1)
	CheckStatLT(Myself,17,STR)
	OR(2)
		Global("u_PartyProtector","LOCALS",1)
		Range(LastSeenBy(Myself),4)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		SpellNoDec(Myself,MAZZY_STRENGTH)  // SPIN826.SPL (Strength)
END

IF
	ActionListEmpty()
	HaveSpell(WIZARD_TENSERS_TRANSFORMATION)  // SPWI603.SPL (Tenser's Transformation)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	OR(2)
		Global("u_PartyProtector","LOCALS",1)
		Range(LastSeenBy(Myself),4)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_TENSERS_TRANSFORMATION)  // SPWI603.SPL (Tenser's Transformation)
END

IF
	ActionListEmpty()
	HaveSpell(CLERIC_RIGHTEOUS_MAGIC)  // SPPR513.SPL (Righteous Magic)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	OR(2)
		Global("u_PartyProtector","LOCALS",1)
		Range(LastSeenBy(Myself),4)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_RIGHTEOUS_MAGIC)  // SPPR513.SPL (Righteous Magic)
END

IF
	ActionListEmpty()
	!StateCheck(Myself,STATE_DRAWUPONHOLYMIGHT)
	HaveSpell(CLERIC_DRAW_UPON_HOLY_MIGHT)  // SPPR214.SPL (Draw Upon Holy Might)
	CheckStatLT(Myself,25,SPELLFAILUREPRIEST)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	OR(2)
		Global("u_PartyProtector","LOCALS",1)
		Range(LastSeenBy(Myself),4)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_DRAW_UPON_HOLY_MIGHT)  // SPPR214.SPL (Draw Upon Holy Might)
END

IF
	ActionListEmpty()
	!StateCheck(Myself,STATE_DRAWUPONHOLYMIGHT)
	HaveSpell(0)
	CheckStatLT(Myself,25,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
	OR(2)
		Global("u_PartyProtector","LOCALS",1)
		Range(LastSeenBy(Myself),4)
	Global("u_SpellcastingOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		Spell(Myself,0)
END

IF
	ActionListEmpty()
	LevelLT(LastSeenBy(Myself),10)
	NumCreatureGT([EVILCUTOFF],2)
	HasItemEquiped("WAND08",Myself)  // Wand of Sleep
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		DisplayStringHead(Myself,6692)  // Wand of Sleep
		UseItem("WAND08",LastSeenBy(Myself))  // Wand of Sleep
END

IF
	ActionListEmpty()
	LevelLT(LastSeenBy(Myself),10)
	NumCreatureGT([EVILCUTOFF],2)
	HasItemEquiped("WAND02",Myself)  // Wand of Fear
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		DisplayStringHead(Myself,6657)  // Wand of Fear
		UseItem("WAND02",LastSeenBy(Myself))  // Wand of Fear
END

IF
	ActionListEmpty()
	OR(2)
		HasBounceEffects(LastSeenBy(Myself))
		HasImmunityEffects(LastSeenBy(Myself))
	HasItemEquiped("WAND18",Myself)  // Wand of Spell Striking
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		DisplayStringHead(Myself,66392)  // Wand of Spell Striking
		UseItem("WAND18",LastSeenBy(Myself))  // Wand of Spell Striking
END

IF
	ActionListEmpty()
	!HasBounceEffects(LastSeenBy(Myself))
	!HasImmunityEffects(LastSeenBy(Myself))
	HasItemEquiped("WAND19",Myself)  // Wand of Cursing
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		DisplayStringHead(Myself,66397)  // Wand of Cursing
		UseItem("WAND19",LastSeenBy(Myself))  // Wand of Cursing
END

IF
	ActionListEmpty()
	!HasBounceEffects(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_STUNNED)
	HasItemEquiped("WAND04",Myself)  // Wand of Paralyzation
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		DisplayStringHead(Myself,6690)  // Wand of Paralyzation
		UseItem("WAND04",LastSeenBy(Myself))  // Wand of Paralyzation
END

IF
	ActionListEmpty()
	LevelLT(LastSeenBy(Myself),10)
	!HasBounceEffects(LastSeenBy(Myself))
	HasItemEquiped("WAND09",Myself)  // Wand of Polymorphing
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		DisplayStringHead(Myself,6693)  // Wand of Polymorphing
		UseItem("WAND09",LastSeenBy(Myself))  // Wand of Polymorphing
END

IF
	ActionListEmpty()
	HasItemEquiped("WAND10",Myself)  // Wand of Monster Summoning
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		DisplayStringHead(Myself,7272)  // Wand of Monster Summoning
		UseItem("WAND10",LastSeenBy(Myself))  // Wand of Monster Summoning
END

IF
	ActionListEmpty()
	!HasBounceEffects(LastSeenBy(Myself))
	HasItemEquiped("WAND06",Myself)  // Wand of Frost
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		DisplayStringHead(Myself,7269)  // Wand of Frost
		UseItem("WAND06",LastSeenBy(Myself))  // Wand of Frost
END

IF
	ActionListEmpty()
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGICFIRE)
	!HasImmunityEffects(LastSeenBy(Myself))
	HasItemEquiped("WAND11",Myself)  // Wand of the Heavens
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		DisplayStringHead(Myself,7273)  // Wand of the Heavens
		UseItem("WAND11",LastSeenBy(Myself))  // Wand of the Heavens
END

IF
	ActionListEmpty()
	!HasBounceEffects(LastSeenBy(Myself))
	!HasImmunityEffects(LastSeenBy(Myself))
	HasItemEquiped("WAND03",Myself)  // Wand of Magic Missiles
	!GlobalTimerNotExpired("u_SpellCastThisRound","LOCALS")
THEN
	RESPONSE #100
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		DisplayStringHead(Myself,6689)  // Wand of Magic Missiles
		UseItem("WAND03",LastSeenBy(Myself))  // Wand of Magic Missiles
END

IF
	ActionListEmpty()
	CheckStatLT(Myself,24,STR)
	OR(3)
		Class(Myself,FIGHTER_ALL)
		Class(Myself,PALADIN_ALL)
		Class(Myself,RANGER_ALL)
	HasItem("POTN07",Myself)  // Potion of Storm Giant Strength
	OR(2)
		!HasItem("BAG04",Myself)  // Bag of Holding
		HasItemEquiped("POTN07",Myself)  // Potion of Storm Giant Strength
	OR(2)
		!HasItem("BAG06",Myself)  // Potion Case
		HasItemEquiped("POTN07",Myself)  // Potion of Storm Giant Strength
THEN
	RESPONSE #100
		DisplayStringHead(Myself,6989)  // Potion of Storm Giant Strength
		UseItem("POTN07",Myself)  // Potion of Storm Giant Strength
END

IF
	ActionListEmpty()
	CheckStatLT(Myself,23,STR)
	OR(3)
		Class(Myself,FIGHTER_ALL)
		Class(Myself,PALADIN_ALL)
		Class(Myself,RANGER_ALL)
	HasItem("POTN06",Myself)  // Potion of Cloud Giant Strength
	OR(2)
		!HasItem("BAG04",Myself)  // Bag of Holding
		HasItemEquiped("POTN06",Myself)  // Potion of Cloud Giant Strength
	OR(2)
		!HasItem("BAG06",Myself)  // Potion Case
		HasItemEquiped("POTN06",Myself)  // Potion of Cloud Giant Strength
THEN
	RESPONSE #100
		DisplayStringHead(Myself,6986)  // Potion of Cloud Giant Strength
		UseItem("POTN06",Myself)  // Potion of Cloud Giant Strength
END

IF
	ActionListEmpty()
	CheckStatLT(Myself,22,STR)
	OR(3)
		Class(Myself,FIGHTER_ALL)
		Class(Myself,PALADIN_ALL)
		Class(Myself,RANGER_ALL)
	HasItem("POTN05",Myself)  // Potion of Fire Giant Strength
	OR(2)
		!HasItem("BAG04",Myself)  // Bag of Holding
		HasItemEquiped("POTN05",Myself)  // Potion of Fire Giant Strength
	OR(2)
		!HasItem("BAG06",Myself)  // Potion Case
		HasItemEquiped("POTN05",Myself)  // Potion of Fire Giant Strength
THEN
	RESPONSE #100
		DisplayStringHead(Myself,6985)  // Potion of Fire Giant Strength
		UseItem("POTN05",Myself)  // Potion of Fire Giant Strength
END

IF
	ActionListEmpty()
	CheckStatLT(Myself,21,STR)
	OR(3)
		Class(Myself,FIGHTER_ALL)
		Class(Myself,PALADIN_ALL)
		Class(Myself,RANGER_ALL)
	HasItem("POTN04",Myself)  // Potion of Frost Giant Strength
	OR(2)
		!HasItem("BAG04",Myself)  // Bag of Holding
		HasItemEquiped("POTN04",Myself)  // Potion of Frost Giant Strength
	OR(2)
		!HasItem("BAG06",Myself)  // Potion Case
		HasItemEquiped("POTN04",Myself)  // Potion of Frost Giant Strength
THEN
	RESPONSE #100
		DisplayStringHead(Myself,6984)  // Potion of Frost Giant Strength
		UseItem("POTN04",Myself)  // Potion of Frost Giant Strength
END

IF
	ActionListEmpty()
	CheckStatLT(Myself,21,STR)
	OR(2)
		Class(Myself,THIEF_ALL)
		Class(Myself,BARD_ALL)
	HasItem("POTN56",Myself)  // Rogue's Potion of Frost Giant Strength
	OR(2)
		!HasItem("BAG04",Myself)  // Bag of Holding
		HasItemEquiped("POTN56",Myself)  // Rogue's Potion of Frost Giant Strength
	OR(2)
		!HasItem("BAG06",Myself)  // Potion Case
		HasItemEquiped("POTN56",Myself)  // Rogue's Potion of Frost Giant Strength
THEN
	RESPONSE #100
		DisplayStringHead(Myself,71145)  // Rogue's Potion of Frost Giant Strength
		UseItem("POTN56",Myself)  // Rogue's Potion of Frost Giant Strength
END

IF
	ActionListEmpty()
	CheckStatLT(Myself,20,STR)
	OR(3)
		Class(Myself,FIGHTER_ALL)
		Class(Myself,PALADIN_ALL)
		Class(Myself,RANGER_ALL)
	HasItem("POTN12",Myself)  // Potion of Stone Giant Strength
	OR(2)
		!HasItem("BAG04",Myself)  // Bag of Holding
		HasItemEquiped("POTN12",Myself)  // Potion of Stone Giant Strength
	OR(2)
		!HasItem("BAG06",Myself)  // Potion Case
		HasItemEquiped("POTN12",Myself)  // Potion of Stone Giant Strength
THEN
	RESPONSE #100
		DisplayStringHead(Myself,7005)  // Potion of Stone Giant Strength
		UseItem("POTN12",Myself)  // Potion of Stone Giant Strength
END

IF
	ActionListEmpty()
	CheckStatLT(Myself,19,STR)
	OR(3)
		Class(Myself,FIGHTER_ALL)
		Class(Myself,PALADIN_ALL)
		Class(Myself,RANGER_ALL)
	HasItem("POTN03",Myself)  // Potion of Hill Giant Strength
	OR(2)
		!HasItem("BAG04",Myself)  // Bag of Holding
		HasItemEquiped("POTN03",Myself)  // Potion of Hill Giant Strength
	OR(2)
		!HasItem("BAG06",Myself)  // Potion Case
		HasItemEquiped("POTN03",Myself)  // Potion of Hill Giant Strength
THEN
	RESPONSE #100
		DisplayStringHead(Myself,6981)  // Potion of Hill Giant Strength
		UseItem("POTN03",Myself)  // Potion of Hill Giant Strength
END

IF
	ActionListEmpty()
	CheckStatLT(Myself,18,STR)
	HasItem("POTN44",Myself)  // Potion of Strength
	OR(2)
		!HasItem("BAG04",Myself)  // Bag of Holding
		HasItemEquiped("POTN44",Myself)  // Potion of Strength
	OR(2)
		!HasItem("BAG06",Myself)  // Potion Case
		HasItemEquiped("POTN44",Myself)  // Potion of Strength
THEN
	RESPONSE #100
		DisplayStringHead(Myself,7103)  // Potion of Strength
		UseItem("POTN44",Myself)  // Potion of Strength
END

IF
	ActionListEmpty()
	Global("u_UsedShaktiFigurine","LOCALS",0)
	CheckStatGT(Myself,-5,ARMORCLASS)
	Global("u_PartyProtector","LOCALS",1)
	HasItemEquiped("FIGURE01",Myself)  // Shakti Figurine
THEN
	RESPONSE #100
		DisplayStringHead(Myself,66359)  // Shakti Figurine
		SetGlobalTimer("u_SpellCastThisRound","LOCALS",ONE_ROUND)
		UseItem("FIGURE01",LastSeenBy(Myself))  // Shakti Figurine
		SetGlobal("u_UsedShaktiFigurine","LOCALS",1)
END

IF
	ActionListEmpty()
	!Global("u_MeleeWeaponEquipped","LOCALS",1)
	!Range(LastSeenBy(Myself),4)
	HaveSpell(ARCHER_CALL_SHOT)  // SPCL121.SPL (Called Shot)
	!GlobalTimerNotExpired("u_UsingAbility","LOCALS")
THEN
	RESPONSE #100
		DisplayStringHead(Myself,8306)  // Called Shot
		Spell(Myself,ARCHER_CALL_SHOT)  // SPCL121.SPL (Called Shot)
		SetGlobalTimer("u_UsingAbility","LOCALS",THREE_ROUNDS)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),4)
	LevelLT(LastSeenBy(Myself),12)
	OR(2)
		LevelGT(LastSeenBy(Myself),8)
		!HaveSpell(WARRIOR_DEATHBLOW)  // SPCL902.SPL (Deathblow)
	HPGT(LastSeenBy(Myself),40)
	HaveSpell(WARRIOR_GREATER_DEATHBLOW)  // SPCL903.SPL (Greater Deathblow)
	!GlobalTimerNotExpired("u_UsingAbility","LOCALS")
THEN
	RESPONSE #100
		DisplayStringHead(Myself,63938)  // Greater Deathblow
		Spell(Myself,WARRIOR_GREATER_DEATHBLOW)  // SPCL903.SPL (Greater Deathblow)
		SetGlobalTimer("u_UsingAbility","LOCALS",THREE_ROUNDS)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),4)
	LevelLT(LastSeenBy(Myself),8)
	HPGT(LastSeenBy(Myself),30)
	HaveSpell(WARRIOR_DEATHBLOW)  // SPCL902.SPL (Deathblow)
	!GlobalTimerNotExpired("u_UsingAbility","LOCALS")
THEN
	RESPONSE #100
		DisplayStringHead(Myself,63922)  // Deathblow
		Spell(Myself,WARRIOR_DEATHBLOW)  // SPCL902.SPL (Deathblow)
		SetGlobalTimer("u_UsingAbility","LOCALS",TWO_ROUNDS)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),4)
	HPGT(LastSeenBy(Myself),50)
	HaveSpell(WARRIOR_GREATER_WHIRLWIND)  // SPCL901.SPL (Greater Whirlwind Attack)
	!GlobalTimerNotExpired("u_UsingAbility","LOCALS")
THEN
	RESPONSE #100
		DisplayStringHead(Myself,63904)  // Greater Whirlwind Attack
		Spell(Myself,WARRIOR_GREATER_WHIRLWIND)  // SPCL901.SPL (Greater Whirlwind Attack)
		SetGlobalTimer("u_UsingAbility","LOCALS",TWO_ROUNDS)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),4)
	HPGT(LastSeenBy(Myself),50)
	HaveSpell(WARRIOR_CRITICAL_STRIKE)  // SPCL905.SPL (Critical Strike)
	!GlobalTimerNotExpired("u_UsingAbility","LOCALS")
THEN
	RESPONSE #100
		DisplayStringHead(Myself,65434)  // Critical Strike
		Spell(Myself,WARRIOR_CRITICAL_STRIKE)  // SPCL905.SPL (Critical Strike)
		SetGlobalTimer("u_UsingAbility","LOCALS",TWO_ROUNDS)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),4)
	HPGT(LastSeenBy(Myself),50)
	NumCreatureGT([EVILCUTOFF],1)
	HaveSpell(WARRIOR_SMITE)  // SPCL909.SPL (Smite)
	!GlobalTimerNotExpired("u_UsingAbility","LOCALS")
THEN
	RESPONSE #100
		DisplayStringHead(Myself,65598)  // Smite
		Spell(Myself,WARRIOR_SMITE)  // SPCL909.SPL (Smite)
		SetGlobalTimer("u_UsingAbility","LOCALS",TWO_ROUNDS)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),4)
	HPGT(LastSeenBy(Myself),50)
	HaveSpell(WARRIOR_POWER_ATTACK)  // SPCL906.SPL (Power Attack)
	!GlobalTimerNotExpired("u_UsingAbility","LOCALS")
THEN
	RESPONSE #100
		DisplayStringHead(Myself,63941)  // Power Attack
		Spell(Myself,WARRIOR_POWER_ATTACK)  // SPCL906.SPL (Power Attack)
		SetGlobalTimer("u_UsingAbility","LOCALS",TWO_ROUNDS)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),4)
	HPGT(LastSeenBy(Myself),50)
	HaveSpell(WARRIOR_WHIRLWIND)  // SPCL900.SPL (Whirlwind Attack)
	!GlobalTimerNotExpired("u_UsingAbility","LOCALS")
THEN
	RESPONSE #100
		DisplayStringHead(Myself,63902)  // Whirlwind Attack
		Spell(Myself,WARRIOR_WHIRLWIND)  // SPCL900.SPL (Whirlwind Attack)
		SetGlobalTimer("u_UsingAbility","LOCALS",TWO_ROUNDS)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),10)
	HPGT(LastSeenBy(Myself),50)
	HaveSpell(WARRIOR_WAR_CRY)  // SPCL908.SPL (War Cry)
	NumCreatureGT([EVILCUTOFF],2)
	!GlobalTimerNotExpired("u_UsingAbility","LOCALS")
THEN
	RESPONSE #100
		DisplayStringHead(Myself,63954)  // War Cry
		Spell(Myself,WARRIOR_WAR_CRY)  // SPCL908.SPL (War Cry)
		SetGlobalTimer("u_UsingAbility","LOCALS",TWO_ROUNDS)
END

IF
	ActionListEmpty()
	OR(6)
		Class(LastSeenBy(Myself),MAGE_ALL)
		Class(LastSeenBy(Myself),CLERIC_ALL)
		Class(LastSeenBy(Myself),BARD_ALL)
		Class(LastSeenBy(Myself),DRUID_ALL)
		Race(LastSeenBy(Myself),BEHOLDER)
		Race(LastSeenBy(Myself),MIND_FLAYER)
	HaveSpell(WARRIOR_RESIST_MAGIC)  // SPCL904.SPL (Resist Magic)
	!GlobalTimerNotExpired("u_UsingAbility","LOCALS")
THEN
	RESPONSE #100
		DisplayStringHead(Myself,63939)  // Resist Magic
		Spell(Myself,WARRIOR_RESIST_MAGIC)  // SPCL904.SPL (Resist Magic)
		SetGlobalTimer("u_UsingAbility","LOCALS",TWO_ROUNDS)
END

IF
	ActionListEmpty()
	CheckStatLT(Myself,40,RESISTSLASHING)
	OR(2)
		HPGT(LastSeenBy(Myself),50)
		NumCreatureGT([EVILCUTOFF],3)
	HaveSpell(WARRIOR_HARDINESS)  // SPCL907.SPL (Hardiness)
	!GlobalTimerNotExpired("u_UsingAbility","LOCALS")
THEN
	RESPONSE #100
		DisplayStringHead(Myself,63953)  // Hardiness
		Spell(Myself,WARRIOR_HARDINESS)  // SPCL907.SPL (Hardiness)
		SetGlobalTimer("u_UsingAbility","LOCALS",TWO_ROUNDS)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),4)
	OR(2)
		HPGT(LastSeenBy(Myself),40)
		NumCreatureGT([EVILCUTOFF],3)
	HaveSpell(KENSAI_KIA)  // SPCL144.SPL (Kai)
	!GlobalTimerNotExpired("u_UsingAbility","LOCALS")
THEN
	RESPONSE #100
		DisplayStringHead(Myself,51848)  // Kai
		Spell(Myself,KENSAI_KIA)  // SPCL144.SPL (Kai)
		SetGlobalTimer("u_UsingAbility","LOCALS",TWO_ROUNDS)
END

IF
	ActionListEmpty()
	HPPercentLT(Myself,70)
	OR(2)
		HPGT(LastSeenBy(Myself),50)
		NumCreatureGT([EVILCUTOFF],3)
	HaveSpell(BERSERKER_RAGE)  // SPCL321.SPL (Enrage)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,10381)  // Berserk
		Spell(Myself,BERSERKER_RAGE)  // SPCL321.SPL (Enrage)
		SetGlobalTimer("u_UsingAbility","LOCALS",TWO_ROUNDS)
END

IF
	ActionListEmpty()
	HPPercentLT(Myself,70)
	OR(2)
		HPGT(LastSeenBy(Myself),50)
		NumCreatureGT([EVILCUTOFF],3)
	HaveSpell(BARBARIAN_RAGE)  // SPCL152.SPL (Barbarian Rage)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,42870)  // Barbarian Rage
		Spell(Myself,BARBARIAN_RAGE)  // SPCL152.SPL (Barbarian Rage)
		SetGlobalTimer("u_UsingAbility","LOCALS",TWO_ROUNDS)
END

IF
	ActionListEmpty()
	HPPercentLT(Myself,70)
	OR(2)
		HPGT(LastSeenBy(Myself),40)
		NumCreatureGT([EVILCUTOFF],3)
	OR(10)
		Class(LastSeenBy(Myself),MAGE_ALL)
		Class(LastSeenBy(Myself),CLERIC_ALL)
		Class(LastSeenBy(Myself),BARD_ALL)
		Class(LastSeenBy(Myself),DRUID_ALL)
		Race(LastSeenBy(Myself),MIND_FLAYER)
		Race(LastSeenBy(Myself),UMBERHULK)
		Race(LastSeenBy(Myself),RAKSHASA)
		Race(LastSeenBy(Myself),VAMPIRE)
		Race(LastSeenBy(Myself),DEMONIC)
		Race(LastSeenBy(Myself),DRAGON)
	HaveSpell(MINSC_BERSERK)  // SPIN117.SPL (Berserk)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,10381)  // Berserk
		Spell(Myself,MINSC_BERSERK)  // SPIN117.SPL (Berserk)
		SetGlobalTimer("u_UsingAbility","LOCALS",TWO_ROUNDS)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),4)
	OR(2)
		HPGT(LastSeenBy(Myself),40)
		NumCreatureGT([EVILCUTOFF],3)
	HaveSpell(MONK_QUIVERING_PALM)  // SPCL820.SPL (Quivering Palm)
	!GlobalTimerNotExpired("u_UsingAbility","LOCALS")
THEN
	RESPONSE #100
		DisplayStringHead(Myself,42857)  // Quivering Palm
		Spell(Myself,MONK_QUIVERING_PALM)  // SPCL820.SPL (Quivering Palm)
		SetGlobalTimer("u_UsingAbility","LOCALS",TWO_ROUNDS)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),4)
	OR(2)
		HPGT(LastSeenBy(Myself),40)
		NumCreatureGT([EVILCUTOFF],3)
	HaveSpell(MONK_STUNNING_BLOW)  // SPCL811.SPL (Stunning Blow)
	!GlobalTimerNotExpired("u_UsingAbility","LOCALS")
THEN
	RESPONSE #100
		DisplayStringHead(Myself,42865)  // Stunning Blow
		Spell(Myself,MONK_STUNNING_BLOW)  // SPCL811.SPL (Stunning Blow)
		SetGlobalTimer("u_UsingAbility","LOCALS",TWO_ROUNDS)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),4)
	HPGT(LastSeenBy(Myself),50)
	HaveSpell(0)
	!GlobalTimerNotExpired("u_UsingAbility","LOCALS")
THEN
	RESPONSE #100
		DisplayStringHead(Myself,65438)  // Assassination
		Spell(Myself,0)
		SetGlobalTimer("u_UsingAbility","LOCALS",TWO_ROUNDS)
END

IF
	ActionListEmpty()
	HPPercentLT(Myself,70)
	OR(2)
		HPGT(LastSeenBy(Myself),50)
		NumCreatureGT([EVILCUTOFF],3)
	HaveSpell(ROGUE_GREATER_EVASION)  // SPCL914.SPL (Greater Evasion)
	!GlobalTimerNotExpired("u_UsingAbility","LOCALS")
THEN
	RESPONSE #100
		DisplayStringHead(Myself,63993)  // Greater Evasion
		Spell(Myself,ROGUE_GREATER_EVASION)  // SPCL914.SPL (Greater Evasion)
		SetGlobalTimer("u_UsingAbility","LOCALS",TWO_ROUNDS)
END

IF
	ActionListEmpty()
	HPPercentLT(Myself,70)
	OR(2)
		HPGT(LastSeenBy(Myself),50)
		NumCreatureGT([EVILCUTOFF],3)
	HaveSpell(ROGUE_EVASION)  // SPCL913.SPL (Evasion)
	!GlobalTimerNotExpired("u_UsingAbility","LOCALS")
THEN
	RESPONSE #100
		DisplayStringHead(Myself,63992)  // Evasion
		Spell(Myself,ROGUE_EVASION)  // SPCL913.SPL (Evasion)
		SetGlobalTimer("u_UsingAbility","LOCALS",TWO_ROUNDS)
END

IF
	ActionListEmpty()
	OR(3)
		Class(LastSeenBy(Myself),MAGE_ALL)
		Class(LastSeenBy(Myself),CLERIC_ALL)
		Race(LastSeenBy(Myself),BEHOLDER)
	HPGT(LastSeenBy(Myself),50)
	HaveSpell(ROGUE_AVOID_DEATH)  // SPCL917.SPL (Avoid Death)
	!GlobalTimerNotExpired("u_UsingAbility","LOCALS")
THEN
	RESPONSE #100
		DisplayStringHead(Myself,64001)  // Avoid Death
		Spell(Myself,ROGUE_AVOID_DEATH)  // SPCL917.SPL (Avoid Death)
		SetGlobalTimer("u_UsingAbility","LOCALS",TWO_ROUNDS)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),4)
	HaveSpell(ASSASSIN_POISON)  // SPCL423.SPL (Poison Weapon)
	!GlobalTimerNotExpired("u_UsingAbility","LOCALS")
THEN
	RESPONSE #100
		DisplayStringHead(Myself,52056)  // Poison Weapon
		Spell(Myself,ASSASSIN_POISON)  // SPCL423.SPL (Poison Weapon)
		SetGlobalTimer("u_UsingAbility","LOCALS",TWO_ROUNDS)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),4)
	!StateCheck(Myself,STATE_HASTED)
	HaveSpell(BLADE_OFFENSIVE_SPIN)  // SPCL521.SPL (Offensive Spin)
	!GlobalTimerNotExpired("u_UsingAbility","LOCALS")
THEN
	RESPONSE #100
		DisplayStringHead(Myself,8308)  // Offensive Spin
		Spell(Myself,BLADE_OFFENSIVE_SPIN)  // SPCL521.SPL (Offensive Spin)
		SetGlobalTimer("u_UsingAbility","LOCALS",TWO_ROUNDS)
END

IF
	ActionListEmpty()
	HPPercentLT(Myself,70)
	OR(2)
		HPGT(LastSeenBy(Myself),50)
		NumCreatureGT([EVILCUTOFF],3)
	Range(LastSeenBy(Myself),4)
	HitBy(LastSeenBy(Myself),CRUSHING)
	HaveSpell(BLADE_DEFENSIVE_SPIN)  // SPCL522.SPL (Defensive Spin)
	!GlobalTimerNotExpired("u_UsingAbility","LOCALS")
THEN
	RESPONSE #100
		DisplayStringHead(Myself,8309)  // Defensive Spin
		Spell(Myself,BLADE_DEFENSIVE_SPIN)  // SPCL522.SPL (Defensive Spin)
		SetGlobalTimer("u_UsingAbility","LOCALS",TWO_ROUNDS)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),4)
	Global("u_PartyProtector","LOCALS",1)
	CheckStatGT(Myself,-5,ARMORCLASS)
	HaveSpell(CLERIC_ELEMENTAL_TRANSFORMATION_EARTH)  // SPPR732.SPL (Earth Elemental Transformation)
THEN
	RESPONSE #100
		Spell(Myself,CLERIC_ELEMENTAL_TRANSFORMATION_EARTH)  // SPPR732.SPL (Earth Elemental Transformation)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),4)
	Global("u_PartyProtector","LOCALS",1)
	CheckStatGT(Myself,-5,ARMORCLASS)
	HaveSpell(CLERIC_ELEMENTAL_TRANSFORMATION_FIRE)  // SPPR731.SPL (Fire Elemental Transformation)
THEN
	RESPONSE #100
		Spell(Myself,CLERIC_ELEMENTAL_TRANSFORMATION_FIRE)  // SPPR731.SPL (Fire Elemental Transformation)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),4)
	Global("u_PartyProtector","LOCALS",1)
	CheckStatGT(Myself,-6,ARMORCLASS)
	HaveSpell(SHAPESHIFTER_SHAPESHIFT_GREATERWEREWOLF)  // SPCL644.SPL (Shapeshift: Greater Werewolf)
THEN
	RESPONSE #100
		Spell(Myself,SHAPESHIFTER_SHAPESHIFT_GREATERWEREWOLF)  // SPCL644.SPL (Shapeshift: Greater Werewolf)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),4)
	Global("u_PartyProtector","LOCALS",1)
	CheckStatGT(Myself,1,ARMORCLASS)
	HaveSpell(SHAPESHIFTER_SHAPESHIFT_WEREWOLF)  // SPCL643.SPL (Shapeshift: Werewolf)
THEN
	RESPONSE #100
		Spell(Myself,SHAPESHIFTER_SHAPESHIFT_WEREWOLF)  // SPCL643.SPL (Shapeshift: Werewolf)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),4)
	Global("u_PartyProtector","LOCALS",1)
	CheckStatGT(Myself,2,ARMORCLASS)
	HaveSpell(AVENGER_SHAPESHIFT_FIRESALAMANDER)  // SPCL634.SPL (Shapeshift: Fire Salamander)
THEN
	RESPONSE #100
		Spell(Myself,AVENGER_SHAPESHIFT_FIRESALAMANDER)  // SPCL634.SPL (Shapeshift: Fire Salamander)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),4)
	Global("u_PartyProtector","LOCALS",1)
	CheckStatGT(Myself,3,ARMORCLASS)
	HaveSpell(AVENGER_SHAPESHIFT_BABYWYVERN)  // SPCL633.SPL (Shapeshift: Baby Wyvern)
THEN
	RESPONSE #100
		Spell(Myself,AVENGER_SHAPESHIFT_BABYWYVERN)  // SPCL633.SPL (Shapeshift: Baby Wyvern)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),4)
	Global("u_PartyProtector","LOCALS",1)
	CheckStatGT(Myself,3,ARMORCLASS)
	HaveSpell(AVENGER_SHAPESHIFT_SWORDSPIDER)  // SPCL632.SPL (Shapeshift: Sword Spider)
THEN
	RESPONSE #100
		Spell(Myself,AVENGER_SHAPESHIFT_SWORDSPIDER)  // SPCL632.SPL (Shapeshift: Sword Spider)
END

IF
	ActionListEmpty()
	Range(LastSeenBy(Myself),4)
	Global("u_PartyProtector","LOCALS",1)
	CheckStatGT(Myself,6,ARMORCLASS)
	HaveSpell(DRUID_SHAPESHIFT_BROWNBEAR)  // SPCL611.SPL (Shapeshift: Brown Bear)
THEN
	RESPONSE #100
		Spell(Myself,DRUID_SHAPESHIFT_BROWNBEAR)  // SPCL611.SPL (Shapeshift: Brown Bear)
END

IF
	ActionListEmpty()
	CheckStatGT(Myself,1,BACKSTABDAMAGEMULTIPLIER)
	OR(2)
		Global("u_PartyProtector","LOCALS",1)
		Range(LastSeenBy(Myself),3)
	HasItem("POTN10",Myself)  // Potion of Invisibility
	!StateCheck(Myself,STATE_INVISIBLE)
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
THEN
	RESPONSE #100
		UseItem("POTN10",Myself)  // Potion of Invisibility
		DisplayStringHead(Myself,6993)  // Potion of Invisibility
END

IF
	ActionListEmpty()
	CheckStatGT(Myself,1,BACKSTABDAMAGEMULTIPLIER)
	OR(2)
		Global("u_PartyProtector","LOCALS",1)
		Range(LastSeenBy(Myself),3)
	!ModalState(STEALTH)
	!StateCheck(Myself,STATE_INVISIBLE)
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	OR(2)
		CheckStatGT(Myself,50,HIDEINSHADOWS)
		CheckStatGT(Myself,50,STEALTH)
	!GlobalTimerNotExpired("u_AttemptedToHide","LOCALS")
THEN
	RESPONSE #100
		SetGlobalTimer("u_AttemptedToHide","LOCALS",TWO_ROUNDS)
		Hide()
END

IF
	ActionListEmpty()
	CheckStatGT(Myself,1,BACKSTABDAMAGEMULTIPLIER)
	OR(2)
		Global("u_PartyProtector","LOCALS",1)
		Range(LastSeenBy(Myself),3)
	HPPercentGT(Myself,50)
	OR(2)
		StateCheck(Myself,STATE_INVISIBLE)
		StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	Global("u_BackstabState","LOCALS",0)
	Global("u_MovementOff","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobal("u_BackstabState","LOCALS",1)
		FollowObjectFormation(LastSeenBy(Myself),3,3)
END

IF
	Global("u_BackstabState","LOCALS",1)
	Range(LastSeenBy(Myself),3)
THEN
	RESPONSE #100
		Wait(1)
		SetGlobal("u_BackstabState","LOCALS",2)
		DisplayStringHead(Myself,13736)  // Die here, you will!
		ClearActions(Myself)
END

IF
	Global("u_AttackReevaluate","LOCALS",1)
	!GlobalTimerNotExpired("u_ReevaluateTimer","LOCALS")
THEN
	RESPONSE #100
		SetGlobal("u_AttackReevaluate","LOCALS",0)
		ClearActions(Myself)
END

IF
	ActionListEmpty()
	OR(2)
		Range(LastSeenBy(Myself),4)
		Global("u_PartyProtector","LOCALS",1)
	Global("u_MeleeWeaponEquipped","LOCALS",1)
THEN
	RESPONSE #100
		Attack(LastSeenBy(Myself))
		SetGlobal("u_AttackReevaluate","LOCALS",1)
		SetGlobalTimer("u_ReevaluateTimer","LOCALS",TWO_ROUNDS)
		SetGlobal("u_BackstabState","LOCALS",0)
		EquipMostDamagingMelee()
END

IF
	ActionListEmpty()
	Class(Myself,BARD_ALL)
	GlobalGT("u_NumberOfStrongProtectors","GLOBAL",0)
	!ModalState(BATTLESONG)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,50705)  // Singing Bard Song
		SetGlobal("u_AttackReevaluate","LOCALS",1)
		SetGlobalTimer("u_ReevaluateTimer","LOCALS",9)
		BattleSong()
		Wait(2)
END

IF
	ActionListEmpty()
	!ModalState(BATTLESONG)
THEN
	RESPONSE #100
		EquipRanged()
		SetGlobal("u_MeleeWeaponEquipped","LOCALS",0)
		AttackOneRound(LastSeenBy(Myself))
END

